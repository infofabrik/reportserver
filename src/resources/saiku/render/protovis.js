/*!
 * Copyright 2002 - 2013 Webdetails, a Pentaho company.  All rights reserved.
 *
 * This software was developed by Webdetails and is provided under the terms
 * of the Mozilla Public License, Version 2.0, or any later version. You may not use
 * this file except in compliance with the license. If you need a copy of the license,
 * please go to  http://mozilla.org/MPL/2.0/. The Initial Developer is Webdetails.
 *
 * Software distributed under the Mozilla Public License is distributed on an "AS IS"
 * basis, WITHOUT WARRANTY OF ANY KIND, either express or  implied. Please refer to
 * the license for the specific language governing your rights and limitations.
 */

/*!
 * Copyright 2002 - 2013 Webdetails, a Pentaho company.  All rights reserved.
 * 
 * This software was developed by Webdetails and is provided under the terms
 * of the Mozilla Public License, Version 2.0, or any later version. You may not use
 * this file except in compliance with the license. If you need a copy of the license,
 * please go to  http://mozilla.org/MPL/2.0/. The Initial Developer is Webdetails.
 *
 * Software distributed under the Mozilla Public License is distributed on an "AS IS"
 * basis, WITHOUT WARRANTY OF ANY KIND, either express or  implied. Please refer to
 * the license for the specific language governing your rights and limitations.
 */

/*! Copyright 2010 Stanford Visualization Group, Mike Bostock, BSD license. */

/*! 539b7b4908c29303d90a687962d250d90abf0def */

/*
 * TERMS OF USE - EASING EQUATIONS
 *
 * Open source under the BSD License.
 *
 * Copyright 2001 Robert Penner
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * - Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 *
 * - Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 *
 * - Neither the name of the author nor the names of contributors may be used to
 *   endorse or promote products derived from this software without specific
 *   prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */

Array.prototype.map||(Array.prototype.map=function(a,b){for(var c=this.length,d=new Array(c),e=0;c>e;e++)e in this&&(d[e]=a.call(b,this[e],e,this));return d}),Array.prototype.filter||(Array.prototype.filter=function(a,b){for(var c=this.length,d=new Array,e=0;c>e;e++)if(e in this){var f=this[e];a.call(b,f,e,this)&&d.push(f)}return d}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=this.length>>>0,d=0;c>d;d++)d in this&&a.call(b,this[d],d,this)}),Array.prototype.reduce||(Array.prototype.reduce=function(a,b){var c=this.length;if(!c&&1==arguments.length)throw new Error("reduce: empty array, no initial value");var d=0;if(arguments.length<2)for(;;){if(d in this){b=this[d++];break}if(++d>=c)throw new Error("reduce: no values, no initial value")}for(;c>d;d++)d in this&&(b=a(b,this[d],d,this));return b}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=this.length>>>0,d=!isFinite(b)||0>b?0:b>this.length?this.length:b;c>d;d++)if(this[d]===a)return d;return-1}),Date.now||(Date.now=function(){return+new Date}),Object.create||(Object.create=function(a){function b(){}return b.prototype=a,new b});var pv={};pv.version={major:3,minor:3},pv.identity=function(a){return a},pv.index=function(){return this.index},pv.child=function(){return this.childIndex},pv.parent=function(){return this.parent.index},!function(){pv.extend=function(a){return Object.create(a.prototype||a)},pv.extendType=function(a,b){var c=a.prototype=pv.extend(b);return c.constructor=a,a},pv.parse=function(a){for(var b,c,d=new RegExp("function\\s*(\\b\\w+)?\\s*\\([^)]*\\)\\s*","mg"),e=0,f="";b=d.exec(a);){var g=b.index+b[0].length;if("{"!=a.charAt(g)){f+=a.substring(e,g)+"{return ",e=g;for(var h=0;h>=0&&g<a.length;g++){var i=a.charAt(g);switch(i){case'"':case"'":for(;++g<a.length&&(c=a.charAt(g))!=i;)"\\"==c&&g++;break;case"[":case"(":h++;break;case"]":case")":h--;break;case";":case",":0==h&&h--}}f+=pv.parse(a.substring(e,--g))+";}",e=g}d.lastIndex=g}return f+=a.substring(e)},pv.error=function(a){"undefined"!=typeof console&&console.error?console.error(a):alert(a)},pv.listen=function(a,b,c){return c=pv.listener(c),"load"===b||"onload"===b?pv.listenForPageLoad(c):(a.addEventListener?a.addEventListener(b,c,!1):(a===window&&(a=document.documentElement),a.attachEvent("on"+b,c)),c)},pv.unlisten=function(a,b,c){c.$listener&&(c=c.$listener),a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)},pv.listenForPageLoad=function(a){"complete"!==document.readyState?document.addEventListener?window.addEventListener("load",a,!1):document.attachEvent&&window.attachEvent("onload",a):a(null)},pv.listener=function(a){return a.$listener||(a.$listener=function(b){try{return pv.event=b=b&&pv.fixEvent(b),a.call(this,b)}catch(a){pv.error(a)}finally{delete pv.event}})},pv.fixEvent=function(a){if(null==a.pageX&&null!=a.clientX){var b=a.target&&a.target.ownerDocument||document,c=b.documentElement,d=b.body;a.pageX=1*a.clientX+(c&&c.scrollLeft||d&&d.scrollLeft||0)-(c&&c.clientLeft||d&&d.clientLeft||0),a.pageY=1*a.clientY+(c&&c.scrollTop||d&&d.scrollTop||0)-(c&&c.clientTop||d&&d.clientTop||0)}return a},pv.ancestor=function(a,b){for(;b;){if(b===a)return!0;b=b.parentNode}return!1},pv.removeChildren=function(a){for(;a.lastChild;)a.removeChild(a.lastChild)},pv.getWindow=function(a){return null!=a&&a==a.window?a:9===a.nodeType&&(a.defaultView||a.parentWindow)};var a=/\-([a-z])/g;pv.hiphen2camel=function(b){return a.test(b)?b.replace(a,function(a,b){return b.toUpperCase()}):b};var b=window.getComputedStyle;pv.css=function(a,c){return b?b.call(window,a,null).getPropertyValue(c):a.currentStyle["float"===c?"styleFloat":pv.hiphen2camel(c)]},pv.cssStyle=function(a){var c;return b?(c=b.call(window,a,null),function(a){return c.getPropertyValue(a)}):(c=a.currentStyle,function(a){return c["float"===a?"styleFloat":pv.hiphen2camel(a)]})},pv._getElementsByClass=function(a,b){null==b&&(b=document);for(var c=[],d=b.getElementsByTagName("*"),e=d.length,f=new RegExp("(^|\\s)"+a+"(\\s|$)"),g=0,h=0;e>g;g++)f.test(d[g].className)&&(c[h]=d[g],h++);return c},pv.getElementsByClassName=function(a,b){return a.getElementsByClassName?a.getElementsByClassName(b):pv._getElementsByClass(b,a)},pv.elementOffset=function(a){var b=a&&a.ownerDocument;if(b){var c=b.body;if(c!==a){var d;d="undefined"!=typeof a.getBoundingClientRect?a.getBoundingClientRect():{top:0,left:0};var e=pv.getWindow(b),f=b.documentElement,g=f.clientTop||c.clientTop||0,h=f.clientLeft||c.clientLeft||0,i=e.pageYOffset||f.scrollTop,j=e.pageXOffset||f.scrollLeft;return{top:d.top+i-g,left:d.left+j-h}}}},pv.renderer=function(){var a=document.svgImplementation||"nativesvg";return pv.renderer=function(){return a},a};var c=1;pv.id=function(){return c++},pv.functor=function(a){return"function"==typeof a?a:function(){return a}},pv.get=function(a,b,c){var d;return a&&null!=(d=a[b])?d:c};var d=Object.prototype.hasOwnProperty;pv.lazyArrayOwn=function(a,b){var c;return a&&d.call(a,b)&&(c=a[b])?c:a[b]=[]}}(),pv.listen(window,"load",function(){for(pv.$={i:0,x:document.getElementsByTagName("script")},pv.$.xlen=pv.$.x.length;pv.$.i<pv.$.xlen;pv.$.i++)if(pv.$.s=pv.$.x[pv.$.i],"text/javascript+protovis"==pv.$.s.type)try{window.eval(pv.parse(pv.$.s.text))}catch(a){pv.error(a)}delete pv.$}),pv.Format={},pv.Format.re=function(a){return a.replace(/[\\\^\$\*\+\?\[\]\(\)\.\{\}]/g,"\\$&")},pv.Format.pad=function(a,b,c){var d=b-String(c).length;return 1>d?c:new Array(d+1).join(a)+c},pv.Format.date=function(a){function b(b){return a.replace(/%[a-zA-Z0-9]/g,function(a){switch(a){case"%a":return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][b.getDay()];case"%A":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][b.getDay()];case"%h":case"%b":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][b.getMonth()];case"%B":return["January","February","March","April","May","June","July","August","September","October","November","December"][b.getMonth()];case"%c":return b.toLocaleString();case"%C":return c("0",2,Math.floor(b.getFullYear()/100)%100);case"%d":return c("0",2,b.getDate());case"%x":case"%D":return c("0",2,b.getMonth()+1)+"/"+c("0",2,b.getDate())+"/"+c("0",2,b.getFullYear()%100);case"%e":return c(" ",2,b.getDate());case"%H":return c("0",2,b.getHours());case"%I":var d=b.getHours()%12;return d?c("0",2,d):12;case"%m":return c("0",2,b.getMonth()+1);case"%M":return c("0",2,b.getMinutes());case"%n":return"\n";case"%p":return b.getHours()<12?"AM":"PM";case"%T":case"%X":case"%r":var d=b.getHours()%12;return(d?c("0",2,d):12)+":"+c("0",2,b.getMinutes())+":"+c("0",2,b.getSeconds())+" "+(b.getHours()<12?"AM":"PM");case"%R":return c("0",2,b.getHours())+":"+c("0",2,b.getMinutes());case"%S":return c("0",2,b.getSeconds());case"%Q":return c("0",3,b.getMilliseconds());case"%t":return"\t";case"%u":var e=b.getDay();return e?e:1;case"%w":return b.getDay();case"%y":return c("0",2,b.getFullYear()%100);case"%Y":return b.getFullYear();case"%%":return"%"}return a})}var c=pv.Format.pad;return b.format=b,b.parse=function(b){var c=1970,d=0,e=1,f=0,g=0,h=0,i=[function(){}],j=pv.Format.re(a).replace(/%[a-zA-Z0-9]/g,function(a){switch(a){case"%b":return i.push(function(a){d={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[a]}),"([A-Za-z]+)";case"%h":case"%B":return i.push(function(a){d={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11}[a]}),"([A-Za-z]+)";case"%e":case"%d":return i.push(function(a){e=a}),"([0-9]+)";case"%I":case"%H":return i.push(function(a){f=a}),"([0-9]+)";case"%m":return i.push(function(a){d=a-1}),"([0-9]+)";case"%M":return i.push(function(a){g=a}),"([0-9]+)";case"%p":return i.push(function(a){12==f?"am"==a&&(f=0):"pm"==a&&(f=Number(f)+12)}),"(am|pm)";case"%S":return i.push(function(a){h=a}),"([0-9]+)";case"%y":return i.push(function(a){a=Number(a),c=a+(a>=0&&69>a?2e3:a>=69&&100>a?1900:0)}),"([0-9]+)";case"%Y":return i.push(function(a){c=a}),"([0-9]+)";case"%%":return i.push(function(){}),"%"}return a}),k=b.match(j);return k&&k.forEach(function(a,b){i[b](a)}),new Date(c,d,e,f,g,h)},b},pv.Format.time=function(a){function b(b){switch(b=Number(b),a){case"short":return b>=31536e6?(b/31536e6).toFixed(1)+" years":b>=6048e5?(b/6048e5).toFixed(1)+" weeks":b>=864e5?(b/864e5).toFixed(1)+" days":b>=36e5?(b/36e5).toFixed(1)+" hours":b>=6e4?(b/6e4).toFixed(1)+" minutes":(b/1e3).toFixed(1)+" seconds";case"long":var d=[],e=b%6e4/1e3>>0,f=b%36e5/6e4>>0;if(d.push(c("0",2,e)),b>=36e5){var g=b%864e5/36e5>>0;d.push(c("0",2,f)),b>=864e5?(d.push(c("0",2,g)),d.push(Math.floor(b/864e5).toFixed())):d.push(g.toFixed())}else d.push(f.toFixed());return d.reverse().join(":")}}var c=pv.Format.pad;return b.format=b,b.parse=function(b){switch(a){case"short":for(var c,d=/([0-9,.]+)\s*([a-z]+)/g,e=0;c=d.exec(b);){var f=parseFloat(c[0].replace(",","")),g=0;switch(c[2].toLowerCase()){case"year":case"years":g=31536e6;break;case"week":case"weeks":g=6048e5;break;case"day":case"days":g=864e5;break;case"hour":case"hours":g=36e5;break;case"minute":case"minutes":g=6e4;break;case"second":case"seconds":g=1e3}e+=f*g}return e;case"long":var c=b.replace(",","").split(":").reverse(),e=0;return c.length&&(e+=1e3*parseFloat(c[0])),c.length>1&&(e+=6e4*parseFloat(c[1])),c.length>2&&(e+=36e5*parseFloat(c[2])),c.length>3&&(e+=864e5*parseFloat(c[3])),e}},b},pv.Format.number=function(){function a(a){1/0>f&&(a=Math.round(a*g)/g);var o=String(Math.abs(a)).split("."),p=o[0];p.length>c&&(p=p.substring(p.length-c)),j&&p.length<b&&(p=new Array(b-p.length+1).join(h)+p),p.length>3&&(p=p.replace(/\B(?=(?:\d{3})+(?!\d))/g,l)),!j&&p.length<d&&(p=new Array(d-p.length+1).join(h)+p),o[0]=0>a?m+p+n:p;var q=o[1]||"";return q.length>f&&(q=o[1]=q.substr(0,f)),q.length<e&&(o[1]=q+new Array(e-q.length+1).join(i)),o.join(k)}var b=0,c=1/0,d=0,e=0,f=0,g=1,h="0",i="0",j=!0,k=".",l=",",m="âˆ’",n="";return a.format=a,a.parse=function(a){var b=pv.Format.re,d=String(a).split(k);1==d.length&&(d[1]=""),d[0].replace(new RegExp("^("+b(h)+")*"),""),d[1].replace(new RegExp("("+b(i)+")*$"),"");var e=d[0].replace(new RegExp(b(l),"g"),"");e.length>c&&(e=e.substring(e.length-c));var j=d[1]?Number("0."+d[1]):0;return 1/0>f&&(j=Math.round(j*g)/g),Math.round(e)+j},a.integerDigits=function(a,e){return arguments.length?(b=Number(a),c=arguments.length>1?Number(e):b,d=b+Math.floor(b/3)*l.length,this):[b,c]},a.fractionDigits=function(a,b){return arguments.length?(e=Number(a),f=arguments.length>1?Number(b):e,g=Math.pow(10,f),this):[e,f]},a.integerPad=function(a){return arguments.length?(h=String(a),j=/\d/.test(h),this):h},a.fractionPad=function(a){return arguments.length?(i=String(a),this):i},a.decimal=function(a){return arguments.length?(k=String(a),this):k},a.group=function(a){return arguments.length?(l=a?String(a):"",d=b+Math.floor(b/3)*l.length,this):l},a.negativeAffix=function(a,b){return arguments.length?(m=String(a||""),n=String(b||""),this):[m,n]},a},!function(){var a;pv.Text={},pv.Text.createCache=function(){return new b},pv.Text.usingCache=function(c,d,e){if(!(c instanceof b))throw new Error("Not a valid cache.");var f=a;a=c;try{return d.call(e)}finally{a=f}},pv.Text.measure=function(b,c){b=null==b?"":String(b);var d=a&&a.get(c,b);return d||(d=b?this.measureCore(b,c):{width:0,height:0},a&&a.put(c,b,d)),d},pv.Text.measureWidth=function(a,b){return pv.Text.measure(a,b).width},pv.Text.fontHeight=function(a){return pv.Text.measure("M",a).height},pv.Text.measureCore=function(){function a(){return c||(c=b())}function b(){var a=document.createElement("div");a.id="pvSVGText_"+(new Date).getTime();var b=a.style;b.position="absolute",b.visibility="hidden",b.width=0,b.height=0,b.left=0,b.top=0,b.lineHeight=1,b.textTransform="none",b.letterSpacing="normal",b.whiteSpace="nowrap";var c=pv.SvgScene.create("svg");c.setAttribute("font-size","10px"),c.setAttribute("font-family","sans-serif"),a.appendChild(c);var d=pv.SvgScene.create("text");return c.appendChild(d),d.appendChild(document.createTextNode("")),document.body.appendChild(a),d}var c,d="10px sans-serif";return function(b,c){c||(c=null);var e=a();d!==c&&(d=c,pv.SvgScene.setStyle(e,{font:c})),e.firstChild.nodeValue=String(b);var f;try{f=e.getBBox()}catch(a){throw"function"==typeof console.error&&console.error("GetBBox failed: ",a),a}return{width:f.width,height:f.height}}}();var b=function(){this._fontsCache={}},c=Object.prototype.hasOwnProperty;b.prototype._getFont=function(a){return a=a||"",c.call(this._fontsCache,a)?this._fontsCache[a]:this._fontsCache[a]={}},b.prototype.get=function(a,b){b=b||"";var d=this._getFont(a);return c.call(d,b)?d[b]:null},b.prototype.put=function(a,b,c){return this._getFont(a)[b||""]=c}}(),pv.map=function(a,b){var c={};return b?a.map(function(a,d){return c.index=d,b.call(c,a)}):a.slice()},pv.repeat=function(a,b){return 1==arguments.length&&(b=2),pv.blend(pv.range(b).map(function(){return a}))},pv.array=function(a,b){var c=a>=0?new Array(a):[];if(void 0!==b)for(var d=0;a>d;d++)c[d]=b;return c},pv.cross=function(a,b){for(var c=[],d=0,e=a.length,f=b.length;e>d;d++)for(var g=0,h=a[d];f>g;g++)c.push([h,b[g]]);return c},pv.blend=function(a){return Array.prototype.concat.apply([],a)},pv.transpose=function(a){var b=a.length,c=pv.max(a,function(a){return a.length});if(c>b){a.length=c;for(var d=b;c>d;d++)a[d]=new Array(b);for(var d=0;b>d;d++)for(var e=d+1;c>e;e++){var f=a[d][e];a[d][e]=a[e][d],a[e][d]=f}}else{for(var d=0;c>d;d++)a[d].length=b;for(var d=0;b>d;d++)for(var e=0;d>e;e++){var f=a[d][e];a[d][e]=a[e][d],a[e][d]=f}}a.length=c;for(var d=0;c>d;d++)a[d].length=b;return a},pv.normalize=function(a,b){for(var c=pv.map(a,b),d=pv.sum(c),e=0;e<c.length;e++)c[e]/=d;return c},pv.permute=function(a,b,c){c||(c=pv.identity);var d=new Array(b.length),e={};return b.forEach(function(b,f){e.index=b,d[f]=c.call(e,a[b])}),d},pv.numerate=function(a,b){b||(b=pv.identity);var c={},d={};return a.forEach(function(a,e){d.index=e,c[b.call(d,a)]=e}),c},pv.uniq=function(a,b){b||(b=pv.identity);var c,d={},e=[],f={};return a.forEach(function(a,g){f.index=g,c=b.call(f,a),c in d||(d[c]=e.push(c))}),e},pv.naturalOrder=function(a,b){return b>a?-1:a>b?1:0},pv.reverseOrder=function(a,b){return a>b?-1:b>a?1:0},pv.search=function(a,b,c){c||(c=pv.identity);for(var d=0,e=a.length-1;e>=d;){var f=d+e>>1,g=c(a[f]);if(b>g)d=f+1;else{if(!(g>b))return f;e=f-1}}return-d-1},pv.search.index=function(a,b,c){var d=pv.search(a,b,c);return 0>d?-d-1:d},pv.range=function(a,b,c){if(1==arguments.length&&(b=a,a=0),void 0==c&&(c=1),(b-a)/c==1/0)throw new Error("range must be finite");var d,e=[],f=0;if(b-=1e-10*(b-a),0>c)for(;(d=a+c*f++)>b;)e.push(d);else for(;(d=a+c*f++)<b;)e.push(d);return e},pv.random=function(a,b,c){return 1==arguments.length&&(b=a,a=0),void 0==c&&(c=1),c?Math.floor(Math.random()*(b-a)/c)*c+a:Math.random()*(b-a)+a},pv.sum=function(a,b){var c={};return a.reduce(b?function(a,d,e){return c.index=e,a+b.call(c,d)}:function(a,b){return a+b},0)},pv.max=function(a,b){return b==pv.index?a.length-1:Math.max.apply(null,b?pv.map(a,b):a)},pv.max.index=function(a,b){if(!a.length)return-1;if(b==pv.index)return a.length-1;b||(b=pv.identity);for(var c=0,d=-1/0,e={},f=0;f<a.length;f++){e.index=f;var g=b.call(e,a[f]);g>d&&(d=g,c=f)}return c},pv.min=function(a,b){return b==pv.index?0:Math.min.apply(null,b?pv.map(a,b):a)},pv.min.index=function(a,b){if(!a.length)return-1;if(b==pv.index)return 0;b||(b=pv.identity);for(var c=0,d=1/0,e={},f=0;f<a.length;f++){e.index=f;var g=b.call(e,a[f]);d>g&&(d=g,c=f)}return c},pv.mean=function(a,b){return pv.sum(a,b)/a.length},pv.median=function(a,b){if(b==pv.index)return(a.length-1)/2;if(a=pv.map(a,b).sort(pv.naturalOrder),a.length%2)return a[Math.floor(a.length/2)];var c=a.length/2;return(a[c-1]+a[c])/2},pv.variance=function(a,b){if(a.length<1)return NaN;if(1==a.length)return 0;var c=pv.mean(a,b),d=0,e={};b||(b=pv.identity);for(var f=0;f<a.length;f++){e.index=f;var g=b.call(e,a[f])-c;d+=g*g}return d},pv.deviation=function(a,b){return Math.sqrt(pv.variance(a,b)/(a.length-1))},pv.log=function(a,b){return Math.log(a)/Math.log(b)},pv.logSymmetric=function(a,b){return 0==a?0:0>a?-pv.log(-a,b):pv.log(a,b)},pv.logAdjusted=function(a,b){if(!isFinite(a))return a;var c=0>a;return b>a&&(a+=(b-a)/b),c?-pv.log(a,b):pv.log(a,b)},pv.logFloor=function(a,b){return a>0?Math.pow(b,Math.floor(pv.log(a,b))):-Math.pow(b,-Math.floor(-pv.log(-a,b)))},pv.logCeil=function(a,b){return a>0?Math.pow(b,Math.ceil(pv.log(a,b))):-Math.pow(b,-Math.ceil(-pv.log(-a,b)))},!function(){var a=Math.PI/180,b=180/Math.PI;pv.radians=function(b){return a*b},pv.degrees=function(a){return b*a}}(),pv.keys=function(a){var b=[];for(var c in a)b.push(c);return b},pv.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},pv.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},pv.dict=function(a,b){for(var c={},d={},e=0;e<a.length;e++)if(e in a){var f=a[e];d.index=e,c[f]=b.call(d,f)}return c},pv.hasOwnProp=Object.prototype.hasOwnProperty,pv.copyOwn=function(a,b){if(b){var c=pv.hasOwnProp;for(var d in b)c.call(b,d)&&(a[d]=b[d])}return a},pv.dom=function(a){return new pv.Dom(a)},pv.Dom=function(a){this.$map=a},pv.Dom.prototype.$leaf=function(a){return"object"!=typeof a},pv.Dom.prototype.leaf=function(a){return arguments.length?(this.$leaf=a,this):this.$leaf},pv.Dom.prototype.root=function(a){function b(a){var d=new pv.Dom.Node;for(var e in a){var f=a[e];d.appendChild(c(f)?new pv.Dom.Node(f):b(f)).nodeName=e}return d}var c=this.$leaf,d=b(this.$map);return d.nodeName=a,d},pv.Dom.prototype.nodes=function(){return this.root().nodes()},pv.Dom.Node=function(a){void 0!==a&&(this.nodeValue=a)},pv.Dom.Node.prototype.nodeValue=void 0,pv.Dom.Node.prototype.childNodes=[],pv.Dom.Node.prototype.parentNode=null,pv.Dom.Node.prototype.firstChild=null,pv.Dom.Node.prototype.lastChild=null,pv.Dom.Node.prototype.previousSibling=null,pv.Dom.Node.prototype.nextSibling=null,pv.Dom.Node.prototype._firstDirtyChildIndex=1/0,pv.Dom.Node.prototype._childIndex=-1,pv.Dom.Node.prototype.findChildIndex=function(a){if(!a)throw new Error("Argument 'n' required");if(a.parentNode===this){var b=a.childIndex(!0);if(b>-1)return b}throw new Error("child not found")},pv.Dom.Node.prototype._childRemoved=function(){},pv.Dom.Node.prototype._childAdded=function(){},pv.Dom.Node.prototype.removeChild=function(a){var b=this.findChildIndex(a);return this.removeAt(b)},pv.Dom.Node.prototype.appendChild=function(a){var b=a.parentNode;b&&b.removeChild(a);var c=this.lastChild;a.parentNode=this,a.previousSibling=c,c?(c.nextSibling=a,a._childIndex=c._childIndex+1):(this.firstChild=a,a._childIndex=0),this.lastChild=a;var d=pv.lazyArrayOwn(this,"childNodes").push(a);return this._childAdded(a,d-1),a},pv.Dom.Node.prototype.insertBefore=function(a,b){if(!b)return this.appendChild(a);var c=this.findChildIndex(b);return this.insertAt(a,c)},pv.Dom.Node.prototype.insertAt=function(a,b){if(null==b)return this.appendChild(a);var c=this.childNodes,d=c.length;if(b===d)return this.appendChild(a);if(0>b||b>d)throw new Error("Index out of range.");var e=a.parentNode;e&&e.removeChild(a);var f=b+1;f<this._firstDirtyChildIndex&&(this._firstDirtyChildIndex=f);var g=c[b];a.parentNode=this,a.nextSibling=g,a._childIndex=b;var h=a.previousSibling=g.previousSibling;return g.previousSibling=a,h?h.nextSibling=a:(g===this.lastChild&&(this.lastChild=a),this.firstChild=a),c.splice(b,0,a),this._childAdded(a,b),a},pv.Dom.Node.prototype.removeAt=function(a){var b=this.childNodes,c=b.length;if(!(0>a||a>=c)){var d=b[a];b.splice(a,1),c-1>a&&a<this._firstDirtyChildIndex&&(this._firstDirtyChildIndex=a);var e=d.previousSibling,f=d.nextSibling;return e?e.nextSibling=f:this.firstChild=f,f?f.previousSibling=e:this.lastChild=e,d.nextSibling=d.previousSibling=d.parentNode=null,this._childRemoved(d,a),d}},pv.Dom.Node.prototype.replaceChild=function(a,b){var c=this.findChildIndex(b),d=a.parentNode;d&&d.removeChild(a),a.parentNode=this,a.nextSibling=b.nextSibling,a._childIndex=b._childIndex;var e=a.previousSibling=b.previousSibling;e?e.nextSibling=a:this.firstChild=a;var f=b.nextSibling;return f?f.previousSibling=a:this.lastChild=a,this.childNodes[c]=a,this._childRemoved(b,c),this._childAdded(a,c),b},pv.Dom.Node.prototype.childIndex=function(a){var b=this.parentNode;if(b){var c=b._firstDirtyChildIndex;if(1/0>c){var d=b.childNodes;if(!a)return d.indexOf(this);for(var e=d.length;e>c;)d[c]._childIndex=c,c++;b._firstDirtyChildIndex=1/0}return this._childIndex}return-1},pv.Dom.Node.prototype.visitBefore=function(a){function b(c,d){a(c,d);for(var e=c.firstChild;e;e=e.nextSibling)b(e,d+1)}b(this,0)},pv.Dom.Node.prototype.visitAfter=function(a){function b(c,d){for(var e=c.firstChild;e;e=e.nextSibling)b(e,d+1);a(c,d)}b(this,0)},pv.Dom.Node.prototype.sort=function(a){if(this.firstChild){this._firstDirtyChildIndex=1/0;var b=this.childNodes;b.sort(a);var c,d=this.firstChild=b[0];delete d.previousSibling,d._childIndex=0;for(var e=1,f=b.length;f>e;e++)d.sort(a),c=b[e],c._childIndex=e,c.previousSibling=d,d=d.nextSibling=c;this.lastChild=d,delete d.nextSibling,d.sort(a)}return this},pv.Dom.Node.prototype.reverse=function(){var a=[];return this.visitAfter(function(b){this._firstDirtyChildIndex=1/0;for(var c;c=b.lastChild;)a.push(b.removeChild(c));if(a.length)for(;c=a.pop();)b.insertBefore(c,b.firstChild)}),this},pv.Dom.Node.prototype.nodes=function(){var a=[];return this.visitBefore(function(b){a.push(b)}),a},pv.Dom.Node.prototype.toggle=function(a){if(a)return this.toggled?this.visitBefore(function(a){a.toggled&&a.toggle()}):this.visitAfter(function(a){a.toggled||a.toggle()});var b,c=this;if(c.toggled){for(;b=c.toggled.pop();)c.appendChild(b);delete c.toggled}else if(b=c.lastChild){c.toggled=[];do c.toggled.push(c.removeChild(b));while(b=c.lastChild)}},pv.nodes=function(a){for(var b=new pv.Dom.Node,c=0,d=a.length;d>c;c++)b.appendChild(new pv.Dom.Node(a[c]));return b.nodes()},pv.tree=function(a){return new pv.Tree(a)},pv.Tree=function(a){this.array=a},pv.Tree.prototype.keys=function(a){return this.k=a,this},pv.Tree.prototype.value=function(a){return this.v=a,this},pv.Tree.prototype.map=function(){for(var a={},b={},c=0;c<this.array.length;c++){b.index=c;for(var d=this.array[c],e=this.k.call(b,d),f=a,g=0;g<e.length-1;g++)f=f[e[g]]||(f[e[g]]={});f[e[g]]=this.v?this.v.call(b,d):d}return a},pv.nest=function(a){return new pv.Nest(a)},pv.Nest=function(a){this.array=a,this.keys=[]},pv.Nest.prototype.key=function(a){return this.keys.push(a),this},pv.Nest.prototype.sortKeys=function(a){return this.keys[this.keys.length-1].order=a||pv.naturalOrder,this},pv.Nest.prototype.sortValues=function(a){return this.order=a||pv.naturalOrder,this},pv.Nest.prototype.map=function(){for(var a,b={},c=[],d=0;d<this.array.length;d++){var e=this.array[d],f=b;for(a=0;a<this.keys.length-1;a++){var g=this.keys[a](e);f[g]||(f[g]={}),f=f[g]}if(g=this.keys[a](e),!f[g]){var h=[];c.push(h),f[g]=h}f[g].push(e)}if(this.order)for(var a=0;a<c.length;a++)c[a].sort(this.order);return b},pv.Nest.prototype.entries=function(){function a(b){var c=[];for(var d in b){var e=b[d];c.push({key:d,values:e instanceof Array?e:a(e)})}return c}function b(a,c){var d=this.keys[c].order;if(d&&a.sort(function(a,b){return d(a.key,b.key)}),++c<this.keys.length)for(var e=0;e<a.length;e++)b.call(this,a[e].values,c);return a}return b.call(this,a(this.map()),0)},pv.Nest.prototype.rollup=function(a){function b(c){for(var d in c){var e=c[d];e instanceof Array?c[d]=a(e):b(e)}return c}return b(this.map())},pv.flatten=function(a){return new pv.Flatten(a)},pv.Flatten=function(a){this.map=a,this.keys=[]},pv.Flatten.prototype.key=function(a,b){return this.keys.push({name:a,value:b}),delete this.$leaf,this},pv.Flatten.prototype.leaf=function(a){return this.keys.length=0,this.$leaf=a,this},pv.Flatten.prototype.array=function(){function a(b,e){if(f(b))c.push({keys:d.slice(),value:b});else for(var g in b)d.push(g),a(b[g],e+1),d.pop()}function b(a,f){if(f<e.length-1)for(var g in a)d.push(g),b(a[g],f+1),d.pop();else c.push(d.concat(a))}var c=[],d=[],e=this.keys,f=this.$leaf;return f?(a(this.map,0),c):(b(this.map,0),c.map(function(a){for(var b={},c=0;c<e.length;c++){var d=e[c],f=a[c];b[d.name]=d.value?d.value.call(null,f):f}return b}))},pv.Transform=function(){},pv.Transform.prototype={k:1,x:0,y:0},pv.Transform.identity=new pv.Transform,pv.Transform.prototype.translate=function(a,b){var c=new pv.Transform;return c.k=this.k,c.x=this.k*a+this.x,c.y=this.k*b+this.y,c},pv.Transform.prototype.scale=function(a){var b=new pv.Transform;return b.k=this.k*a,b.x=this.x,b.y=this.y,b},pv.Transform.prototype.invert=function(){var a=new pv.Transform,b=1/this.k;return a.k=b,a.x=-this.x*b,a.y=-this.y*b,a},pv.Transform.prototype.times=function(a){var b=new pv.Transform;return b.k=this.k*a.k,b.x=this.k*a.x+this.x,b.y=this.k*a.y+this.y,b},pv.Scale=function(){},pv.Scale.interpolator=function(a,b){if("number"==typeof a)return function(c){return c*(b-a)+a};var c=a.type&&"solid"!==a.type,d=b.type&&"solid"!==b.type;return c||d?(a=c?a:pv.color(a).rgb(),b=d?b:pv.color(b).rgb(),function(c){return.5>c?a:b}):(a=pv.color(a).rgb(),b=pv.color(b).rgb(),function(c){var d=a.a*(1-c)+b.a*c;return 1e-5>d&&(d=0),0==a.a?pv.rgb(b.r,b.g,b.b,d):0==b.a?pv.rgb(a.r,a.g,a.b,d):pv.rgb(Math.round(a.r*(1-c)+b.r*c),Math.round(a.g*(1-c)+b.g*c),Math.round(a.b*(1-c)+b.b*c),d)})},pv.Scale.common={by:function(a){function b(){return c(a.apply(this,arguments))}var c=this;for(var d in c)b[d]=c[d];return b},by1:function(a){function b(b){return c(a.call(this,b))}var c=this;for(var d in c)b[d]=c[d];return b},transform:function(a){function b(){return a.call(this,c.apply(c,arguments))}var c=this;for(var d in c)b[d]=c[d];return b}},pv.Scale.quantitative=function(){function a(a){return new Date(a)}function b(a){var b=pv.search(g,a);return 0>b&&(b=-b-2),b=Math.max(0,Math.min(j.length-1,b)),j[b]((m(a)-h[b])/(h[b+1]-h[b]))}var c,d,e,f,g=[0,1],h=[0,1],i=[0,1],j=[pv.identity],k=Number,l=!1,m=pv.identity,n=pv.identity,o=String,p=null;return b.transform=function(a,b){return m=function(b){return l?-a(-b):a(b)},n=function(a){return l?-b(-a):b(a)},h=g.map(m),this},b.domain=function(b,c,d){if(arguments.length){var e;return b instanceof Array?(arguments.length<2&&(c=pv.identity),arguments.length<3&&(d=c),e=b.length&&c(b[0]),g=b.length?[pv.min(b,c),pv.max(b,d)]:[]):(e=b,g=Array.prototype.slice.call(arguments).map(Number)),g.length?1==g.length&&(g=[g[0],g[0]]):g=[-1/0,1/0],l=(g[0]||g[g.length-1])<0,h=g.map(m),k=e instanceof Date?a:Number,this}return g.map(k)},b.range=function(){if(arguments.length){i=Array.prototype.slice.call(arguments),i.length?1==i.length&&(i=[i[0],i[0]]):i=[-1/0,1/0],j=[];for(var a=0;a<i.length-1;a++)j.push(pv.Scale.interpolator(i[a],i[a+1]));return this}return i},b.invert=function(a){var b=pv.search(i,a);return 0>b&&(b=-b-2),b=Math.max(0,Math.min(j.length-1,b)),k(n(h[b]+(a-i[b])/(i[b+1]-i[b])*(h[b+1]-h[b])))},b.ticks=function(b,h){function i(a,b){switch(b){case 31536e6:a.setMonth(0);case 2592e6:a.setDate(1);case 6048e5:6048e5==b&&a.setDate(a.getDate()-a.getDay());case 864e5:a.setHours(0);case 36e5:a.setMinutes(0);case 6e4:a.setSeconds(0);case 1e3:a.setMilliseconds(0)}}var j=g[0],l=g[g.length-1],m=j>l,n=m?l:j,p=m?j:l,q=p-n;if(!q||!isFinite(q))return k==a&&(o=pv.Format.date("%x")),[k(n)];var r=pv.get(h,"roundInside",!0);if(k==a){var s,t,u,v=null==b?5:b,w=1;q>=31536e6*v?(s=31536e6,t="%Y",u=function(a){a.setFullYear(a.getFullYear()+w)}):q>=2592e6*v?(s=2592e6,t="%m/%Y",u=function(a){a.setMonth(a.getMonth()+w)}):q>=6048e5*v?(s=6048e5,t="%m/%d",u=function(a){a.setDate(a.getDate()+7*w)}):q>=864e5*v?(s=864e5,t="%m/%d",u=function(a){a.setDate(a.getDate()+w)}):q>=36e5*v?(s=36e5,t="%I:%M %p",u=function(a){a.setHours(a.getHours()+w)}):q>=6e4*v?(s=6e4,t="%I:%M %p",u=function(a){a.setMinutes(a.getMinutes()+w)}):q>=1e3*v?(s=1e3,t="%I:%M:%S",u=function(a){a.setSeconds(a.getSeconds()+w)}):(s=1,t="%S.%Qs",u=function(a){a.setTime(a.getTime()+w)}),s=d?d:s,t=c?c:t,e=s,o=pv.Format.date(t);var x=new Date(n),y=[];i(x,s);var z=q/s;if(z>10)switch(s){case 36e5:w=z>20?6:3,x.setHours(Math.floor(x.getHours()/w)*w);break;case 2592e6:w=z>24?3:z>12?2:1,x.setMonth(Math.floor(x.getMonth()/w)*w);break;case 6048e5:w=z>15?3:z>10?2:1,x.setDate(1+7*Math.floor(x.getDate()/(7*w))*w);break;case 864e5:w=z>=30?5:z>=15?3:2,x.setDate(1+Math.floor(x.getDate()/w)*w);break;case 6e4:w=z>30?15:z>15?10:5,x.setMinutes(Math.floor(x.getMinutes()/w)*w);break;case 1e3:w=z>90?15:z>60?10:5,x.setSeconds(Math.floor(x.getSeconds()/w)*w);break;case 1:w=z>1e3?250:z>200?100:z>100?50:z>50?25:5,x.setMilliseconds(Math.floor(x.getMilliseconds()/w)*w);break;default:w=pv.logCeil(z/15,10),2>z/w?w/=5:5>z/w&&(w/=2),x.setFullYear(Math.floor(x.getFullYear()/w)*w)}if(d&&(w=1,u=function(a){a.setSeconds(a.getSeconds()+w*d/1e3)}),r)for(;u(x),!(x>p);)y.push(new Date(x));else{p=new Date(p),u(p);do y.push(new Date(x)),u(x);while(p>=x)}return m?y.reverse():y}null==b&&(b=10);var A=pv.get(h,"numberExponentMin",-1/0),B=pv.get(h,"numberExponentMax",1/0),C=Math.floor(pv.log(q/b,10)),D=!1;C>B?(C=B,D=!0):A>C&&(C=A,D=!0),w=Math.pow(10,C);var E=q/w,F=b/E;.15>=F&&B-1>C?(w*=10,E/=10):.35>=F?(w*=5,E/=5):.75>=F&&(w*=2,E/=2),C=Math.floor(pv.log(w,10)+1e-10),j=w*Math[r?"ceil":"floor"](n/w),l=w*Math[r?"floor":"ceil"](p/w),f=Math.max(0,-C),o=pv.Format.number().fractionDigits(f),2===b&&E>=2&&(w=l-j);var G=pv.range(j,l+w,w);return m&&G.reverse(),G.roundInside=r,G.step=w,G.exponent=C,G.exponentOverflow=D,G.exponentMin=A,G.exponentMax=B,G},b.dateTickFormat=function(){return arguments.length?(c=arguments[0],this):c},b.dateTickPrecision=function(){return arguments.length?(d=arguments[0],this):d},b.tickFormatter=function(a){return arguments.length?(p=a,this):p},b.tickFormat=function(a){var b;return b=p?p(a,k!==Number?e:f):o(a),null==b?"":""+b},b.nice=function(){if(2!=g.length)return this;var a=g[0],b=g[g.length-1],c=a>b,d=c?b:a,e=c?a:b,f=e-d;if(!f||!isFinite(f))return this;var i=Math.pow(10,Math.round(Math.log(f)/Math.log(10))-1);return g=[Math.floor(d/i)*i,Math.ceil(e/i)*i],c&&g.reverse(),h=g.map(m),this},pv.copyOwn(b,pv.Scale.common),b.domain.apply(b,arguments),b},pv.Scale.linear=function(){var a=pv.Scale.quantitative();return a.domain.apply(a,arguments),a},pv.Scale.log=function(){var a,b,c=pv.Scale.quantitative(1,10),d=function(a){return Math.log(a)/b},e=function(b){return Math.pow(a,b)};return c.ticks=function(){var b=c.domain(),f=b[0]<0,g=Math.floor(f?-d(-b[0]):d(b[0])),h=Math.ceil(f?-d(-b[1]):d(b[1])),i=[];if(f)for(i.push(-e(-g));g++<h;)for(var j=a-1;j>0;j--)i.push(-e(-g)*j);else{for(;h>g;g++)for(var j=1;a>j;j++)i.push(e(g)*j);i.push(e(g))}for(g=0;i[g]<b[0];g++);for(h=i.length;i[h-1]>b[1];h--);return i.slice(g,h)},c.tickFormat=function(a){return a.toPrecision(1)},c.nice=function(){var b=c.domain();return c.domain(pv.logFloor(b[0],a),pv.logCeil(b[1],a))},c.base=function(f){return arguments.length?(a=Number(f),b=Math.log(a),c.transform(d,e),this):a},c.domain.apply(c,arguments),c.base(10)},pv.Scale.root=function(){var a=pv.Scale.quantitative();return a.power=function(b){if(arguments.length){var c=Number(b),d=1/c;return a.transform(function(a){return Math.pow(a,d)},function(a){return Math.pow(a,c)}),this}return c},a.domain.apply(a,arguments),a.power(2)},pv.Scale.ordinal=function(){function a(a){return a in c||(c[a]=b.push(a)-1),d[c[a]%d.length]}var b=[],c={},d=[];return a.domain=function(a,d){if(arguments.length){a=a instanceof Array?arguments.length>1?pv.map(a,d):a:Array.prototype.slice.call(arguments),b=[];for(var e={},f=0;f<a.length;f++){var g=a[f];g in e||(e[g]=!0,b.push(g))}return c=pv.numerate(b),this}return b},a.range=function(a,b){return arguments.length?(d=a instanceof Array?arguments.length>1?pv.map(a,b):a:Array.prototype.slice.call(arguments),"string"==typeof d[0]&&(d=d.map(pv.fillStyle)),d.min=d[0],d.max=d[d.length-1],this):d},a.split=function(a,b){var c=b-a,e=this.domain().length,f=0;return 0===c?d=pv.array(e,a):e&&(f=(b-a)/e,d=pv.range(a+f/2,b,f)),d.min=a,d.max=b,d.step=f,this},a.splitBandedCenter=function(b,c,e){
return a.split(b,c),null==e&&(e=1),d.band=d.step*e,d.margin=d.step-d.band,d.min=b,d.max=c,this},a.splitBandedFlushCenter=function(a,b,c){null==c&&(c=1);var e=b-a,f=this.domain().length,g=0,h=0,i=0;return 0===e?d=pv.array(f,a):f&&(h=e*c/f,i=f>1?(e-f*h)/(f-1):0,g=i+h,d=pv.range(a+h/2,b,g)),d.step=g,d.band=h,d.margin=i,d.min=a,d.max=b,this},a.splitFlush=function(a,b){var c=this.domain().length,e=(b-a)/(c-1);return d=1==c?[(a+b)/2]:pv.range(a,b+e/2,e),d.min=a,d.max=b,this},a.splitBanded=function(a,b,c){if(arguments.length<3&&(c=1),0>c){var e=this.domain().length,f=-c*e,g=b-a-f,h=g/(e+1);d=pv.range(a+h,b,h-c),d.band=-c}else{var i=(b-a)/(this.domain().length+(1-c));d=pv.range(a+i*(1-c),b,i),d.band=i*c,d.step=i,d.margin=i-d.band}return d.min=a,d.max=b,this},a.invertIndex=function(a,b){var c=this.domain().length;if(0===c)return-1;var d=this.range(),e=d.max-d.min;if(0===e)return 0;var f=e/c;if(a>=d.max)return c;if(a<d.min)return 0;var g=(a-d.min)/f;return b?g:Math.round(g)},pv.copyOwn(a,pv.Scale.common),a.domain.apply(a,arguments),a},pv.Scale.quantile=function(){function a(a){return f(Math.max(0,Math.min(c,pv.search.index(d,a)-1))/c)}var b=-1,c=-1,d=[],e=[],f=pv.Scale.linear();return a.quantiles=function(a){if(arguments.length){if(b=Number(a),0>b)d=[e[0]].concat(e),c=e.length-1;else{d=[],d[0]=e[0];for(var f=1;b>=f;f++)d[f]=e[~~(f*(e.length-1)/b)];c=b-1}return this}return d},a.domain=function(c,d){return arguments.length?(e=c instanceof Array?pv.map(c,d):Array.prototype.slice.call(arguments),e.sort(pv.naturalOrder),a.quantiles(b),this):e},a.range=function(){return arguments.length?(f.range.apply(f,arguments),this):f.range()},pv.copyOwn(a,pv.Scale.common),a.domain.apply(a,arguments),a},pv.histogram=function(a,b){var c=!0;return{bins:function(d){var e=pv.map(a,b),f=[];arguments.length||(d=pv.Scale.linear(e).ticks());for(var g=0;g<d.length-1;g++){var h=f[g]=[];h.x=d[g],h.dx=d[g+1]-d[g],h.y=0}for(var g=0;g<e.length;g++){var i=pv.search.index(d,e[g])-1,h=f[Math.max(0,Math.min(f.length-1,i))];h.y++,h.push(a[g])}if(!c)for(var g=0;g<f.length;g++)f[g].y/=e.length;return f},frequency:function(a){return arguments.length?(c=Boolean(a),this):c}}},!function(){pv.Shape=function(){};var a={x:1,y:1};pv.Shape.dist2=function(b,c,d){d=d||a;var e=b.x-c.x,f=b.y-c.y,g=e*e,h=f*f;return{cost:g+h,dist2:d.x*g+d.y*h}};var b=Math.PI,c=2*b,d=Math.atan2;pv.Shape.normalizeAngle=function(a){return a%=c,0>a&&(a+=c),a},pv.Shape.atan2Norm=function(a,b){var e=d(a,b);return 0>e&&(e+=c),e},pv.Shape.prototype.hasArea=function(){return!0}}(),!function(){var a=pv.Shape.dist2,b=Math.cos,c=Math.sin,d=Math.sqrt;pv.vector=function(a,b){return new e(a,b)},pv.Vector=function(a,b){this.x=a,this.y=b};var e=pv.Shape.Point=pv.Vector;pv.Vector.prototype=pv.extend(pv.Shape),pv.Vector.prototype.perp=function(){return new e(-this.y,this.x)},pv.Vector.prototype.rotate=function(a){var d=b(a),f=c(a);return new e(d*this.x-f*this.y,f*this.x+d*this.y)},pv.Vector.prototype.norm=function(){var a=this.length();return this.times(a?1/a:1)},pv.Vector.prototype.length=function(){return d(this.x*this.x+this.y*this.y)},pv.Vector.prototype.times=function(a){return new e(this.x*a,this.y*a)},pv.Vector.prototype.plus=function(a,b){return 1==arguments.length?new e(this.x+a.x,this.y+a.y):new e(this.x+a,this.y+b)},pv.Vector.prototype.minus=function(a,b){return 1==arguments.length?new e(this.x-a.x,this.y-a.y):new e(this.x-a,this.y-b)},pv.Vector.prototype.dot=function(a,b){return 1==arguments.length?this.x*a.x+this.y*a.y:this.x*a+this.y*b},pv.Vector.prototype.hasArea=function(){return!1},pv.Vector.prototype.clone=function(){return new e(this.x,this.y)},pv.Vector.prototype.apply=function(a){return new e(a.x+a.k*this.x,a.y+a.k*this.y)},pv.Vector.prototype.intersectsRect=function(a){return this.x>=a.x&&this.x<=a.x2&&this.y>=a.y&&this.y<=a.y2},pv.Vector.prototype.containsPoint=function(a){return this.x===a.x&&this.y===a.y},pv.Vector.prototype.points=function(){return[this]},pv.Vector.prototype.edges=function(){return[]},pv.Vector.prototype.center=function(){return this},pv.Vector.prototype.distance2=function(b,c){return a(this,b,c)}}(),!function(){var a=pv.Shape.Point,b=pv.Shape.dist2;pv.Shape.Line=function(a,b,c,d){this.x=a||0,this.y=b||0,this.x2=c||0,this.y2=d||0};var c=pv.Shape.Line;c.prototype=pv.extend(pv.Shape),c.prototype.hasArea=function(){return!1},c.prototype.clone=function(){return new c(this.x,this.y,this.x2,this.x2)},c.prototype.apply=function(a){var b=a.x+a.k*this.x,d=a.y+a.k*this.y,e=a.x+a.k*this.x2,f=a.y+a.k*this.y2;return new c(b,d,e,f)},c.prototype.points=function(){return[new a(this.x,this.y),new a(this.x2,this.y2)]},c.prototype.edges=function(){return[this]},c.prototype.center=function(){return new a((this.x+this.x2)/2,(this.y+this.y2)/2)},c.prototype.normal=function(a,b){var c=this.points(),d=c[1].minus(c[0]).perp().norm();if(b){var e=c[0].minus(b);e.dot(d)<0&&(d=d.times(-1))}return d},c.prototype.intersectsRect=function(a){var b,c,d=this.points();for(c=d.length,b=0;c>b;b++)if(d[b].intersectsRect(a))return!0;var e=a.edges();for(c=e.length,b=0;c>b;b++)if(this.intersectsLine(e[b]))return!0;return!1},c.prototype.containsPoint=function(a){var b=this.x,c=this.x2,d=this.y,e=this.y2;return b<=a.x&&a.x<=c&&(b===c?Math.min(d,e)<=a.y&&a.y<=Math.max(d,e):Math.abs((e-d)/(c-b)*(a.x-b)+d-a.y)<=1e-10)},c.prototype.intersectsLine=function(a){var b=this,c=b.x2-b.x,d=b.y2-b.y,e=a.x2-a.x,f=a.y2-a.y,g=f*c-e*d;if(0===g)return!1;var h=b.y-a.y,i=b.x-a.x,j=e*h-f*i,k=c*h-d*i;if(0===g)return 0===j&&0===k;var l=j/g;if(0>l||l>1)return!1;var m=k/g;return!(0>m||m>1)},c.prototype.distance2=function(a,c){var d=this,e={x:this.x2,y:this.y2},f=b(d,e).dist2;if(1e-10>=f)return b(a,d,c);var g=e.x-d.x,h=e.y-d.y,i=((a.x-d.x)*g+(a.y-d.y)*h)/f;if(0>i)return b(a,d,c);if(i>1)return b(a,e,c);var j={x:d.x+i*g,y:d.y+i*h};return b(a,j,c)}}(),!function(){var a=pv.Shape.Point,b=pv.Shape.Line;pv.Shape.Polygon=function(a){this._points=a||[]};var c=pv.Shape.Polygon;c.prototype=pv.extend(pv.Shape),c.prototype.points=function(){return this._points},c.prototype.clone=function(){return new c(this.points().slice())},c.prototype.apply=function(a){for(var b=this.points(),d=b.length,e=new Array(d),f=0;d>f;f++)e[f]=b[f].apply(a);return new c(e)},c.prototype.intersectsRect=function(a){var b,c,d=this.points();for(c=d.length,b=0;c>b;b++)if(d[b].intersectsRect(a))return!0;var e=this.edges();for(c=e.length,b=0;c>b;b++)if(e[b].intersectsRect(a))return!0;return!1},c.prototype.edges=function(){var a=this._edges;if(!a){a=this._edges=[];var c=this.points(),d=c.length;if(d){for(var e,f=c[0],g=f,h=1;d>h;h++)e=c[h],a.push(new b(f.x,f.y,e.x,e.y)),f=e;d>2&&a.push(new b(e.x,e.y,g.x,g.y))}}return a},c.prototype.distance2=function(a,b){var c={cost:1/0,dist2:1/0};return this.edges().forEach(function(d){var e=d.distance2(a,b);e.cost<c.cost&&(c=e)},this),c},c.prototype.center=function(){for(var b=this.points(),c=0,d=0,e=0,f=b.length;f>e;e++){var g=b[e];c+=g.x,d+=g.y}return new a(c/f,d/f)},c.prototype.containsPoint=function(a){var c=this.bbox();if(!c.containsPoint(a))return!1;var d=.01*c.dx,e=new b(c.x-d,a.y,a.x,a.y),f=0,g=this.edges();return g.forEach(function(a){a.intersectsLine(e)&&f++}),1===(1&f)},c.prototype.bbox=function(){var a=this._bbox;if(!a){var b,c;this.points().forEach(function(a){null==b?b={x:a.x,y:a.y}:(a.x<b.x&&(b.x=a.x),a.y<b.y&&(b.y=a.y)),null==c?c={x:a.x,y:a.y}:(a.x>c.x&&(c.x=a.x),a.y>c.y&&(c.y=a.y))}),b&&(a=this._bbox=new pv.Shape.Rect(b.x,b.y,c.x-b.x,c.y-b.y))}return a}}(),!function(){var a=pv.Shape.Point,b=pv.Shape.Line;pv.Shape.Rect=function(a,b,c,d){this.x=a||0,this.y=b||0,this.dx=c||0,this.dy=d||0,this.dx<0&&(this.dx=-this.dx,this.x=this.x-this.dx),this.dy<0&&(this.dy=-this.dy,this.y=this.y-this.dy),this.x2=this.x+this.dx,this.y2=this.y+this.dy};var c=pv.Shape.Rect;c.prototype=pv.extend(pv.Shape.Polygon),c.prototype.clone=function(){var a=Object.create(c.prototype);return a.x=this.x,a.y=this.y,a.dx=this.dx,a.dy=this.dy,a.x2=this.x2,a.y2=this.y2,a},c.prototype.apply=function(a){var b=a.x+a.k*this.x,d=a.y+a.k*this.y,e=a.k*this.dx,f=a.k*this.dy;return new c(b,d,e,f)},c.prototype.containsPoint=function(a){return this.x<=a.x&&a.x<=this.x2&&this.y<=a.y&&a.y<=this.y2},c.prototype.intersectsRect=function(a){return this.x2>a.x&&this.x<a.x2&&this.y2>a.y&&this.y<a.y2},c.prototype.edges=function(){if(!this._edges){var a=this.x,c=this.y,d=this.x2,e=this.y2;this._edges=[new b(a,c,d,c),new b(d,c,d,e),new b(d,e,a,e),new b(a,e,a,c)]}return this._edges},c.prototype.center=function(){return new a(this.x+this.dx/2,this.y+this.dy/2)},c.prototype.points=function(){var b=this._points;if(!b){var c=this.x,d=this.y,e=this.x2,f=this.y2;b=this._points=[new a(c,d),new a(e,d),new a(e,f),new a(c,f)]}return b},c.prototype.bbox=function(){return this.clone()}}(),!function(){var a=pv.Shape.Point,b=pv.Shape.dist2,c=Math.sqrt,d=Math.abs,e=Math.pow;pv.Shape.Circle=function(a,b,c){this.x=a||0,this.y=b||0,this.radius=c||0};var f=pv.Shape.Circle;f.prototype=pv.extend(pv.Shape),f.prototype.clone=function(){return new f(this.x,this.y,this.radius)},f.prototype.apply=function(a){var b=a.x+a.k*this.x,c=a.y+a.k*this.y,d=a.k*this.radius;return new f(b,c,d)},f.prototype.intersectsRect=function(a){var b=a.dx/2,c=a.dy/2,f=this.radius,g=d(this.x-a.x-b),h=d(this.y-a.y-c);if(g>b+f||h>c+f)return!1;if(b>=g||c>=h)return!0;var i=e(g-b,2)+e(h-c,2);return f*f>=i},f.prototype.intersectLine=function(b,d){var e=b.x2-b.x,f=b.y2-b.y,g=this.x-b.x,h=this.y-b.y,i=e*e+f*f,j=e*g+f*h,k=this.radius,l=g*g+h*h-k*k,m=j/i,n=m*m-l/i;if(!(0>n)){var o=c(n),p=m-o,q=m+o,r=[];return(d||p>=0&&1>=p)&&r.push(new a(b.x+e*p,b.y+f*p)),0!==n&&(d||q>=0&&1>=q)&&r.push(new a(b.x+e*q,b.y+f*q)),r}},f.prototype.points=function(){return[this.center()]},f.prototype.center=function(){return new a(this.x,this.y)},f.prototype.normal=function(a){return a.minus(this.x,this.y).norm()},f.prototype.containsPoint=function(a){var b=a.x-this.x,c=a.y-this.y,d=this.radius;return d*d>=b*b+c*c},f.prototype.distance2=function(a,c){var d=(a.x-this.x,a.y-this.y,this.radius),e=a.minus(this).norm().times(d).plus(this),f=b(a,e,c);return f}}(),!function(){var a=pv.Shape.Point,b=pv.Shape.dist2,c=pv.Shape.normalizeAngle,d=pv.Shape.atan2Norm,e=Math.cos,f=Math.sin,g=Math.sqrt;pv.Shape.Arc=function(a,b,d,e,f){this.x=a,this.y=b,this.radius=d,this.startAngle=c(e),this.angleSpan=c(f),this.endAngle=this.startAngle+this.angleSpan};var h=pv.Shape.Arc;h.prototype=pv.extend(pv.Shape),h.prototype.hasArea=function(){return!1},h.prototype.clone=function(){var a=Object.create(h.prototype),b=this;return a.x=b.x,a.y=b.y,a.radius=b.radius,a.startAngle=b.startAngle,a.angleSpan=b.angleSpan,a.endAngle=b.endAngle,a},h.prototype.apply=function(a){var b=a.x+a.k*this.x,c=a.y+a.k*this.y,d=a.k*this.radius;return new h(b,c,d,this.startAngle,this.angleSpan)},h.prototype.containsPoint=function(a){var b=a.x-this.x,c=a.y-this.y,e=g(b*b+c*c);if(Math.abs(e-this.radius)<=1e-10){var f=d(c,b);return this.startAngle<=f&&f<=this.endAngle}return!1},h.prototype.intersectsRect=function(a){var b,c,d=this.points(),c=d.length;for(b=0;c>b;b++)if(d[b].intersectsRect(a))return!0;var e=a.edges();for(c=e.length,b=0;c>b;b++)if(this.intersectLine(e[b]))return!0;return!1};var i=pv.Shape.Circle.prototype.intersectLine;h.prototype.intersectLine=function(a,b){var c=i.call(this,a,b);if(c&&(c=c.filter(function(a){return this.containsPoint(a)},this),c.length))return c},h.prototype.points=function(){var b=this.x,c=this.y,d=this.radius,g=this.startAngle,h=this.endAngle;return[new a(b+d*e(g),c+d*f(g)),new a(b+d*e(h),c+d*f(h))]},h.prototype.center=function(){var b=this.x,c=this.y,d=this.radius,g=(this.startAngle+this.endAngle)/2;return new a(b+d*e(g),c+d*f(g))},h.prototype.normal=function(a,b){var c=a.minus(this.x,this.y).norm();if(b){var d=this.center().minus(b);d.dot(c)<0&&(c=c.times(-1))}return c},h.prototype.distance2=function(c,g){var h=c.x-this.x,i=c.y-this.y,j=d(i,h);if(this.startAngle<=j&&j<=this.endAngle){var k=new a(this.x+this.radius*e(j),this.y+this.radius*f(j));return b(c,k,g)}var l=this.points(),m=b(c,l[0],g),n=b(c,l[1],g);return m.cost<n.cost?m:n}}(),!function(){var a=pv.Shape.Arc,b=pv.Shape.Line,c=pv.Shape.Point,d=Math.cos,e=Math.sin,f=Math.sqrt,g=pv.Shape.atan2Norm,h=pv.Shape.normalizeAngle;pv.Shape.Wedge=function(a,b,c,d,e,f){this.x=a,this.y=b,this.innerRadius=c,this.outerRadius=d,this.startAngle=h(e),this.angleSpan=h(f),this.endAngle=this.startAngle+this.angleSpan};var i=pv.Shape.Wedge;i.prototype=pv.extend(pv.Shape),i.prototype.clone=function(){return new i(this.x,this.y,this.innerRadius,this.outerRadius,this.startAngle,this.angleSpan)},i.prototype.apply=function(a){var b=a.x+a.k*this.x,c=a.y+a.k*this.y,d=a.k*this.innerRadius,e=a.k*this.outerRadius;return new i(b,c,d,e,this.startAngle,this.angleSpan)},i.prototype.containsPoint=function(a){var b=a.x-this.x,c=a.y-this.y,d=f(b*b+c*c);if(d>=this.innerRadius&&d<=this.outerRadius){var e=g(c,b);return this.startAngle<=e&&e<=this.endAngle}return!1},i.prototype.intersectsRect=function(a){var b,c,d=this.points();for(c=d.length,b=0;c>b;b++)if(d[b].intersectsRect(a))return!0;for(d=a.points(),c=d.length,b=0;c>b;b++)if(this.containsPoint(d[b]))return!0;var e=this.edges();for(c=e.length,b=0;c>b;b++)if(e[b].intersectsRect(a))return!0;return!1},i.prototype.points=function(){return this._points||this.edges(),this._points},i.prototype.edges=function(){var f=this._edges;if(!f){var g,h,i=this.x,j=this.y,k=this.innerRadius,l=this.outerRadius,m=this.startAngle,n=this.endAngle,o=this.angleSpan,p=d(m),q=e(m),r=d(n),s=e(n);k>0?(g=new c(i+k*p,j+k*q),h=new c(i+k*r,j+k*s)):g=h=new c(i,j);var t=new c(i+l*p,j+l*q),u=new c(i+l*r,j+l*s);f=this._edges=[],k>0&&f.push(new a(i,j,k,m,o)),f.push(new b(g.x,g.y,t.x,t.y),new a(i,j,l,m,o),new b(h.x,h.y,u.x,u.y));var v=this._points=[g,t,u];k>0&&v.push(h)}return f},i.prototype.distance2=function(a,b){var c={cost:1/0,dist2:1/0};return this.edges().forEach(function(d){var e=d.distance2(a,b);e.cost<c.cost&&(c=e)}),c},i.prototype.center=function(){var a=(this.startAngle+this.endAngle)/2,b=(this.innerRadius+this.outerRadius)/2;return new c(this.x+b*d(a),this.y+b*e(a))}}(),!function(){var a=Math.round,b=function(b){var c=parseFloat(b);return"%"==b[b.length-1]?a(2.55*c):c},c=/([a-z]+)\((.*)\)/i,d=function(a){if("#"===a.charAt(0)){var d,e,f;return 4===a.length?(d=a.charAt(1),d+=d,e=a.charAt(2),e+=e,f=a.charAt(3),f+=f):7===a.length&&(d=a.substring(1,3),e=a.substring(3,5),f=a.substring(5,7)),pv.rgb(parseInt(d,16),parseInt(e,16),parseInt(f,16),1)}var g=c.exec(a);if(g){var h=g[2].split(","),i=1;switch(g[1]){case"hsla":case"rgba":if(i=parseFloat(h[3]),!i)return pv.Color.transparent}switch(g[1]){case"hsla":case"hsl":var j=parseFloat(h[0]),k=parseFloat(h[1])/100,l=parseFloat(h[2])/100;return new pv.Color.Hsl(j,k,l,i).rgb();case"rgba":case"rgb":var d=b(h[0]),e=b(h[1]),f=b(h[2]);return pv.rgb(d,e,f,i)}}return new pv.Color(a,1)},e={};pv.color=function(a){if(a.rgb)return a.rgb();var b=pv.Color.names[a];return b||(b=e[a]||(e[a]=d(a))),b}}(),pv.Color=function(a,b){this.color=a,this.opacity=b,this.key="solid "+a+" alpha("+b+")"},pv.Color.prototype.hsl=function(){return this.rgb().hsl()},pv.Color.prototype.brighter=function(a){return this.rgb().brighter(a)},pv.Color.prototype.darker=function(a){return this.rgb().darker(a)},pv.Color.prototype.alphaBlend=function(a){var b=this.rgb(),c=b.a;if(1===c)return this;a=a?pv.color(a):pv.Color.names.white,a=a.rgb();var d=1-c;return pv.rgb(d*b.r+c*a.r,d*b.g+c*a.g,d*b.b+c*a.b,1)},pv.Color.prototype.rgbDecimal=function(a){var b=this.alphaBlend(a);return b.r<<16|b.g<<8|b.b},pv.Color.prototype.isDark=function(){return this.rgbDecimal()<8388607.5},pv.rgb=function(a,b,c,d){return new pv.Color.Rgb(a,b,c,4==arguments.length?d:1)},pv.Color.Rgb=function(a,b,c,d){pv.Color.call(this,d?"rgb("+a+","+b+","+c+")":"none",d),this.r=a,this.g=b,this.b=c,this.a=d},pv.Color.Rgb.prototype=pv.extend(pv.Color),pv.Color.Rgb.prototype.red=function(a){return pv.rgb(a,this.g,this.b,this.a)},pv.Color.Rgb.prototype.green=function(a){return pv.rgb(this.r,a,this.b,this.a)},pv.Color.Rgb.prototype.blue=function(a){return pv.rgb(this.r,this.g,a,this.a)},pv.Color.Rgb.prototype.alpha=function(a){return pv.rgb(this.r,this.g,this.b,a)},pv.Color.Rgb.prototype.rgb=function(){return this},pv.Color.Rgb.prototype.brighter=function(a){a=Math.pow(.7,null!=a?a:1);var b=this.r,c=this.g,d=this.b,e=30;return b||c||d?(b&&e>b&&(b=e),c&&e>c&&(c=e),d&&e>d&&(d=e),pv.rgb(Math.min(255,Math.floor(b/a)),Math.min(255,Math.floor(c/a)),Math.min(255,Math.floor(d/a)),this.a)):pv.rgb(e,e,e,this.a)},pv.Color.Rgb.prototype.darker=function(a){return a=Math.pow(.7,null!=a?a:1),pv.rgb(Math.max(0,Math.floor(a*this.r)),Math.max(0,Math.floor(a*this.g)),Math.max(0,Math.floor(a*this.b)),this.a)},pv.Color.Rgb.prototype.hsl=function(){var a,b,c=this.r/255,d=this.g/255,e=this.b/255,f=Math.max(c,d,e),g=Math.min(c,d,e),h=(f+g)/2;if(f===g)a=b=0;else{var i=f-g;switch(b=h>.5?i/(2-f-g):i/(f+g),f){case c:a=(d-e)/i+(e>d?6:0);break;case d:a=(e-c)/i+2;break;case e:a=(c-d)/i+4}a/=6}return pv.hsl(360*a,b,h,this.a)},pv.Color.Rgb.prototype.complementary=function(){return this.hsl().complementary().rgb()},pv.hsl=function(a,b,c,d){return new pv.Color.Hsl(a,b,c,4==arguments.length?d:1)},pv.Color.Hsl=function(a,b,c,d){pv.Color.call(this,"hsl("+a+","+100*b+"%,"+100*c+"%)",d),this.h=a,this.s=b,this.l=c,this.a=d},pv.Color.Hsl.prototype=pv.extend(pv.Color),pv.Color.Hsl.prototype.hsl=function(){return this},pv.Color.Hsl.prototype.hue=function(a){return pv.hsl(a,this.s,this.l,this.a)},pv.Color.Hsl.prototype.saturation=function(a){return pv.hsl(this.h,a,this.l,this.a)},pv.Color.Hsl.prototype.lightness=function(a){return pv.hsl(this.h,this.s,a,this.a)},pv.Color.Hsl.prototype.alpha=function(a){return pv.hsl(this.h,this.s,this.l,a)},pv.Color.Hsl.prototype.complementary=function(){return pv.hsl((this.h+180)%360,1-this.s,1-this.l,this.a)},pv.Color.Hsl.prototype.rgb=function(){function a(a){return a>360?a-=360:0>a&&(a+=360),60>a?g+(f-g)*a/60:180>a?f:240>a?g+(f-g)*(240-a)/60:g}function b(b){return Math.round(255*a(b))}var c=this.h,d=this.s,e=this.l;c%=360,0>c&&(c+=360),d=Math.max(0,Math.min(d,1)),e=Math.max(0,Math.min(e,1));var f=.5>=e?e*(1+d):e+d-e*d,g=2*e-f;return pv.rgb(b(c+120),b(c),b(c-120),this.a)},pv.Color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:pv.Color.transparent=pv.rgb(0,0,0,0)},!function(){var a=pv.Color.names;a.none=a.transparent;for(var b in a)a[b]=pv.color(a[b])}(),pv.colors=function(){var a=pv.Scale.ordinal();return a.range.apply(a,arguments),a},pv.Colors={},pv.Colors.category10=function(){var a=pv.colors("#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf");return a.domain.apply(a,arguments),a},pv.Colors.category20=function(){var a=pv.colors("#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5");return a.domain.apply(a,arguments),a},pv.Colors.category19=function(){var a=pv.colors("#9c9ede","#7375b5","#4a5584","#cedb9c","#b5cf6b","#8ca252","#637939","#e7cb94","#e7ba52","#bd9e39","#8c6d31","#e7969c","#d6616b","#ad494a","#843c39","#de9ed6","#ce6dbd","#a55194","#7b4173");return a.domain.apply(a,arguments),a},!function(){function a(a){var b=c(a);if(!b.length)return null;var e,f,h,i=Math.PI,j=b[0];0===j.indexOf("to ")?(f=/^to\s+(?:((top|bottom)(?:\s+(left|right))?)|((left|right)(?:\\s+(top|bottom))?))$/.exec(j),f&&(f[1]?(e=f[2],f[3]&&(e+=" "+f[3])):(e=f[5],f[6]&&(e=f[6]+" "+e)),i=pv.radians(g[e]),b.shift())):(h=parseFloat(j),isNaN(h)||(i=h,/^.*?deg$/.test(j)&&(i=pv.radians(i)),b.shift()));var k=d(b);switch(k.length){case 0:return null;case 1:return new pv.FillStyle.Solid(k[0].color,1)}return new pv.FillStyle.LinearGradient(i,k,a)}function b(a){var b=c(a);if(!b.length)return null;var e=d(b);switch(e.length){case 0:return null;case 1:return new pv.FillStyle.Solid(e[0].color,1)}return new pv.FillStyle.RadialGradient(50,50,e,a)}function c(a){var b={},c=0;a=a.replace(/\b\w+?\(.*?\)/g,function(a){var d="__color"+c++;return b[d]=a,d});var d=a.split(/\s*,\s*/);return d.length?(c&&d.forEach(function(a,c){b.hasOwnProperty(a)&&(d[c]=b[a])}),d):null}function d(a){function b(a){var b=f.length;if(b){for(var c=e,d=(a-c)/(b+1),g=0;b>g;g++)c+=d,f[g].offset=c;f.length=0}}for(var c=[],d=1/0,e=-1/0,f=[],g=0,h=a.length;h>g;){var i=a[g++],j=/^(.+?)\s*([+\-]?[e\.\d]+%)?$/i.exec(i);if(j){var k={color:pv.color(j[1])},l=parseFloat(j[2]);isNaN(l)&&(c.length?g===h&&(l=Math.max(e,100)):l=0),c.push(k),isNaN(l)?f.push(k):(k.offset=l,b(l),l>e?e=l:e>l&&(l=e),d>l&&(d=l))}}if(c.length>=2&&(0>d||e>100)){var m=[],n=[];c.forEach(function(a){m.push(a.offset),n.push(a.color)});var o=pv.scale.linear().domain(m).range(n);if(0>d){for(;c.length&&c[0].offset<=0;)c.shift();c.unshift({offset:0,color:o(0)})}if(e>100){for(;c.length&&c[c.length-1].offset>=100;)c.pop();c.push({offset:100,color:o(100)})}}return c}pv.fillStyle=function(a){if(a.type)return a;var b=a.key||a,c=e[b];return c=c?c.clone():e[b]=f(a)};var e={},f=function(c){if(c.rgb)return new pv.FillStyle.Solid(c.color,c.opacity);var d=/^\s*([a-z\-]+)\(\s*(.*?)\s*\)\s*$/.exec(c);if(d)switch(d[1]){case"linear-gradient":return a(d[2]);case"radial-gradient":return b(d[2])}return new pv.FillStyle.Solid(pv.color(c))},g={top:0,"top right":45,right:90,"bottom right":135,bottom:180,"bottom left":225,left:270,"top left":315},h=pv.FillStyle=function(a){this.type=a,this.key=a};pv.extendType(h,new pv.Color("none",1)),h.prototype.rgb=function(){var a=pv.color(this.color);return this.opacity!==a.opacity&&(a=a.alpha(this.opacity)),a},h.prototype.alphaBlend=function(a){return this.rgb().alphaBlend(a)},h.prototype.rgbDecimal=function(a){return this.rgb().rgbDecimal(a)},h.prototype.isDark=function(){return this.rgb().isDark()};var i=pv.FillStyle.Solid=function(a,b){h.call(this,"solid"),a.rgb?(this.color=a.color,this.opacity=a.opacity):(this.color=a,this.opacity=b),this.key+=" "+this.color+" alpha("+this.opacity+")"};pv.extendType(i,h),i.prototype.alpha=function(a){return new i(this.color,a)},i.prototype.brighter=function(a){return new i(this.rgb().brighter(a))},i.prototype.darker=function(a){return new i(this.rgb().darker(a))},i.prototype.complementary=function(){return new i(this.rgb().complementary())},i.prototype.clone=function(){var a=pv.extend(i);return a.type=this.type,a.key=this.key,a.color=this.color,a.opacity=this.opacity,a},pv.FillStyle.transparent=new i(pv.Color.transparent);var j=0,k=pv.FillStyle.Gradient=function(a,b){h.call(this,a),this.id=++j,this.stops=b,b.length&&(this.color=b[0].color.color),this.key+=" stops("+b.map(function(a){var b=a.color;return b.color+" alpha("+b.opacity+") at("+a.offset+")"}).join(", ")+")"};pv.extendType(k,h),k.prototype.rgb=function(){return this.stops.length?this.stops[0].color:void 0},k.prototype.alpha=function(a){return this._cloneWithStops(this.stops.map(function(b){return{offset:b.offset,color:b.color.alpha(a)}}))},k.prototype.darker=function(a){return this._cloneWithStops(this.stops.map(function(b){return{offset:b.offset,color:b.color.darker(a)}}))},k.prototype.brighter=function(a){return this._cloneWithStops(this.stops.map(function(b){return{offset:b.offset,color:b.color.brighter(a)}}))},k.prototype.complementary=function(){return this._cloneWithStops(this.stops.map(function(a){return{offset:a.offset,color:a.color.complementary()}}))},k.prototype.alphaBlend=function(a){return this._cloneWithStops(this.stops.map(function(b){return{offset:b.offset,color:b.color.alphaBlend(a)}}))},k.prototype.clone=function(){var a=this.constructor,b=pv.extend(a);b.constructor=a,b.id=++j,b.type=this.type,b.key=this.key;var c=this.stops;return b.stops=c,c.length&&(b.color=c[0].color.color),this._initClone(b),b};var l=pv.FillStyle.LinearGradient=function(a,b){k.call(this,"lineargradient",b),this.angle=a,this.key+=" angle("+a+")"};pv.extendType(l,k),l.prototype._cloneWithStops=function(a){return new l(this.angle,a)},l.prototype._initClone=function(a){a.angle=this.angle};var m=pv.FillStyle.RadialGradient=function(a,b,c){k.call(this,"radialgradient",c),this.cx=a,this.cy=b,this.key+=" center("+a+","+b+")"};pv.extendType(m,k),m.prototype._cloneWithStops=function(a){return new m(this.cx,this.cy,a)},m.prototype._initClone=function(a){a.cx=this.cx,a.cy=this.cy}}(),pv.ramp=function(){var a=pv.Scale.linear();return a.range.apply(a,arguments),a},pv.Scene=pv.SvgScene={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml",scale:1,events:["DOMMouseScroll","mousewheel","mousedown","mouseup","mouseover","mouseout","mousemove","click","dblclick","contextmenu"],mousePositionEventSet:{mousedown:1,mouseup:1,mouseover:1,mouseout:1,mousemove:1,click:1,dblclick:1,contextmenu:1},implicit:{svg:{"shape-rendering":"auto","pointer-events":"painted",x:0,y:0,dy:0,"text-anchor":"start",transform:"translate(0,0)",fill:"none","fill-opacity":1,stroke:"none","stroke-opacity":1,"stroke-width":1.5,"stroke-linejoin":"miter","stroke-linecap":"butt","stroke-miterlimit":8,"stroke-dasharray":"none"},css:{font:"10px sans-serif"}}},pv.SvgScene.updateAll=function(a){if(a.length&&a[0].reverse&&"line"!==a.type&&"area"!==a.type){for(var b=Object.create(a),c=0,d=a.length-1;d>=0;c++,d--)b[c]=a[d];a=b}this.removeSiblings(this[a.type](a))},pv.SvgScene.create=function(a){return document.createElementNS(this.svg,a)},pv.SvgScene.expect=function(a,b,c,d,e,f){var g;if(a&&(g=a.tagName,"defs"===g?(a=a.nextSibling,a&&(g=a.tagName)):"a"===g&&(a=a.firstChild)),a){if(g!==b){var h=this.create(b);a.parentNode.replaceChild(h,a),a=h}}else a=this.create(b);return e&&this.setAttributes(a,e),f&&this.setStyle(a,f),a},pv.SvgScene.setAttributes=function(a,b){var c=this.implicit.svg,d=a.__attributes__;d===b&&(d=null);for(var e in b){var f=b[e];d&&f===d[e]||(null==f||f==c[e]?a.removeAttribute(e):a.setAttribute(e,f))}a.__attributes__=b},pv.SvgScene.setStyle=function(a,b){var c=this.implicit.css,d=a.__style__;d===b&&(d=null);for(var e in b){var f=b[e];d&&f===d[e]||(null==f||f==c[e]?a.style.removeProperty(e):a.style[e]=f)}a.__style__=b},pv.SvgScene.append=function(a,b,c){return a.$scene={scenes:b,index:c},a=this.title(a,b[c]),a.parentNode||b.$g.appendChild(a),a.nextSibling},pv.SvgScene.title=function(a,b){var c=a.parentNode;if(c&&"a"!=c.tagName&&(c=null),b.title){c||(c=this.create("a"),c.setAttributeNS(this.xlink,"xlink:href",""),a.parentNode&&a.parentNode.replaceChild(c,a),c.appendChild(a)),c.setAttributeNS(this.xlink,"xlink:title",b.title);for(var d=null,e=a.firstChild;null!=e;e=e.nextSibling)if("title"==e.nodeName){d=e;break}return d?d.removeChild(d.firstChild):(d=this.create("title"),a.appendChild(d)),d.appendChild(document.createTextNode(b.title)),c}return c&&c.parentNode.replaceChild(a,c),a},pv.SvgScene.dispatch=pv.listener(function(a){var b=a.target.$scene;if(b){var c=a.type;switch(c){case"DOMMouseScroll":c="mousewheel",a.wheel=-480*a.detail;break;case"mousewheel":a.wheel=(window.opera?12:1)*a.wheelDelta}pv.Mark.dispatch(c,b.scenes,b.index,a)&&(a.preventDefault(),a.stopPropagation())}}),pv.SvgScene.removeSiblings=function(a){for(;a;){var b=a.nextSibling;"defs"!==a.nodeName&&a.parentNode.removeChild(a),a=b}},pv.SvgScene.undefined=function(){},!function(){var a={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},b={shortdash:[3,1],shortdot:[1,1],shortdashdot:[3,1,1,1],shortdashdotdot:[3,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};pv.SvgScene.isStandardDashStyle=function(a){return b.hasOwnProperty(a)},pv.SvgScene.translateDashStyleAlias=function(b){return a.hasOwnProperty(b)?a[b]:b},pv.SvgScene.parseDasharray=function(a){var c=a.strokeDasharray;if(c&&"none"!==c){c=this.translateDashStyleAlias(c);var d=b[c];c=d?d:c.split(/[\s,]+/);var e=a.lineWidth,f=a.lineCap||"butt",g="butt"===f;c=c.map(function(a,b){return a=+a,g||(b%2?a++:a-=1),0>=a&&(a=.001),a*e/this.scale},this).join(" ")}else c=null;return c}}(),!function(){var a=/^url\(#/,b=1,c=Math.PI/2,d=c/2,e=Math.SQRT2/2,f=Math.abs,g=Math.sin,h=Math.cos,i=function(a){return f(a)<=1e-12?0:a};pv.SvgScene.addFillStyleDefinition=function(c,d){if(d.type&&"solid"!==d.type&&!a.test(d.color)){var e=c.mark.root,f=e.__fillStyleMap__||(e.__fillStyleMap__={}),g=d.key,h=f[g];if(!h){h=f[g]="__pvGradient"+b++;var i=j.call(this,c,d,h);e.scene.$defs.appendChild(i)}d.color="url(#"+h+")"}};var j=function(a,b,j){var k="lineargradient"===b.type,l=this.create(k?"linearGradient":"radialGradient");if(l.setAttribute("id",j),k){var m=b.angle-c,n=f(m%c)-d,o=f(e*h(n)),p=o*h(m),q=o*g(m);l.setAttribute("x1",i(.5-p)),l.setAttribute("y1",i(.5-q)),l.setAttribute("x2",i(.5+p)),l.setAttribute("y2",i(.5+q))}for(var r=b.stops,s=r.length,t=0;s>t;t++){var u=r[t],v=l.appendChild(this.create("stop")),w=u.color;v.setAttribute("offset",u.offset+"%"),v.setAttribute("stop-color",w.color),v.setAttribute("stop-opacity",w.opacity+"");
}return l}}(),pv.SvgScene.pathBasis=function(){function a(a,b,c,d,e){return{x:a[0]*b.left+a[1]*c.left+a[2]*d.left+a[3]*e.left,y:a[0]*b.top+a[1]*c.top+a[2]*d.top+a[3]*e.top}}var b=[[1/6,2/3,1/6,0],[0,2/3,1/3,0],[0,1/3,2/3,0],[0,1/6,2/3,1/6]],c=function(c,d,e,f){var g=a(b[1],c,d,e,f),h=a(b[2],c,d,e,f),i=a(b[3],c,d,e,f);return"C"+g.x+","+g.y+","+h.x+","+h.y+","+i.x+","+i.y};return c.segment=function(c,d,e,f){var g=a(b[0],c,d,e,f),h=a(b[1],c,d,e,f),i=a(b[2],c,d,e,f),j=a(b[3],c,d,e,f);return["M"+g.x+","+g.y,"C"+h.x+","+h.y+","+i.x+","+i.y+","+j.x+","+j.y]},c}(),pv.SvgScene.curveBasis=function(a,b,c){var d;if(null==b?(d=a.length,b=0,c=d-1):d=c-b+1,2>=d)return"";var e="",f=a[b],g=f,h=f,i=a[b+1];e+=this.pathBasis(f,g,h,i);for(var j=b+2;c>=j;j++)f=g,g=h,h=i,i=a[j],e+=this.pathBasis(f,g,h,i);return e+=this.pathBasis(g,h,i,i),e+=this.pathBasis(h,i,i,i)},pv.SvgScene.curveBasisSegments=function(a,b,c){var d;if(null==b?(d=a.length,b=0,c=d-1):d=c-b+1,2>=d)return"";var e=[],f=a[b],g=f,h=f,i=a[b+1],j=this.pathBasis.segment(f,g,h,i);f=g,g=h,h=i,i=a[b+2],j[1]+=this.pathBasis(f,g,h,i),e.push(j);for(var k=b+3;c>=k;k++)f=g,g=h,h=i,i=a[k],e.push(this.pathBasis.segment(f,g,h,i));var l=this.pathBasis.segment(g,h,i,i);return l[1]+=this.pathBasis(h,i,i,i),e.push(l),e},pv.SvgScene.curveHermite=function(a,b,c,d){var e;null==c?(e=a.length,c=0,d=e-1):e=d-c+1;var f=b.length;if(1>f||e!==f&&e!==f+2)return"";var g=e!==f,h="",i=a[c],j=a[c+1],k=b[0],l=k,m=c+1;if(g&&(h+="Q"+(j.left-2*k.x/3)+","+(j.top-2*k.y/3)+","+j.left+","+j.top,i=a[c+1],m=c+2),f>1){l=b[1],j=a[m],m++,h+="C"+(i.left+k.x)+","+(i.top+k.y)+","+(j.left-l.x)+","+(j.top-l.y)+","+j.left+","+j.top;for(var n=2;f>n;n++,m++)j=a[m],l=b[n],h+="S"+(j.left-l.x)+","+(j.top-l.y)+","+j.left+","+j.top}if(g){var o=a[m];h+="Q"+(j.left+2*l.x/3)+","+(j.top+2*l.y/3)+","+o.left+","+o.top}return h},pv.SvgScene.curveHermiteSegments=function(a,b,c,d){var e;null==c?(e=a.length,c=0,d=e-1):e=d-c+1;var f=b.length;if(1>f||e!==f&&e!==f+2)return[];var g=e!==f,h=[],i=a[c],j=i,k=b[0],l=k,m=c+1;g&&(j=a[c+1],h.push(["M"+i.left+","+i.top,"Q"+(j.left-2*l.x/3)+","+(j.top-2*l.y/3)+","+j.left+","+j.top]),m=c+2);for(var n=1;f>n;n++,m++)i=j,k=l,j=a[m],l=b[n],h.push(["M"+i.left+","+i.top,"C"+(i.left+k.x)+","+(i.top+k.y)+","+(j.left-l.x)+","+(j.top-l.y)+","+j.left+","+j.top]);if(g){var o=a[m];h.push(["M"+j.left+","+j.top,"Q"+(j.left+2*l.x/3)+","+(j.top+2*l.y/3)+","+o.left+","+o.top])}return h},pv.SvgScene.cardinalTangents=function(a,b,c,d){var e;null==c?(e=a.length,c=0,d=e-1):e=d-c+1;for(var f=[],g=(1-b)/2,h=a[c],i=a[c+1],j=a[c+2],k=c+3;d>=k;k++)f.push({x:g*(j.left-h.left),y:g*(j.top-h.top)}),h=i,i=j,j=a[k];return f.push({x:g*(j.left-h.left),y:g*(j.top-h.top)}),f},pv.SvgScene.curveCardinal=function(a,b,c,d){var e;return null==c?(e=a.length,c=0,d=e-1):e=d-c+1,2>=e?"":this.curveHermite(a,this.cardinalTangents(a,b,c,d),c,d)},pv.SvgScene.curveCardinalSegments=function(a,b,c,d){var e;return null==c?(e=a.length,c=0,d=e-1):e=d-c+1,2>=e?"":this.curveHermiteSegments(a,this.cardinalTangents(a,b,c,d),c,d)},pv.SvgScene.monotoneTangents=function(a,b,c){var d;null==b?(d=a.length,b=0,c=d-1):d=c-b+1;var e,f=[],g=[],h=[],i=[],j=0;for(j=0;d-1>j;j++){e=b+j;var k=a[e+1].left-a[e].left;g[j]=Math.abs(k)<=1e-12?0:(a[e+1].top-a[e].top)/k}for(h[0]=g[0],i[0]=a[b+1].left-a[b].left,j=1,e=b+j;d-1>j;j++,e++)h[j]=(g[j-1]+g[j])/2,i[j]=(a[e+1].left-a[e-1].left)/2;for(h[j]=g[j-1],i[j]=a[e].left-a[e-1].left,j=0;d-1>j;j++)0==g[j]&&(h[j]=0,h[j+1]=0);for(j=0;d-1>j;j++)if(!(Math.abs(h[j])<1e-5||Math.abs(h[j+1])<1e-5)){var l=h[j]/g[j],m=h[j+1]/g[j],n=l*l+m*m;if(n>9){var o=3/Math.sqrt(n);h[j]=o*l*g[j],h[j+1]=o*m*g[j]}}for(var p,q=0;d>q;q++)p=1+h[q]*h[q],f.push({x:i[q]/3/p,y:h[q]*i[q]/3/p});return f},pv.SvgScene.curveMonotone=function(a,b,c){var d;return null==b?(d=a.length,b=0,c=d-1):d=c-b+1,2>=d?"":this.curveHermite(a,this.monotoneTangents(a,b,c),b,c)},pv.SvgScene.curveMonotoneSegments=function(a,b,c){var d;return null==b?(d=a.length,b=0,c=d-1):d=c-b+1,2>=d?"":this.curveHermiteSegments(a,this.monotoneTangents(a,b,c),b,c)},pv.SvgScene.area=function(a){var b=a.$g.firstChild,c=a.length;if(!c)return b;var d=a[0];return"smart"===d.segmented?this.areaSegmentedSmart(b,a):d.segmented?this.areaSegmentedFull(b,a):this.areaFixed(b,a,0,c-1,!0)},pv.SvgScene.areaFixed=function(a,b,c,d,e){var f=d-c+1;if(1===f)return this.lineAreaDotAlone(a,b,c);var g=b[c];if(!g.visible)return a;var h=g.fillStyle,i=g.strokeStyle;if(!h.opacity&&!i.opacity)return a;this.addFillStyleDefinition(b,h),this.addFillStyleDefinition(b,i);var j=!1,k=!1,l=!1,m=!1,n=!1;switch(g.interpolate){case"basis":j=!0;break;case"cardinal":k=!0;break;case"monotone":l=!0;break;case"step-after":m=!0;break;case"step-before":n=!0}for(var o,p,q=j||k||l,r=[],s=c;d>=s;s++)if(o=b[s],o.width||o.height){for(var t=s+1;d>=t&&(p=b[t],p.width||p.height);t++);s>c&&!m&&s--,d>=t&&!n&&t++;var u=q&&t-s>2?this.areaPathCurve:this.areaPathStraight;r.push(u.call(this,b,s,t-1,g)),s=t-1}if(!r.length)return a;var v=i.opacity;return a=this.expect(a,"path",b,c,{"shape-rendering":g.antialias?null:"crispEdges","pointer-events":e?g.events:"none",cursor:g.cursor,d:"M"+r.join("ZM")+"Z",fill:h.color,"fill-opacity":h.opacity||null,stroke:i.color,"stroke-opacity":v||null,"stroke-width":v?g.lineWidth/this.scale:null,"stroke-linecap":g.lineCap,"stroke-linejoin":g.lineJoin,"stroke-miterlimit":g.strokeMiterLimit,"stroke-dasharray":v?this.parseDasharray(g):null}),g.svg&&this.setAttributes(a,g.svg),g.css&&this.setStyle(a,g.css),this.append(a,b,c)},pv.SvgScene.areaSegmentedSmart=function(a,b){return this.eachLineAreaSegment(a,b,function(a,b,c,d){var e=this.areaSegmentPaths(b,c,d),f=e.top,g=e.bottom,h=c,i={breakOnKeyChange:!0,from:c,to:d};return this.eachLineAreaSegment(a,b,i,function(a,b,c,d,e,i){var j=b[c],k=j.fillStyle,l=j.strokeStyle;if(this.addFillStyleDefinition(b,k),this.addFillStyleDefinition(b,l),c===d)return this.lineAreaDotAlone(a,b,c);var m=this.areaJoinPaths(f,g,c-h,d-h-1),n=l.opacity,o={"shape-rendering":j.antialias?null:"crispEdges","pointer-events":i,cursor:j.cursor,d:m,fill:k.color,"fill-opacity":k.opacity||null,stroke:l.color,"stroke-opacity":n||null,"stroke-width":n?j.lineWidth/this.scale:null,"stroke-linecap":j.lineCap,"stroke-linejoin":j.lineJoin,"stroke-miterlimit":j.strokeMiterLimit,"stroke-dasharray":n?this.parseDasharray(j):null};return a=this.expect(a,"path",b,c,o,j.css),this.append(a,b,c)})})},pv.SvgScene.areaSegmentPaths=function(a,b,c){return this.areaSegmentCurvePaths(a,b,c)||this.areaSegmentStraightPaths(a,b,c)},pv.SvgScene.areaSegmentCurvePaths=function(a,b,c){var d=c-b+1,e=a[b],f="basis"===e.interpolate,g=!f&&"cardinal"===e.interpolate;if(f||g||"monotone"==e.interpolate){for(var h=[],i=[],j=0;d>j;j++){var k=a[b+j],l=a[c-j];h.push(k),i.push({left:l.left+l.width,top:l.top+l.height})}var m,n;if(f?(m=this.curveBasisSegments(h),n=this.curveBasisSegments(i)):g?(m=this.curveCardinalSegments(h,e.tension),n=this.curveCardinalSegments(i,e.tension)):(m=this.curveMonotoneSegments(h),n=this.curveMonotoneSegments(i)),m||m.length)return{from:b,top:m,bottom:n}}},pv.SvgScene.areaSegmentStraightPaths=function(a,b,c){for(var d=[],e=[],f=c,g=b;f>b;b++,c--){var h=a[b],i=a[c],j=["M"+h.left+","+h.top],k=["M"+(i.left+i.width)+","+(i.top+i.height)],l=a[b+1],m=a[c-1];switch(h.interpolate){case"step-before":j.push("V"+l.top+"H"+l.left);break;case"step-after":j.push("H"+l.left+"V"+l.top);break;default:j.push("L"+l.left+","+l.top)}k.push("L"+(m.left+m.width)+","+(m.top+m.height)),d.push(j),e.push(k)}return{from:g,top:d,bottom:e}},pv.SvgScene.areaJoinPaths=function(a,b,c,d){for(var e="",f="",g=a.length,h=c,i=g-1-d;d>=h;h++,i++){var j,k,l=a[h],m=b[i];h===c?(j=l.join(""),k="L"+m[0].substr(1)+m[1]):(j=l[1],k=m[1]),e+=j,f+=k}return e+f+"Z"},pv.SvgScene.areaSegmentedFull=function(a,b){var c,d,e=b.length,f=this.areaSegmentCurvePaths(b,0,e-1);f&&(c=f.top,d=f.bottom);for(var g=(b[0],0);e-1>g;g++){var h=b[g],i=b[g+1];if(h.visible&&i.visible){var j=h.fillStyle,k=h.strokeStyle;if(j.opacity||k.opacity){var l;if(c){var m=c[g].join(""),n="L"+d[e-g-2].join("").substr(1);l=m+n+"Z"}else{var o=h,p=i;switch(h.interpolate){case"step-before":o=i;break;case"step-after":p=h}l="M"+h.left+","+o.top+"L"+i.left+","+p.top+"L"+(i.left+i.width)+","+(p.top+p.height)+"L"+(h.left+h.width)+","+(o.top+o.height)+"Z"}var q={"shape-rendering":h.antialias?null:"crispEdges","pointer-events":h.events,cursor:h.cursor,d:l,fill:j.color,"fill-opacity":j.opacity||null,stroke:k.color,"stroke-opacity":k.opacity||null,"stroke-width":k.opacity?h.lineWidth/this.scale:null};a=this.expect(a,"path",b,g,q),h.svg&&this.setAttributes(a,h.svg),h.css&&this.setStyle(a,h.css),a=this.append(a,b,g)}}}return a},pv.SvgScene.areaPathStraight=function(a,b,c,d){for(var e=[],f=[],g=c;g>=b;b++,c--){var h=a[b],i=a[c],j=h.left+","+h.top,k=i.left+i.width+","+(i.top+i.height);if(g>b){var l=a[b+1],m=a[c-1];switch(d.interpolate){case"step-before":j+="V"+l.top,k+="H"+(m.left+m.width);break;case"step-after":j+="H"+l.left,k+="V"+(m.top+m.height)}}e.push(j),f.push(k)}return e.concat(f).join("L")},pv.SvgScene.areaPathCurve=function(a,b,c,d){for(var e,f,g=[],h=[],i=c;i>=b;b++,c--){var j=a[c];g.push(a[b]),h.push({left:j.left+j.width,top:j.top+j.height})}switch(d.interpolate){case"basis":e=this.curveBasis(g),f=this.curveBasis(h);break;case"cardinal":e=this.curveCardinal(g,d.tension),f=this.curveCardinal(h,d.tension);break;default:e=this.curveMonotone(g),f=this.curveMonotone(h)}return g[0].left+","+g[0].top+e+"L"+h[0].left+","+h[0].top+f};pv.SvgScene.minBarWidth=1;pv.SvgScene.minBarHeight=1,pv.SvgScene.minBarLineWidth=.2,pv.SvgScene.bar=function(a){for(var b=a.$g.firstChild,c=0;c<a.length;c++){var d=a[c];if(!(!d.visible||Math.abs(d.width)<=1e-10||Math.abs(d.height)<=1e-10)){d.width<this.minBarWidth&&(d.width=this.minBarWidth),d.height<this.minBarHeight&&(d.height=this.minBarHeight);var e=d.fillStyle,f=d.strokeStyle;if(e.opacity||f.opacity){this.addFillStyleDefinition(a,e),this.addFillStyleDefinition(a,f);var g;f.opacity?(g=d.lineWidth,g=1e-10>g?0:Math.max(this.minBarLineWidth,g/this.scale)):g=null,b=this.expect(b,"rect",a,c,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x:d.left,y:d.top,width:Math.max(1e-10,d.width),height:Math.max(1e-10,d.height),fill:e.color,"fill-opacity":e.opacity||null,stroke:f.color,"stroke-opacity":f.opacity||null,"stroke-width":g,"stroke-linecap":d.lineCap,"stroke-dasharray":f.opacity?this.parseDasharray(d):null}),d.svg&&this.setAttributes(b,d.svg),d.css&&this.setStyle(b,d.css),b=this.append(b,a,c)}}}return b},pv.SvgScene.dot=function(a){for(var b=a.$g.firstChild,c=0,d=a.length;d>c;c++){var e=a[c];if(e.visible){var f=e.fillStyle,g=f.opacity,h=e.strokeStyle,i=h.opacity;if(g||i){this.addFillStyleDefinition(a,f),this.addFillStyleDefinition(a,h);var j={"shape-rendering":e.antialias?null:"crispEdges","pointer-events":e.events,cursor:e.cursor,fill:f.color,"fill-opacity":g||null,stroke:h.color,"stroke-opacity":i||null,"stroke-width":i?e.lineWidth/this.scale:null,"stroke-linecap":e.lineCap,"stroke-dasharray":i?this.parseDasharray(e):null},k=e.shape||"circle",l=e.aspectRatio,m=e.shapeAngle,n=null;if("circle"===k)1===l?(j.cx=e.left,j.cy=e.top,j.r=e.shapeRadius):(k="ellipse",j.cx=j.cy=0,n="translate("+e.left+","+e.top+") ",m&&(n+="rotate("+pv.degrees(m)+") "),j.rx=e._width/2,j.ry=e._height/2);else{var o=e.shapeRadius,p=o,q=o;if(l>0&&1!==l){var r=1/Math.sqrt(l),s=l*r;p*=s,q*=r}j.d=this.renderSymbol(k,e,p,q),k="path",n="translate("+e.left+","+e.top+") ",m&&(n+="rotate("+pv.degrees(m)+") ")}n&&(j.transform=n),b=this.expect(b,k,a,c,j),e.svg&&this.setAttributes(b,e.svg),e.css&&this.setStyle(b,e.css),b=this.append(b,a,c)}}}return b},!function(a){var b={};a.registerSymbol=function(c,d){return b[c]=d,a},a.renderSymbol=function(c,d,e,f){return b[c].call(a,d,c,e,f)},a.hasSymbol=function(a){return b.hasOwnProperty(a)},a.symbols=function(){return pv.keys(b)};var c=2/Math.sqrt(3);a.registerSymbol("circle",function(){throw new Error("Not implemented as a symbol")}).registerSymbol("cross",function(a,b,c,d){var e=(a.shapeRadius,-c),f=-d;return"M"+e+","+f+"L"+c+","+d+"M"+c+","+f+"L"+e+","+d}).registerSymbol("triangle",function(a,b,d,e){var f=e,g=d*c,h=-e,i=-g;return"M0,"+f+"L"+g+","+h+" "+i+","+h+"Z"}).registerSymbol("diamond",function(a,b,c,d){var e=c*Math.SQRT2,f=d*Math.SQRT2,g=-e,h=-f;return"M0,"+h+"L"+e+",0 0,"+f+" "+g+",0Z"}).registerSymbol("square",function(a,b,c,d){var e=-c,f=-d;return"M"+e+","+f+"L"+c+","+f+" "+c+","+d+" "+e+","+d+"Z"}).registerSymbol("tick",function(a,b,c,d){var e=-d*d;return"M0,0L0,"+e}).registerSymbol("bar",function(a,b,c,d){var e=d*d/2;return"M0,"+e+"L0,"+-e})}(pv.SvgScene),pv.SvgScene.image=function(a){for(var b=a.$g.firstChild,c=0;c<a.length;c++){var d=a[c];if(d.visible){if(b=this.fill(b,a,c),d.image){b=this.expect(b,"foreignObject",a,c,{cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height}),d.svg&&this.setAttributes(b,d.svg),d.css&&this.setStyle(b,d.css);var e=b.firstChild||b.appendChild(document.createElementNS(this.xhtml,"canvas"));e.$scene={scenes:a,index:c},e.style.width=d.width,e.style.height=d.height,e.width=d.imageWidth,e.height=d.imageHeight,e.getContext("2d").putImageData(d.image,0,0)}else b=this.expect(b,"image",a,c,{preserveAspectRatio:"none",cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height}),d.svg&&this.setAttributes(b,d.svg),d.css&&this.setStyle(b,d.css),b.setAttributeNS(this.xlink,"xlink:href",d.url);b=this.append(b,a,c),b=this.stroke(b,a,c)}}return b},pv.SvgScene.label=function(a){for(var b=a.$g.firstChild,c=0;c<a.length;c++){var d=a[c];if(d.visible){var e=d.textStyle;if(e.opacity&&d.text){var f=0,g=0,h=0,i="start";switch(d.textBaseline){case"middle":h=".35em";break;case"top":h=".71em",g=d.textMargin;break;case"bottom":g="-"+d.textMargin}switch(d.textAlign){case"right":i="end",f="-"+d.textMargin;break;case"center":i="middle";break;case"left":f=d.textMargin}b=this.expect(b,"text",a,c,{"pointer-events":d.events,cursor:d.cursor,x:f,y:g,dy:h,transform:"translate("+d.left+","+d.top+")"+(d.textAngle?" rotate("+180*d.textAngle/Math.PI+")":"")+(1!=this.scale?" scale("+1/this.scale+")":""),fill:e.color,"fill-opacity":e.opacity||null,"text-anchor":i},{font:d.font,"text-shadow":d.textShadow,"text-decoration":d.textDecoration}),d.svg&&this.setAttributes(b,d.svg),d.css&&this.setStyle(b,d.css),b.firstChild?b.firstChild.nodeValue=d.text:b.appendChild(document.createTextNode(d.text)),b=this.append(b,a,c)}}}return b},pv.SvgScene.line=function(a){var b=a.$g.firstChild,c=a.length;if(!c)return b;var d=a[0];return"smart"===d.segmented?this.lineSegmentedSmart(b,a):2>c?b:d.segmented?this.lineSegmentedFull(b,a):this.lineFixed(b,a)},pv.SvgScene.lineFixed=function(a,b){var c=b.length;if(1===c)return this.lineAreaDotAlone(a,b,0);var d=b[0];if(!d.visible)return a;var e=d.fillStyle,f=d.strokeStyle;if(!e.opacity&&!f.opacity)return a;this.addFillStyleDefinition(b,e),this.addFillStyleDefinition(b,f);var g="M"+d.left+","+d.top,h=c>2;if(h)switch(d.interpolate){case"basis":g+=this.curveBasis(b);break;case"cardinal":g+=this.curveCardinal(b,d.tension);break;case"monotone":g+=this.curveMonotone(b);break;default:h=!1}if(!h)for(var i=1;c>i;i++)g+=this.lineSegmentPath(b[i-1],b[i]);var j=f.opacity,k={"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,d:g,fill:e.color,"fill-opacity":e.opacity||null,stroke:f.color,"stroke-opacity":j||null,"stroke-width":j?d.lineWidth/this.scale:null,"stroke-linecap":d.lineCap,"stroke-linejoin":d.lineJoin,"stroke-miterlimit":d.strokeMiterLimit,"stroke-dasharray":j?this.parseDasharray(d):null};return a=this.expect(a,"path",b,0,k,d.css),d.svg&&this.setAttributes(a,d.svg),this.append(a,b,0)},pv.SvgScene.lineSegmentedSmart=function(a,b){return this.eachLineAreaSegment(a,b,function(a,b,c,d){var e=this.lineSegmentPaths(b,c,d),f=c,g={breakOnKeyChange:!0,from:c,to:d};return this.eachLineAreaSegment(a,b,g,function(a,b,c,d,g,h){var i=b[c],j=i.fillStyle;this.addFillStyleDefinition(b,j);var k=i.strokeStyle;if(this.addFillStyleDefinition(b,k),c===d)return this.lineAreaDotAlone(a,b,c);var l=this.lineJoinPaths(e,c-f,d-f-1),m=k.opacity,n={"shape-rendering":i.antialias?null:"crispEdges","pointer-events":h,cursor:i.cursor,d:l,fill:j.color,"fill-opacity":j.opacity||null,stroke:k.color,"stroke-opacity":m||null,"stroke-width":m?i.lineWidth/this.scale:null,"stroke-linecap":i.lineCap,"stroke-linejoin":i.lineJoin,"stroke-miterlimit":i.strokeMiterLimit,"stroke-dasharray":m?this.parseDasharray(i):null};return a=this.expect(a,"path",b,c,n,i.css),this.append(a,b,c)})})},pv.SvgScene.lineSegmentedFull=function(a,b){var c,d=b[0];switch(d.interpolate){case"basis":c=this.curveBasisSegments(b);break;case"cardinal":c=this.curveCardinalSegments(b,d.tension);break;case"monotone":c=this.curveMonotoneSegments(b)}for(var e=0,f=b.length-1;f>e;e++){var g=b[e],h=b[e+1];if(g.visible&&h.visible){var i=g.strokeStyle,j=pv.FillStyle.transparent;if(i.opacity){var k;"linear"==g.interpolate&&"miter"==g.lineJoin?(j=i,i=pv.FillStyle.transparent,k=this.pathJoin(b[e-1],g,h,b[e+2])):k=c?c[e].join(""):"M"+g.left+","+g.top+this.lineSegmentPath(g,h),a=this.expect(a,"path",b,e,{"shape-rendering":g.antialias?null:"crispEdges","pointer-events":g.events,cursor:g.cursor,d:k,fill:j.color,"fill-opacity":j.opacity||null,stroke:i.color,"stroke-opacity":i.opacity||null,"stroke-width":i.opacity?g.lineWidth/this.scale:null,"stroke-linejoin":g.lineJoin}),g.svg&&this.setAttributes(a,g.svg),g.css&&this.setStyle(a,g.css),a=this.append(a,b,e)}}}return a},pv.SvgScene.lineSegmentPath=function(a,b){var c=1;switch(a.interpolate){case"polar-reverse":c=0;case"polar":var d=b.left-a.left,e=b.top-a.top,f=1-a.eccentricity,g=Math.sqrt(d*d+e*e)/(2*f);if(0>=f||f>1)break;return"A"+g+","+g+" 0 0,"+c+" "+b.left+","+b.top;case"step-before":return"V"+b.top+"H"+b.left;case"step-after":return"H"+b.left+"V"+b.top}return"L"+b.left+","+b.top},pv.SvgScene.lineSegmentPaths=function(a,b,c){var d,e=a[b];switch(e.interpolate){case"basis":d=this.curveBasisSegments(a,b,c);break;case"cardinal":d=this.curveCardinalSegments(a,e.tension,b,c);break;case"monotone":d=this.curveMonotoneSegments(a,b,c)}if(!d||!d.length){d=[];for(var f=b+1;c>=f;f++){var g=a[f-1],h=a[f];d.push(["M"+g.left+","+g.top,this.lineSegmentPath(g,h)])}}return d},pv.strokeMiterLimit=4,pv.SvgScene.pathJoin=function(a,b,c,d){var e,f,g,h=[],i=b.lineWidth/this.scale,j=pv.vector(b.left,b.top),k=pv.vector(c.left,c.top),l=k.minus(j),m=l.perp().norm(),n=m.times(i/2),o=j.plus(n),p=j.minus(n),q=k.plus(n),r=k.minus(n);if(a&&a.visible){var s=pv.vector(a.left,a.top),t=j.minus(s),u=t.perp().norm(),v=u.plus(m).norm(),w=this.lineIntersect(j,v,o,l),x=this.lineIntersect(j,v,p,l);g=w.minus(x).length();var y=a.lineWidth/this.scale,z=(i+y)/2;if(f=g/z,e=b.strokeMiterLimit||pv.strokeMiterLimit,e>=f)h.push(x,w);else{var A=l.times(-1),B=t.norm().plus(A.norm()).norm(),C=j.plus(B.times(z/2));B.dot(m)>=0?h.push(x,C,o):h.push(p,C,w)}}else h.push(p,o);if(d&&d.visible){var D=pv.vector(d.left,d.top),E=D.minus(k),F=E.perp().norm(),G=F.plus(m).norm(),H=this.lineIntersect(k,G,q,l),I=this.lineIntersect(k,G,r,l);g=H.minus(I).length();var J=d.lineWidth/this.scale,K=(J+i)/2;if(f=g/K,e=c.strokeMiterLimit||pv.strokeMiterLimit,e>=f)h.push(H,I);else{var L=E.times(-1),M=l.norm().plus(L.norm()).norm(),N=k.plus(M.times(K/2));M.dot(m)>=0?h.push(q,N,I):h.push(H,N,r)}}else h.push(q,r);var O=h.shift();return"M"+O.x+","+O.y+"L"+h.map(function(a){return a.x+","+a.y}).join(" ")},pv.SvgScene.lineIntersect=function(a,b,c,d){return a.plus(b.times(c.minus(a).dot(d.perp())/b.dot(d.perp())))},pv.SvgScene.lineJoinPaths=function(a,b,c){for(var d=a[b].join(""),e=b+1;c>=e;e++)d+=a[e][1];return d},pv.SvgScene.lineAreaDotAlone=function(a){return a},pv.Scene.eventsToNumber={"":0,none:0,painted:1,all:2},pv.Scene.numberToEvents=["none","painted","all"],pv.SvgScene.eachLineAreaSegment=function(a,b,c,d){"function"==typeof c&&(d=c,c=null);var e,f,g,h=pv.get(c,"breakOnKeyChange",!1),i=pv.get(c,"from")||0,j=pv.get(c,"to",b.length-1);h&&(f=[],g=[]);for(var k=i;j>=k;){var l=b[k];if(this.isSceneVisible(l)){e=this.eventsToNumber[l.events]||0,h&&this.lineAreaSceneKey(l,f);for(var m,n=k;;){var o=n+1;if(o>j){m=o;break}var p=b[o];if(!this.isSceneVisible(p)){m=o+1;break}if(e=Math.max(e,this.eventsToNumber[p.events]||0),n=o,h&&(this.lineAreaSceneKey(p,g),!this.equalSceneKeys(f,g))){m=n;break}}a=d.call(this,a,b,k,n,c,this.numberToEvents[e]),k=m}else k++}return a},pv.SvgScene.lineAreaSceneKey=function(a,b){return b[0]=a.fillStyle.key,b[1]=a.strokeStyle.key,b[2]=a.lineWidth,b[3]=a.strokeDasharray||"none",b[4]=a.interpolate,b},pv.SvgScene.isSceneVisible=function(a){return a.visible&&(a.fillStyle.opacity>0||a.strokeStyle.opacity>0)},pv.SvgScene.equalSceneKeys=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]!==b[c])return!1;return!0},pv.SvgScene.panel=function(a){for(var b=a.$g,c=b&&b.firstChild,d=0,e=a.length;e>d;d++){var f=a[d];if(f.visible){if(!a.parent){var g=f.canvas;this.applyCanvasStyle(g),b&&b.parentNode!==g&&(b=g.firstChild,c=b&&b.firstChild),b?c&&"defs"===c.tagName&&(c=c.nextSibling):(b=this.createRootPanelElement(),c=null,this.initRootPanelElement(b,a.mark),g.appendChild(b),a.$defs=b.appendChild(this.create("defs")),a.$g=b),b.setAttribute("width",f.width+f.left+f.right),b.setAttribute("height",f.height+f.top+f.bottom)}var h=null;if("hidden"===f.overflow){var i=this.addPanelClipPath(b,c,a,d,f);h=i.g,a.$g=b=h,c=i.next}c=this.fill(c,a,d);var j=this.scale,k=f.transform,l=f.left+k.x,m=f.top+k.y;if(this.scale*=k.k,f.children.length)for(var n={transform:"translate("+l+","+m+")"+(1!=k.k?" scale("+k.k+")":"")},o=this.getSortedChildScenes(a,d),p=0,q=o.length;q>p;p++){var r=o[p];r.$g=c=this.expect(c,"g",a,d,n),this.updateAll(r),c.parentNode||b.appendChild(c),c=c.nextSibling}this.scale=j,c=this.stroke(c,a,d),h&&(a.$g=b=h.parentNode,c=h.nextSibling)}}return c},pv.SvgScene.applyCanvasStyle=function(a){a.style.display="inline-block"},pv.SvgScene.createRootPanelElement=function(){return this.create("svg")},pv.SvgScene.initRootPanelElement=function(a,b){a.setAttribute("font-size","10px"),a.setAttribute("font-family","sans-serif"),a.setAttribute("fill","none"),a.setAttribute("stroke","none"),a.setAttribute("stroke-width",1.5),this.disableElementSelection(a),this.listenRootPanelElement(a,b)},pv.SvgScene.listenRootPanelElement=function(a,b){for(var c=0,d=this.events,e=d.length;e>c;c++)a.addEventListener(d[c],this.dispatch,!1),b._registerBoundEvent(a,d[c],this.dispatch,!1)},pv.SvgScene.disableElementSelection=function(a){a.setAttribute("style","-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;"),"undefined"!=typeof a.onselectstart&&(a.setAttribute("unselectable","on"),a.onselectstart=function(){return!1})},pv.SvgScene.addPanelClipPath=function(a,b,c,d,e){var f=pv.id().toString(36),g=this.expect(b,"g",c,d,{"clip-path":"url(#"+f+")"}),h=this.expect(g.firstChild,"clipPath",c,d,{id:f}),i=h.firstChild||h.appendChild(this.create("rect"));return i.setAttribute("x",e.left),i.setAttribute("y",e.top),i.setAttribute("width",e.width),i.setAttribute("height",e.height),h.parentNode||g.appendChild(h),g.parentNode||a.appendChild(g),{g:g,next:h.nextSibling}},pv.SvgScene.getSortedChildScenes=function(a,b){var c=a[b].children;return a.mark._zOrderChildCount&&(c=c.slice(0),c.sort(function(a,b){var c=a.mark._zOrder-b.mark._zOrder;return 0===c&&(c=a.childIndex-b.childIndex),c})),c},pv.SvgScene.fill=function(a,b,c){var d=b[c],e=d.fillStyle;return(e.opacity||"all"==d.events)&&(this.addFillStyleDefinition(b,e),a=this.expect(a,"rect",b,c,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height,fill:e.color,"fill-opacity":e.opacity,stroke:null}),a=this.append(a,b,c)),a},pv.SvgScene.stroke=function(a,b,c){var d=b[c],e=d.strokeStyle;return(e.opacity||"all"==d.events)&&(a=this.expect(a,"rect",b,c,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":"all"==d.events?"stroke":d.events,cursor:d.cursor,x:d.left,y:d.top,width:Math.max(1e-10,d.width),height:Math.max(1e-10,d.height),fill:null,stroke:e.color,"stroke-opacity":e.opacity,"stroke-width":d.lineWidth/this.scale,"stroke-linecap":d.lineCap,"stroke-dasharray":e.opacity?this.parseDasharray(d):null}),a=this.append(a,b,c)),a},pv.SvgScene.minRuleLineWidth=1,pv.SvgScene.rule=function(a){for(var b=a.$g.firstChild,c=0;c<a.length;c++){var d=a[c];if(d.visible){var e=d.strokeStyle;if(e.opacity){var f=d.lineWidth;f=1e-10>f?0:Math.max(this.minRuleLineWidth,f/this.scale),b=this.expect(b,"line",a,c,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x1:d.left,y1:d.top,x2:d.left+d.width,y2:d.top+d.height,stroke:e.color,"stroke-opacity":e.opacity,"stroke-width":f,"stroke-linecap":d.lineCap,"stroke-dasharray":e.opacity?this.parseDasharray(d):null}),d.svg&&this.setAttributes(b,d.svg),d.css&&this.setStyle(b,d.css),b=this.append(b,a,c)}}}return b},pv.SvgScene.wedge=function(a){for(var b=a.$g.firstChild,c=0;c<a.length;c++){var d=a[c];if(d.visible){var e=d.fillStyle,f=d.strokeStyle;if(e.opacity||f.opacity){var g,h=d.innerRadius,i=d.outerRadius,j=Math.abs(d.angle);if(j>=2*Math.PI)g=h?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+h+"A"+h+","+h+" 0 1,1 0,"+-h+"A"+h+","+h+" 0 1,1 0,"+h+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z";else{var k=Math.min(d.startAngle,d.endAngle),l=Math.max(d.startAngle,d.endAngle),m=Math.cos(k),n=Math.cos(l),o=Math.sin(k),p=Math.sin(l);g=h?"M"+i*m+","+i*o+"A"+i+","+i+" 0 "+(j<Math.PI?"0":"1")+",1 "+i*n+","+i*p+"L"+h*n+","+h*p+"A"+h+","+h+" 0 "+(j<Math.PI?"0":"1")+",0 "+h*m+","+h*o+"Z":"M"+i*m+","+i*o+"A"+i+","+i+" 0 "+(j<Math.PI?"0":"1")+",1 "+i*n+","+i*p+"L0,0Z"}this.addFillStyleDefinition(a,e),this.addFillStyleDefinition(a,f),b=this.expect(b,"path",a,c,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,transform:"translate("+d.left+","+d.top+")",d:g,fill:e.color,"fill-rule":"evenodd","fill-opacity":e.opacity||null,stroke:f.color,"stroke-opacity":f.opacity||null,"stroke-width":f.opacity?d.lineWidth/this.scale:null,"stroke-linejoin":d.lineJoin,"stroke-miterlimit":d.strokeMiterLimit,"stroke-linecap":d.lineCap,"stroke-dasharray":f.opacity?this.parseDasharray(d):null}),d.svg&&this.setAttributes(b,d.svg),d.css&&this.setStyle(b,d.css),b=this.append(b,a,c)}}}return b},pv.Mark=function(){this.$properties=[],this.$propertiesMap={},this.$handlers={}},pv.Mark.prototype.properties={},pv.Mark.cast={},pv.Mark.prototype.property=function(a,b){return this.hasOwnProperty("properties")||(this.properties=pv.extend(this.properties)),this.properties[a]=!0,pv.Mark.prototype.propertyMethod(a,!1,pv.Mark.cast[a]=b),this},pv.Mark.prototype.localProperty=function(a,b){this.hasOwnProperty("properties")||(this.properties=pv.extend(this.properties)),this.properties[a]=!0;var c=pv.Mark.cast[a];return b&&(pv.Mark.cast[a]=c=b),this.propertyMethod(a,!1,c),this},pv.Mark.prototype.def=function(a,b){return this.propertyMethod(a,!0),this[a](arguments.length>1?b:null)},pv.Mark.prototype.propertyMethod=function(a,b,c){c||(c=pv.Mark.cast[a]),this[a]=function(d,e){if(b&&this.scene){var f=this.scene.defs;if(arguments.length)return f[a]={id:null==d?0:pv.id(),value:null!=d&&c?c(d):d},this;var g=f[a];return g?g.value:null}if(arguments.length)return this.setPropertyValue(a,d,b,c,!1,e),this;var h=this.instance();return pv.propBuildMark===this&&1!==pv.propBuilt[a]?(pv.propBuilt[a]=1,h[a]=this.evalProperty(this.binds.properties[a])):h[a]}},pv.Mark.funPropertyCaller=function(a,b){function c(){var c=a.apply(this,d);return null!=c?b(c):c}var d=pv.Mark.stack;return c},pv.Mark.prototype.setPropertyValue=function(a,b,c,d,e,f){var g=!c<<1|"function"==typeof b;1&g&&d?b=pv.Mark.funPropertyCaller(b,d):null!=b&&d&&(b=d(b));var h=this.$propertiesMap,i=this.$properties,j={name:a,id:pv.id(),value:b,type:g,tag:f},k=h[a];if(h[a]=j,k)for(var l=0,m=i.length;m>l;l++)if(i[l]===k){i.splice(l,1);break}return i.push(j),e&&k&&3===g&&(j.proto=k,j.root=k.root||k),j},pv.Mark.prototype.intercept=function(a,b,c){return this.setPropertyValue(a,b,!1,pv.get(c,"noCast")?null:pv.Mark.cast[a],!0,pv.get(c,"tag")),this},pv.Mark.prototype.propertyValue=function(a,b){var c=this.$propertiesMap[a];if(c)return c.value;if(b){if(this.proto){var d=this.proto._propertyValueRecursive(a);if(void 0!==d)return d}return this.defaults._propertyValueRecursive(a)}},pv.Mark.prototype._propertyValueRecursive=function(a){var b=this.$propertiesMap[a];return b?b.value:this.proto?this.proto._propertyValueRecursive(a):void 0},pv.Mark.stack=[],pv.Mark.prototype.property("data").property("visible",Boolean).property("css",Object).property("svg",Object).property("left",Number).property("right",Number).property("top",Number).property("bottom",Number).property("cursor",String).property("title",String).property("reverse",Boolean).property("antialias",Boolean).property("events",String).property("id",String),pv.Mark.prototype.childIndex=-1,pv.Mark.prototype.index=-1,pv.Mark.prototype.scale=1,pv.Mark.prototype._zOrder=0,pv.Mark.prototype.defaults=(new pv.Mark).data(function(a){return[a]}).visible(!0).antialias(!0).events("painted"),pv.Mark.prototype.extend=function(a){return this.proto=a,this.target=a.target,this},pv.Mark.prototype.add=function(a){return this.parent.add(a).extend(this)},pv.Mark.prototype.zOrder=function(a){if(!arguments.length)return this._zOrder;if(a=+a||0,this._zOrder!==a){var b=this.parent;b&&0!==this._zOrder&&b._zOrderChildCount--,this._zOrder=a,b&&0!==this._zOrder&&b._zOrderChildCount++}return this},pv.Mark.prototype.anchor=function(a){return new pv.Anchor(this).name(a||"center").data(function(){return this.scene.target.map(function(a){return a.data})}).visible(function(){return this.scene.target[this.index].visible}).id(function(){return this.scene.target[this.index].id}).left(function(){var a=this.scene.target[this.index],b=a.width||0;switch(this.name()){case"bottom":case"top":case"center":return a.left+b/2;case"left":return null}return a.left+b}).top(function(){var a=this.scene.target[this.index],b=a.height||0;switch(this.name()){case"left":case"right":case"center":return a.top+b/2;case"top":return null}return a.top+b}).right(function(){var a=this.scene.target[this.index];return"left"==this.name()?a.right+(a.width||0):null}).bottom(function(){var a=this.scene.target[this.index];return"top"==this.name()?a.bottom+(a.height||0):null}).textAlign(function(){switch(this.name()){case"bottom":case"top":case"center":return"center";case"right":return"right"}return"left"}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"top":return"top"}return"bottom"})},pv.Mark.prototype.anchorTarget=function(){return this.target},pv.Mark.prototype.margin=function(a){return this.left(a).right(a).top(a).bottom(a)},pv.Mark.prototype.instance=function(a){var b=this.scene||this.parent.instance(-1).children[this.childIndex],c=null==a||this.hasOwnProperty("index")?this.index:a;return b[0>c?b.length-1:c]},pv.Mark.prototype.instances=function(a){for(var b,c=this,d=[];!(b=c.scene);)d.push({index:a.parentIndex,childIndex:c.childIndex}),a=a.parent,c=c.parent;for(var e=d.length;e--;){var f=d[e];b=b[f.index].children[f.childIndex]}if(this.hasOwnProperty("index")){var g=pv.extend(b[this.index]);return g.right=g.top=g.left=g.bottom=0,[g]}return b},pv.Mark.prototype.first=function(){return this.scene[0]},pv.Mark.prototype.last=function(){return this.scene[this.scene.length-1]},pv.Mark.prototype.sibling=function(){return 0==this.index?null:this.scene[this.index-1]},pv.Mark.prototype.cousin=function(){var a=this.parent,b=a&&a.sibling();return b&&b.children?b.children[this.childIndex][this.index]:null},pv.Mark.prototype._renderId=0,pv.Mark.prototype.renderId=function(){return this.root._renderId},pv.Mark.prototype.render=function(){var a=this.root;!this.parent||a.scene?(a._renderId++,
this.renderCore()):a.render()},pv.Mark.prototype.renderCore=function(){function a(a,c,e){if(a.scale=e,h>c){var f=c>=d.length;if(f&&d.unshift(null),a.hasOwnProperty("index"))b(a,c,e,f);else{for(var g=0,i=a.scene.length;i>g;g++)a.index=g,b(a,c,e,f);delete a.index}f&&d.shift()}else a.build(),pv.Scene.scale=e,pv.Scene.updateAll(a.scene);delete a.scale}function b(b,c,e,g){var h,i=b.scene[b.index];if(i.visible){var j=b.children,k=i.children,l=f[c],m=j[l];for(m.scene||l++,h=0;l>h;h++)j[h].scene=k[h];for(g&&(d[0]=i.data),a(m,c+1,e*i.transform.k),h=0;l>h;h++)j[h].scene=void 0}}for(var c=this.parent,d=pv.Mark.stack,e=d.length,f=[],g=this;g.parent;g=g.parent)f.unshift(g.childIndex);var h=f.length;for(this.bind();c&&!c.hasOwnProperty("index");)c=c.parent;try{this.context(c?c.scene:void 0,c?c.index:-1,function(){a(this.root,0,1)})}catch(a){throw d.length>e&&(d.length=e),a}},pv.Mark.prototype.bind=function(){function a(a){do for(var f=a.$properties,g=f.length;g--;){var h=f[g],i=h.name,j=c[i];if(j){if(3===j.type){var k=j.root;j.root=h,k?k.proto||(k.proto=h):j.proto=h}}else switch(c[i]=h,i){case"data":b=h;break;case"visible":case"id":d.push(h);break;default:e[h.type].push(h)}}while(a=a.proto)}var b,c={},d=[],e=[[],[],[],[]];a(this),a(this.defaults);var f=e[0],g=e[1].reverse(),h=e[2];e[3].reverse();var i=this;do for(var j in i.properties)j in c||h.push(c[j]={name:j,type:2,value:null});while(i=i.proto);var k;if(f.length||g.length){k=f.concat(g);for(var l=0,m=k.length;m>l;l++)this.propertyMethod(k[l].name,!0)}else k=[];this.binds={properties:c,data:b,defs:k,required:d,optional:pv.blend(e)}},pv.Mark.prototype.build=function(){var a=pv.Mark.stack,b=this.scene;if(!b){b=this.scene=[],b.mark=this,b.type=this.type,b.childIndex=this.childIndex;var c=this.parent;c&&(b.parent=c.scene,b.parentIndex=c.index)}this.target&&(b.target=this.target.instances(b));var d=this.binds.defs;if(d.length)for(var e=b.defs||(b.defs={}),f=0,g=d.length;g>f;f++){var h=d[f],i=e[h.name];(!i||h.id>i.id)&&(e[h.name]={id:0,value:1&h.type?h.value.apply(this,a):h.value})}var j=this.evalProperty(this.binds.data),k=j.length;if(b.length=k,k){var l=pv.Mark.prototype;a.unshift(null);var m=pv.propBuildMark,n=pv.propBuilt;pv.propBuildMark=this;try{for(var f=0;k>f;f++){l.index=this.index=f,pv.propBuilt={};var o=b[f];o?o._state&&delete o._state:o=b[f]={},o.data=a[0]=j[f],this.preBuildInstance(o),this.buildInstance(o)}}finally{l.index=-1,delete this.index,a.shift(),pv.propBuildMark=m,pv.propBuilt=n}}return this},pv.Mark.prototype.instanceState=function(a){return a||(a=this.instance()),a?a._state||(a._state={}):null},pv.Mark.prototype.preBuildInstance=function(){},pv.Mark.prototype.buildInstance=function(a){this.buildProperties(a,this.binds.required),a.visible&&(this.buildProperties(a,this.binds.optional),this.buildImplied(a))},!function(){var a,b=pv.Mark.stack,c=[function(a){return this.scene.defs[a.name].value},null,function(a){return a.value},function(c){return a=c.proto,c.value.apply(this,b)}];c[1]=c[0],pv.Mark.prototype.buildProperties=function(b,d){var e=pv.propBuilt,f=!e;f&&(pv.propBuildMark=this,pv.propBuilt=e={});for(var g=a,h=0,i=d.length;i>h;h++){var j=d[h],k=j.name;k in e||(e[k]=1,b[k]=c[j.type].call(this,j))}a=g,f&&(pv.propBuildMark=pv.propBuilt=null)},pv.Mark.prototype.evalProperty=function(b){var d=a,e=c[b.type].call(this,b);return a=d,e},pv.Mark.prototype.evalInPropertyContext=function(c,d){var e=a;a=d;var f=c.apply(this,b);return a=e,f},pv.Mark.prototype.delegate=function(b,c){if(a&&(!c||a.tag===c)){var d=this.evalProperty(a);if(void 0!==d)return d}return b},pv.Mark.prototype.delegateExcept=function(b,c){if(a&&(!c||a.tag!==c)){var d=this.evalProperty(a);if(void 0!==d)return d}return b},pv.Mark.prototype.hasDelegate=function(b){return!(!a||b&&a.tag!==b)}}(),pv.Mark.prototype.buildImplied=function(a){var b,c,d=a.left,e=a.right,f=a.top,g=a.bottom,h=this.properties,i=h.width?a.width:0,j=h.height?a.height:0;if(null==i||null==e||null==d){b=this.parent&&this.parent.instance(),c=!0;var k=b?b.width:i+d+e;null==i?i=k-(e=e||0)-(d=d||0):null==e?null==d?d=e=(k-i)/2:e=k-i-d:d=k-i-e}if(null==j||null==g||null==f){c||(b=this.parent&&this.parent.instance());var l=b?b.height:j+f+g;null==j?j=l-(f=f||0)-(g=g||0):null==g?g=null==f?f=(l-j)/2:l-j-f:f=l-j-g}a.left=d,a.right=e,a.top=f,a.bottom=g,h.width&&(a.width=i),h.height&&(a.height=j),h.textStyle&&!a.textStyle&&(a.textStyle=pv.FillStyle.transparent),h.fillStyle&&!a.fillStyle&&(a.fillStyle=pv.FillStyle.transparent),h.strokeStyle&&!a.strokeStyle&&(a.strokeStyle=pv.FillStyle.transparent)},pv.Mark.prototype.mouse=function(){var a=this.root.canvas(),b=pv.event,c=b&&b.pageX||0,d=b&&b.pageY||0,e=pv.elementOffset(a);if(e){var f=pv.cssStyle(a);c-=e.left+parseFloat(f("paddingLeft")||0),d-=e.top+parseFloat(f("paddingTop")||0)}var g=pv.Transform.identity,h=this.properties.transform?this:this.parent,i=[];do i.push(h);while(h=h.parent);for(;h=i.pop();){var j=h.instance();g=g.translate(j.left,j.top).times(j.transform)}return g=g.invert(),pv.vector(c*g.k+g.x,d*g.k+g.y)},pv.Mark.prototype.event=function(a,b){b=pv.functor(b);var c=this.$handlers[a];return c?c instanceof Array?c.push(b):c=[c,b]:c=b,this.$hasHandlers=!0,this.$handlers[a]=c,this},pv.Mark.prototype.context=function(a,b,c){function d(a,b){if(pv.Mark.scene=a,f.index=b,a){var c,d=a.mark,e=d,h=[];do h.push(e),g.push(a[b].data),e.index=b,e.scene=a,(e=e.parent)&&(b=a.parentIndex,a=a.parent);while(e);var i=1;if(c=h.length-1,c>0)do e=h[c--],e.scale=i,i*=e.scene[e.index].transform.k;while(c);d.scale=i;var j,k=d.children;if(k&&(j=k.length)>0){var l=d.scene[d.index];i*=l.transform.k;var m=l.children;for(c=j;c--;)e=k[c],e.scene=m[c],e.scale=i}}}function e(a){if(a){var b,c=a.mark,d=c.children;if(d)for(var e=d.length;e--;)b=d[e],b.scene=void 0,b.scale=1;b=c;var f,h=0;do h++,delete b.index,(f=b.parent)&&(b.scene=void 0,b.scale=1);while(b=f);h&&(g.length-=h)}}var f=pv.Mark.prototype,g=pv.Mark.stack,h=pv.Mark.scene,i=f.index;if(a&&a===h&&b===i)try{c.apply(this,g)}catch(a){throw pv.error(a),a}finally{pv.Mark.scene=h,f.index=i}else{e(h,i),d(a,b);try{c.apply(this,g)}catch(a){throw pv.error(a),a}finally{e(a,b),d(h,i)}}},pv.Mark.prototype.getEventHandler=function(a,b,c,d){var e=this.$handlers[a];return e?[e,b,c,d]:this.getParentEventHandler(a,b,c,d)},pv.Mark.prototype.getParentEventHandler=function(a,b,c,d){var e=b.parent;return e?e.mark.getEventHandler(a,e,b.parentIndex,d):void 0},pv.Mark.dispatch=function(a,b,c,d){var e=b.mark.root;if(e.$transition)return!0;var f,g=e.$interceptors&&e.$interceptors[a];if(g)for(var h=0,i=g.length;i>h&&!(f=g[h](a,d));h++)if(f===!1)return!0;return!(!f&&!(f=b.mark.getEventHandler(a,b,c,d)))&&this.handle.apply(this,f)},pv.Mark.handle=function(a,b,c,d){var e=b.mark;return e.context(b,c,function(){var b,c,f,g=pv.Mark.stack.concat(d);if(a instanceof Array){var h;for(b=0,c=a.length;c>b;b++)f=a[b].apply(e,g),f&&f.render&&(h||(h=[])).push(f);if(h)for(b=0,c=h.length;c>b;b++)h[b].render()}else f=a.apply(e,g),f&&f.render&&f.render()}),!0},pv.Mark.prototype.addEventInterceptor=function(a,b,c){var d=this.root;if(d){var e=d.$interceptors||(d.$interceptors={}),f=e[a]||(e[a]=[]);c?f.unshift(b):f.push(b)}},pv.Mark.prototype.eachInstance=function(a,b){function c(d,f,h){var i=d.length;if(i>0){var j,k=f===g;k||(j=e[f]);for(var l=0;i>l;l++){var m=d[l];if(m.visible)if(f===g)a.call(b,d,l,h);else{var n=m.children[j];if(n){var o=h.times(m.transform).translate(m.left,m.top);c(n,f+1,o)}}}}}for(var d=this,e=[];d.parent;)e.unshift(d.childIndex),d=d.parent;var f=d.scene;if(f){var g=e.length;c(f,0,pv.Transform.identity)}},pv.Mark.prototype.toScreenTransform=function(){var a=pv.Transform.identity;this instanceof pv.Panel&&(a=a.translate(this.left(),this.top()).times(this.transform()));var b=this.parent;if(b)do a=a.translate(b.left(),b.top()).times(b.transform());while(b=b.parent);return a},pv.Mark.prototype.transition=function(){return new pv.Transition(this)},pv.Mark.prototype.on=function(a){return this["$"+a]=new pv.Transient(this)},pv.Mark.prototype.getShape=function(a,b,c){var d=a[b];if(!d.visible)return null;null==c&&(c=0);var e="_shape_inset_"+c;return d[e]||(d[e]=this.getShapeCore(a,b,c))},pv.Mark.prototype.getShapeCore=function(a,b,c){var d=a[b],e=d.left,f=d.top,g=d.width,h=d.height;if(c>0&&1>=c){var i=c*g,j=c*h;e+=i,f+=j,g-=2*i,h-=2*j}return new pv.Shape.Rect(e,f,g,h)},pv.Anchor=function(a){pv.Mark.call(this),this.target=a,this.parent=a.parent},pv.Anchor.prototype=pv.extend(pv.Mark).property("name",String),pv.Anchor.prototype.extend=function(a){return this.proto=a,this},pv.Area=function(){pv.Mark.call(this)},pv.Area.castSegmented=function(a){if(!a)return"";switch(a){case"smart":case"full":break;default:a="full"}return a},pv.Area.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("segmented",pv.Area.castSegmented).property("interpolate",String).property("tension",Number),pv.Area.prototype.type="area",pv.Area.prototype.defaults=(new pv.Area).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).interpolate("linear").tension(.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none"),pv.Area.prototype.buildImplied=function(a){null==a.height&&(a.height=0),null==a.width&&(a.width=0),pv.Mark.prototype.buildImplied.call(this,a)},pv.Area.fixed={lineWidth:1,lineJoin:1,strokeMiterLimit:1,lineCap:1,strokeStyle:1,strokeDasharray:1,fillStyle:1,segmented:1,interpolate:1,tension:1},pv.Area.prototype.bind=function(){pv.Mark.prototype.bind.call(this);for(var a=this.binds,b=a.required,c=a.optional,d=0,e=c.length;e>d;d++){var f=c[d];f.fixed=f.name in pv.Area.fixed,"segmented"==f.name&&(b.push(f),c.splice(d,1),d--,e--)}this.binds.$required=b,this.binds.$optional=c},pv.Area.prototype.buildInstance=function(a){function b(a){return!a.fixed||(d.push(a),!1)}var c=this.binds;if(this.index){var d=c.fixed;d||(d=c.fixed=[],c.required=c.required.filter(b),this.scene[0].segmented||(c.optional=c.optional.filter(b)));var e=d.length;if(e)for(var f=this.scene[0],g=0;e>g;g++){var h=d[g].name;a[h]=f[h]}}else c.required=c.$required,c.optional=c.$optional,c.fixed=null;pv.Mark.prototype.buildInstance.call(this,a)},pv.Area.prototype.anchor=function(a){return pv.Mark.prototype.anchor.call(this,a).interpolate(function(){return this.scene.target[this.index].interpolate}).eccentricity(function(){return this.scene.target[this.index].eccentricity}).tension(function(){return this.scene.target[this.index].tension})},pv.Area.prototype.getEventHandler=function(a,b,c,d){var e=b[c],f=1===pv.Scene.mousePositionEventSet[a]&&!e.segmented||"smart"===e.segmented;if(!f)return pv.Mark.prototype.getEventHandler.call(this,a,b,c,d);var g=this.$handlers[a],h="mousemove"===a,i=h?this.$handlers.mouseover:null;if(!g&&!i)return this.getParentEventHandler(a,b,c,d);var j=this.getNearestInstanceToMouse(b,c);if(g){if(i){var k=this._mouseOverScene;if(!k||k!==b||this._mouseOverIndex!==j)return this._mouseOverScene=b,this._mouseOverIndex=j,[[g,i],b,j,d]}return[g,b,j,d]}return[i,b,j,d]},pv.Area.prototype.getNearestInstanceToMouse=function(a,b){for(var c=this.mouse(),d=1/0,e=null,f=b,g=a.length;g>f;f++){var h=this.getShape(a,f);if(h){if(h.containsPoint(c))return f;var i=h.distance2(c).dist2;d>i&&(d=i,e=f)}}return null!=e?e:b},pv.Area.prototype.getShapeCore=function(a,b){var c=a[b],d=c.width||0,e=c.height||0,f=c.left,g=c.top,h=b+1<a.length?a[b+1]:null;if(!h||!h.visible)return new pv.Shape.Line(f,g,f+d,g+e);var i=h.left,j=h.top,k=h.height||0,l=h.width||0;return new pv.Shape.Polygon([new pv.Vector(f,g),new pv.Vector(i,j),new pv.Vector(i+l,j+k),new pv.Vector(f+d,g+e)])},pv.Bar=function(){pv.Mark.call(this)},pv.Bar.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String),pv.Bar.prototype.type="bar",pv.Bar.prototype.defaults=(new pv.Bar).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).lineCap("butt").strokeDasharray("none"),pv.Dot=function(){pv.Mark.call(this)},pv.Dot.prototype=pv.extend(pv.Mark).property("shape",String).property("shapeAngle",Number).property("shapeRadius",Number).property("shapeSize",Number).property("aspectRatio",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle),pv.Dot.prototype.type="dot",pv.Dot.prototype.defaults=(new pv.Dot).extend(pv.Mark.prototype.defaults).shape("circle").aspectRatio(1).lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).lineCap("butt").strokeDasharray("none"),pv.Dot.prototype.anchor=function(a){return pv.Mark.prototype.anchor.call(this,a).left(function(){var a=this.scene.target[this.index];switch(this.name()){case"bottom":case"top":case"center":return a.left;case"left":return null}return a.left+a._width/2}).right(function(){var a=this.scene.target[this.index];return"left"==this.name()?a.right+a._width/2:null}).top(function(){var a=this.scene.target[this.index];switch(this.name()){case"left":case"right":case"center":return a.top;case"top":return null}return a.top+a._height/2}).bottom(function(){var a=this.scene.target[this.index];return"top"==this.name()?a.bottom+a._height/2:null}).textAlign(function(){switch(this.name()){case"left":return"right";case"bottom":case"top":case"center":return"center"}return"left"}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"bottom":return"top"}return"bottom"})},pv.Dot.prototype.buildImplied=function(a){var b=a.shapeRadius,c=a.shapeSize,d=a.aspectRatio||1;null==b?null==c?(c=a.shapeSize=20.25,b=a.shapeRadius=4.5):b=a.shapeRadius=Math.sqrt(c):null==c&&(c=a.shapeSize=b*b);var e,f;1===d||0>d?e=f=2*b:(e=2*b/Math.sqrt(d),f=d*e),a._height=e,a._width=f,pv.Mark.prototype.buildImplied.call(this,a)},pv.Dot.prototype.width=function(){return this.instance()._width},pv.Dot.prototype.height=function(){return this.instance()._height},pv.Dot.prototype.getShapeCore=function(a,b){var c=a[b],d=c._width,e=c._height,f=c.left,g=c.top;switch(c.shape){case"diamond":d*=Math.SQRT2,e*=Math.SQRT2;case"square":case"cross":return new pv.Shape.Rect(f-e/2,g-d/2,e,d)}return new pv.Shape.Circle(f,g,c.shapeRadius)},pv.Label=function(){pv.Mark.call(this)},pv.Label.prototype=pv.extend(pv.Mark).property("text",String).property("font",String).property("textAngle",Number).property("textStyle",pv.color).property("textAlign",String).property("textBaseline",String).property("textMargin",Number).property("textDecoration",String).property("textShadow",String),pv.Label.prototype.type="label",pv.Label.prototype.defaults=(new pv.Label).extend(pv.Mark.prototype.defaults).events("none").text(pv.identity).font("10px sans-serif").textAngle(0).textStyle("black").textAlign("left").textBaseline("bottom").textMargin(3),pv.Label.prototype.getShapeCore=function(a,b,c){var d=a[b],e=pv.Text.measure(d.text,d.font),f=d.left,g=d.top,h=e.width,i=e.height;if(c>0&&1>=c){var j=c*h,k=c*i;f+=j,g+=k,h-=2*j,i-=2*k}return pv.Label.getPolygon(h,i,d.textAlign,d.textBaseline,d.textAngle,d.textMargin).apply(pv.Transform.identity.translate(f,g))},pv.Label.getPolygon=function(a,b,c,d,e,f){var g,h;switch(d){case"middle":h=b/2;break;case"top":h=f+b;break;case"bottom":h=-f}switch(c){case"right":g=-f-a;break;case"center":g=-a/2;break;case"left":g=f}var i=new pv.Vector(g,h),j=i.plus(a,0),k=j.plus(0,-b),l=i.plus(0,-b);return 0!==e&&(i=i.rotate(e),j=j.rotate(e),l=l.rotate(e),k=k.rotate(e)),new pv.Shape.Polygon([i,j,k,l])},pv.Line=function(){pv.Mark.call(this)},pv.Line.prototype=pv.extend(pv.Mark).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeStyle",pv.fillStyle).property("strokeDasharray",String).property("fillStyle",pv.fillStyle).property("segmented",pv.Area.castSegmented).property("interpolate",String).property("eccentricity",Number).property("tension",Number),pv.Line.prototype.type="line",pv.Line.prototype.defaults=(new pv.Line).extend(pv.Mark.prototype.defaults).lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).interpolate("linear").eccentricity(0).tension(.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none"),pv.Line.prototype.bind=pv.Area.prototype.bind,pv.Line.prototype.buildInstance=pv.Area.prototype.buildInstance,pv.Line.prototype.getEventHandler=pv.Area.prototype.getEventHandler,pv.Line.prototype.getNearestInstanceToMouse=pv.Area.prototype.getNearestInstanceToMouse,pv.Line.prototype.anchor=function(a){return pv.Area.prototype.anchor.call(this,a).textAlign(function(){switch(this.name()){case"left":return"right";case"bottom":case"top":case"center":return"center";case"right":return"left"}}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"top":return"bottom";case"bottom":return"top"}})},pv.Line.prototype.getShapeCore=function(a,b){var c=a[b],d=b+1<a.length?a[b+1]:null;return null!=d&&d.visible?new pv.Shape.Line(c.left,c.top,d.left,d.top):new pv.Shape.Point(c.left,c.top)},pv.Rule=function(){pv.Mark.call(this)},pv.Rule.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String),pv.Rule.prototype.type="rule",pv.Rule.prototype.defaults=(new pv.Rule).extend(pv.Mark.prototype.defaults).lineWidth(1).strokeStyle("black").antialias(!1).lineCap("butt").strokeDasharray("none"),pv.Rule.prototype.anchor=pv.Line.prototype.anchor,pv.Rule.prototype.buildImplied=function(a){var b=a.left,c=a.right;a.top,a.bottom,null!=a.width||null==b&&null==c||null!=c&&null!=b?a.height=0:a.width=0,pv.Mark.prototype.buildImplied.call(this,a)},pv.Rule.prototype.getShapeCore=function(a,b){var c=a[b];return new pv.Shape.Line(c.left,c.top,c.left+c.width,c.top+c.height)},pv.Panel=function(){pv.Bar.call(this),this.children=[],this.root=this,this.$dom=pv.$&&pv.$.s},pv.Panel.prototype=pv.extend(pv.Bar).property("transform").property("overflow",String).property("canvas",function(a){return"string"==typeof a?document.getElementById(a):a}),pv.Panel.prototype.type="panel",pv.Panel.prototype._zOrderChildCount=0,pv.Panel.prototype.defaults=(new pv.Panel).extend(pv.Bar.prototype.defaults).fillStyle(null).overflow("visible"),pv.Panel.prototype.anchor=function(a){var b=pv.Bar.prototype.anchor.call(this,a);return b.parent=this,b},pv.Panel.prototype.add=function(a){var b=new a;b.parent=this,b.root=this.root,b.childIndex=this.children.length,this.children.push(b);var c=+b._zOrder||0;return 0!==c&&this._zOrderChildCount++,b},pv.Panel.prototype.bind=function(){pv.Mark.prototype.bind.call(this);for(var a=this.children,b=0,c=a.length;c>b;b++)a[b].bind()},pv.Panel.prototype.buildInstance=function(a){if(pv.Bar.prototype.buildInstance.call(this,a),a.visible){var b=this.scale*a.transform.k;pv.Mark.prototype.index=-1;for(var c,d=this.children,e=a.children||(a.children=[]),f=0,g=d.length;g>f;f++)c=d[f],c.scene=e[f],c.scale=b,c.build();for(f=g;f--;)c=d[f],e[f]=c.scene,delete c.scene,delete c.scale;e.length=g}},pv.Panel.prototype.buildImplied=function(a){this.parent||this._buildRootInstanceImplied(a)?(a.transform||(a.transform=pv.Transform.identity),pv.Mark.prototype.buildImplied.call(this,a)):a.visible=!1},pv.Panel.prototype._buildRootInstanceImplied=function(a){var b=a.canvas;if(b){if(!this._rootInstanceStealCanvas(a,b))return!1;this._rootInstanceInitCanvas(a,b)}else a.canvas=this._rootInstanceGetInlineCanvas(a);return!0},pv.Panel.prototype._rootInstanceStealCanvas=function(a,b){var c=b.$panel;if(c!==this){if(c){if(this.$lastCreateId)return!1;c._disposeRootPanel(),this._updateCreateId(b)}b.$panel=this,pv.removeChildren(b)}else this._updateCreateId(b);return!0},pv.Panel.prototype._registerBoundEvent=function(a,b,c,d){if(a.removeEventListener){var e=this._boundEvents||(this._boundEvents=[]);e.push([a,b,c,d])}},pv.Panel.prototype._disposeRootPanel=function(){var a=this.$transition;a&&a.stop();var b=this._boundEvents;if(b){this._boundEvents=null;for(var c=0,d=b.length;d>c;c++){var e=b[c];e[0].removeEventListener(e[1],e[2],e[3])}}},pv.Panel.prototype._rootInstanceInitCanvas=function(a,b){var c,d,e;null==a.width&&(e=pv.cssStyle(b),c=parseFloat(e("width")||0),a.width=c-a.left-a.right),null==a.height&&(e||(e=pv.cssStyle(b)),d=parseFloat(e("height")||0),a.height=d-a.top-a.bottom),e=null},pv.Panel.prototype._rootInstanceGetInlineCanvas=function(){var a,b=this.$canvas||(this.$canvas=[]);if(!(a=b[this.index]))if(a=b[this.index]=document.createElement("span"),this.$dom)this.$dom.parentNode.insertBefore(a,this.$dom);else{for(var c=document.body;c.lastChild&&c.lastChild.tagName;)c=c.lastChild;c!=document.body&&(c=c.parentNode),c.appendChild(a)}return a},pv.Panel.prototype._updateCreateId=function(a){this.$lastCreateId=a.$pvCreateId=(a.$pvCreateId||0)+1},pv.Image=function(){pv.Bar.call(this)},pv.Image.prototype=pv.extend(pv.Bar).property("url",String).property("imageWidth",Number).property("imageHeight",Number),pv.Image.prototype.type="image",pv.Image.prototype.defaults=(new pv.Image).extend(pv.Bar.prototype.defaults).fillStyle(null),pv.Image.prototype.image=function(a){return this.$image=function(){var b=a.apply(this,arguments);return null==b?pv.Color.transparent:"string"==typeof b?pv.color(b):b},this},pv.Image.prototype.bind=function(){pv.Bar.prototype.bind.call(this);var a=this.binds,b=this;do a.image=b.$image;while(!a.image&&(b=b.proto))},pv.Image.prototype.buildImplied=function(a){if(pv.Bar.prototype.buildImplied.call(this,a),a.visible&&(null==a.imageWidth&&(a.imageWidth=a.width),null==a.imageHeight&&(a.imageHeight=a.height),null==a.url&&this.binds.image)){var b,c=this.$canvas||(this.$canvas=document.createElement("canvas")),d=c.getContext("2d"),e=a.imageWidth,f=a.imageHeight,g=pv.Mark.stack;c.width=e,c.height=f,b=(a.image=d.createImageData(e,f)).data,g.unshift(null,null);for(var h=0,i=0;f>h;h++){g[1]=h;for(var j=0;e>j;j++){g[0]=j;var k=this.binds.image.apply(this,g);b[i++]=k.r,b[i++]=k.g,b[i++]=k.b,b[i++]=255*k.a}}g.splice(0,2)}},pv.Wedge=function(){pv.Mark.call(this)},pv.Wedge.prototype=pv.extend(pv.Mark).property("startAngle",Number).property("endAngle",Number).property("angle",Number).property("innerRadius",Number).property("outerRadius",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle),pv.Wedge.prototype.type="wedge",pv.Wedge.prototype.defaults=(new pv.Wedge).extend(pv.Mark.prototype.defaults).startAngle(function(){var a=this.sibling();return a?a.endAngle:-Math.PI/2}).innerRadius(0).lineWidth(1.5).strokeStyle(null).fillStyle(pv.Colors.category20().by(pv.index)).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none"),pv.Wedge.prototype.midRadius=function(){return(this.innerRadius()+this.outerRadius())/2},pv.Wedge.prototype.midAngle=function(){return(this.startAngle()+this.endAngle())/2},pv.Wedge.prototype.anchor=function(a){function b(a){return a.innerRadius||a.angle<2*Math.PI}function c(a){return(a.innerRadius+a.outerRadius)/2}function d(a){return(a.startAngle+a.endAngle)/2}return pv.Mark.prototype.anchor.call(this,a).left(function(){var a=this.scene.target[this.index];if(b(a))switch(this.name()){case"outer":return a.left+a.outerRadius*Math.cos(d(a));case"inner":return a.left+a.innerRadius*Math.cos(d(a));case"start":return a.left+c(a)*Math.cos(a.startAngle);case"center":return a.left+c(a)*Math.cos(d(a));case"end":return a.left+c(a)*Math.cos(a.endAngle)}return a.left}).top(function(){var a=this.scene.target[this.index];if(b(a))switch(this.name()){case"outer":return a.top+a.outerRadius*Math.sin(d(a));case"inner":return a.top+a.innerRadius*Math.sin(d(a));case"start":return a.top+c(a)*Math.sin(a.startAngle);case"center":return a.top+c(a)*Math.sin(d(a));case"end":return a.top+c(a)*Math.sin(a.endAngle)}return a.top}).textAlign(function(){var a=this.scene.target[this.index];if(b(a))switch(this.name()){case"outer":return pv.Wedge.upright(d(a))?"right":"left";case"inner":return pv.Wedge.upright(d(a))?"left":"right"}return"center"}).textBaseline(function(){var a=this.scene.target[this.index];if(b(a))switch(this.name()){case"start":return pv.Wedge.upright(a.startAngle)?"top":"bottom";case"end":return pv.Wedge.upright(a.endAngle)?"bottom":"top"}return"middle"}).textAngle(function(){var a=this.scene.target[this.index],c=0;if(b(a))switch(this.name()){case"center":case"inner":case"outer":c=d(a);break;case"start":c=a.startAngle;break;case"end":c=a.endAngle}return pv.Wedge.upright(c)?c:c+Math.PI})},pv.Wedge.upright=function(a){return a%=2*Math.PI,a=0>a?2*Math.PI+a:a,a<Math.PI/2||a>=3*Math.PI/2},pv.Wedge.prototype.buildImplied=function(a){null==a.angle?a.angle=a.endAngle-a.startAngle:null==a.endAngle&&(a.endAngle=a.startAngle+a.angle),pv.Mark.prototype.buildImplied.call(this,a)},pv.Wedge.prototype.getShapeCore=function(a,b){var c=a[b];return new pv.Shape.Wedge(c.left,c.top,c.innerRadius,c.outerRadius,c.startAngle,c.angle)},pv.Ease=function(){function a(a){return function(b){return 1-a(1-b)}}function b(a){return function(b){return.5*(.5>b?a(2*b):2-a(2-2*b))}}function c(a){return function(b){return 0>b?0:b>1?1:Math.pow(b,a)}}function d(a){return 1-Math.cos(a*Math.PI/2)}function e(a){return a?Math.pow(2,10*(a-1))-.001:0}function f(a){return-(Math.sqrt(1-a*a)-1)}function g(a,b){var c;return b||(b=.45),!a||1>a?(a=1,c=b/4):c=b/(2*Math.PI)*Math.asin(1/a),function(d){return 0>=d||d>=1?d:-(a*Math.pow(2,10*--d)*Math.sin(2*(d-c)*Math.PI/b))}}function h(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function i(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}var j=c(2),k=c(3),l=g(),m=h(),n={linear:pv.identity,"quad-in":j,"quad-out":a(j),"quad-in-out":b(j),"quad-out-in":b(a(j)),"cubic-in":k,"cubic-out":a(k),"cubic-in-out":b(k),"cubic-out-in":b(a(k)),"sin-in":d,"sin-out":a(d),"sin-in-out":b(d),"sin-out-in":b(a(d)),"exp-in":e,"exp-out":a(e),"exp-in-out":b(e),"exp-out-in":b(a(e)),"circle-in":f,"circle-out":a(f),"circle-in-out":b(f),"circle-out-in":b(a(f)),"elastic-in":l,"elastic-out":a(l),"elastic-in-out":b(l),"elastic-out-in":b(a(l)),"back-in":m,"back-out":a(m),"back-in-out":b(m),"back-out-in":b(a(m)),"bounce-in":i,"bounce-out":a(i),"bounce-in-out":b(i),"bounce-out-in":b(a(i))};return pv.ease=function(a){return n[a]},{reverse:a,reflect:b,linear:function(){return pv.identity},sin:function(){return d},exp:function(){return e},circle:function(){return f},elastic:g,back:h,bounce:i,poly:c}}(),pv.Transient=function(a){pv.Mark.call(this),this.fillStyle(null).strokeStyle(null).textStyle(null),this.on=function(b){return a.on(b)}},pv.Transient.prototype=pv.extend(pv.Mark),!function(){function a(a){for(var b={},c=a.length;c--;){var d=a[c],e=d.id;e&&(b[e]=d)}return b}function b(a,b,c,d){var e;if(b in g){var f=pv.Scale.interpolator(c[b],d[b]);e=function(a){c[b]=f(a)}}else e=function(a){a>.5&&(c[b]=d[b])};e.next=a.head,a.head=e}function c(a,c,d){for(var f in c)"children"!==f&&c[f]!=d[f]&&b(a,f,c,d);var g=c.children;if(g)for(var h=d.children,i=0,j=g.length;j>i;i++)e(a,g[i],h[i])}function d(a,b,c,d){var e,f=Object.create(a[b]),g=a.mark,i=g.root.scene;d.target&&(e=d.target[d.length])&&(a=Object.create(a),a.target=Object.create(d.target),a.target[b]=e),c||(c=h);var j=c.$properties,k=c.$propertiesMap;return j=g.binds.optional.filter(function(a){return!(a.name in k)}).concat(j),g.context(a,b,function(){this.buildProperties(f,j),this.buildImplied(f)}),g.root.scene=i,f}function e(b,e,f){for(var g,h,i=e.mark,j=a(e),k=a(f),l=0,m=e.length;m>l;l++)if(g=e[l],h=g.id?k[g.id]:f[l],g.index=l,g.visible){if(!h||!h.visible){var n=d(e,l,i.$exit,f);g.transition=h?2:(f.push(n),1),h=n}c(b,g,h)}for(l=0,m=f.length;m>l;l++)if(h=f[l],g=h.id?j[h.id]:e[l],(!g||!g.visible)&&h.visible){var o=d(f,l,i.$enter,e);g?e[g.index]=o:e.push(o),c(b,o,h)}}function f(a){for(var b=0,c=0;b<a.length;b++){var d=a[b];1!=d.transition&&(a[c++]=d,2==d.transition&&(d.visible=!1),d.children&&d.children.forEach(f))}a.length=c}var g={top:1,left:1,right:1,bottom:1,width:1,height:1,innerRadius:1,outerRadius:1,radius:1,shapeRadius:1,shapeSize:1,startAngle:1,endAngle:1,angle:1,fillStyle:1,strokeStyle:1,lineWidth:1,eccentricity:1,tension:1,textAngle:1,textStyle:1,textMargin:1},h=new pv.Transient;pv.Transition=function(a){function b(b){var e=a.root.$transition===h;if(e&&(a.root.$transition=null),null!=c&&(clearInterval(c),c=null),e&&k(a.scene),d){var f=d;d=null,f(b)}return b}var c,d,g,h=this,i=pv.ease("cubic-in-out"),j=250,k=function(a){g||(g=!0,f(a))};h.ease=function(a){return arguments.length?(i="function"==typeof a?a:pv.ease(a),h):i},h.duration=function(a){return arguments.length?(j=Number(a),h):j},h.start=function(f){if(a.parent)throw new Error("Animated partial rendering is not supported.");d=f;var g=a.root;if(g.$transition)try{g.$transition.stop()}catch(a){return b(!1)}var l,m;g.$transition=h;var n=a.scene;a.scene=null;var o=pv.Mark.prototype.index;try{a.bind(),a.build();var p=a.scene;a.scene=n,pv.Mark.prototype.index=o,m=Date.now(),l={},e(l,n,p)}catch(a){return pv.Mark.prototype.index=o,b(!1)}if(!l.head)return b(!0);var q=function(){var c=Math.max(0,Math.min(1,(Date.now()-m)/j)),d=i(c),e=l.head;do e(d);while(e=e.next);1===c?(k(a.scene),pv.Scene.updateAll(n),b(!0)):pv.Scene.updateAll(n)};c=setInterval(function(){try{q()}catch(a){b(!1)}},24)},h.stop=function(){b(!0)}}}(),pv.simulation=function(a){return new pv.Simulation(a)},pv.Simulation=function(a){for(var b=0;b<a.length;b++)this.particle(a[b])},pv.Simulation.prototype.particle=function(a){return a.next=this.particles,isNaN(a.px)&&(a.px=a.x),isNaN(a.py)&&(a.py=a.y),isNaN(a.fx)&&(a.fx=0),isNaN(a.fy)&&(a.fy=0),this.particles=a,this},pv.Simulation.prototype.force=function(a){return a.next=this.forces,this.forces=a,this},pv.Simulation.prototype.constraint=function(a){return a.next=this.constraints,this.constraints=a,this},pv.Simulation.prototype.stabilize=function(a){var b;arguments.length||(a=3);for(var c=0;a>c;c++){var d=new pv.Quadtree(this.particles);for(b=this.constraints;b;b=b.next)b.apply(this.particles,d)}for(var e=this.particles;e;e=e.next)e.px=e.x,e.py=e.y;return this},pv.Simulation.prototype.step=function(){var a,b,c;for(a=this.particles;a;a=a.next){var d=a.px,e=a.py;a.px=a.x,a.py=a.y,a.x+=a.vx=a.x-d+a.fx,a.y+=a.vy=a.y-e+a.fy}var f=new pv.Quadtree(this.particles);for(c=this.constraints;c;c=c.next)c.apply(this.particles,f);for(a=this.particles;a;a=a.next)a.fx=a.fy=0;for(b=this.forces;b;b=b.next)b.apply(this.particles,f)},pv.Quadtree=function(a){function b(a,b,d,e,f,g){if(!isNaN(b.x)&&!isNaN(b.y))if(a.leaf)if(a.p)if(Math.abs(a.p.x-b.x)+Math.abs(a.p.y-b.y)<.01)c(a,b,d,e,f,g);else{var h=a.p;a.p=null,c(a,h,d,e,f,g),c(a,b,d,e,f,g)}else a.p=b;else c(a,b,d,e,f,g)}function c(a,c,d,e,f,g){var h=.5*(d+f),i=.5*(e+g),j=c.x>=h,k=c.y>=i;switch(a.leaf=!1,(k<<1)+j){case 0:a=a.c1||(a.c1=new pv.Quadtree.Node);break;case 1:a=a.c2||(a.c2=new pv.Quadtree.Node);break;case 2:a=a.c3||(a.c3=new pv.Quadtree.Node);break;case 3:a=a.c4||(a.c4=new pv.Quadtree.Node)}j?d=h:f=h,k?e=i:g=i,b(a,c,d,e,f,g)}var d,e=Number.POSITIVE_INFINITY,f=e,g=Number.NEGATIVE_INFINITY,h=g;for(d=a;d;d=d.next)d.x<e&&(e=d.x),d.y<f&&(f=d.y),d.x>g&&(g=d.x),d.y>h&&(h=d.y);var i=g-e,j=h-f;for(i>j?h=f+i:g=e+j,this.xMin=e,this.yMin=f,this.xMax=g,this.yMax=h,this.root=new pv.Quadtree.Node,d=a;d;d=d.next)b(this.root,d,e,f,g,h)},pv.Quadtree.Node=function(){this.leaf=!0,
this.c1=null,this.c2=null,this.c3=null,this.c4=null,this.p=null},pv.Force={},pv.Force.charge=function(a){function b(c){function d(a){b(a),c.cn+=a.cn,e+=a.cn*a.cx,f+=a.cn*a.cy}var e=0,f=0;c.cn=0,c.leaf||(c.c1&&d(c.c1),c.c2&&d(c.c2),c.c3&&d(c.c3),c.c4&&d(c.c4)),c.p&&(c.cn+=a,e+=a*c.p.x,f+=a*c.p.y),c.cx=e/c.cn,c.cy=f/c.cn}function c(b,d,f,i,j,k){var l=b.cx-d.x,m=b.cy-d.y,n=1/Math.sqrt(l*l+m*m);if(b.leaf&&b.p!=d||h>(j-f)*n){if(g>n)return;n>e&&(n=e);var o=b.cn*n*n*n,p=l*o,q=m*o;d.fx+=p,d.fy+=q}else if(!b.leaf){var r=.5*(f+j),s=.5*(i+k);if(b.c1&&c(b.c1,d,f,i,r,s),b.c2&&c(b.c2,d,r,i,j,s),b.c3&&c(b.c3,d,f,s,r,k),b.c4&&c(b.c4,d,r,s,j,k),g>n)return;if(n>e&&(n=e),b.p&&b.p!=d){var o=a*n*n*n,p=l*o,q=m*o;d.fx+=p,d.fy+=q}}}var d=2,e=1/d,f=500,g=1/f,h=.9,i={};return arguments.length||(a=-40),i.constant=function(b){return arguments.length?(a=Number(b),i):a},i.domain=function(a,b){return arguments.length?(d=Number(a),e=1/d,f=Number(b),g=1/f,i):[d,f]},i.theta=function(a){return arguments.length?(h=Number(a),i):h},i.apply=function(a,d){b(d.root);for(var e=a;e;e=e.next)c(d.root,e,d.xMin,d.yMin,d.xMax,d.yMax)},i},pv.Force.drag=function(a){var b={};return arguments.length||(a=.1),b.constant=function(c){return arguments.length?(a=c,b):a},b.apply=function(b){if(a)for(var c=b;c;c=c.next)c.fx-=a*c.vx,c.fy-=a*c.vy},b},pv.Force.spring=function(a){var b,c,d=.1,e=20,f={};return arguments.length||(a=.1),f.links=function(a){return arguments.length?(b=a,c=a.map(function(a){return 1/Math.sqrt(Math.max(a.sourceNode.linkDegree,a.targetNode.linkDegree))}),f):b},f.constant=function(b){return arguments.length?(a=Number(b),f):a},f.damping=function(a){return arguments.length?(d=Number(a),f):d},f.length=function(a){return arguments.length?(e=Number(a),f):e},f.apply=function(){for(var f=0;f<b.length;f++){var g=b[f].sourceNode,h=b[f].targetNode,i=g.x-h.x,j=g.y-h.y,k=Math.sqrt(i*i+j*j),l=k?1/k:1,m=a*c[f],n=d*c[f],o=(m*(k-e)+n*(i*(g.vx-h.vx)+j*(g.vy-h.vy))*l)*l,p=-o*(k?i:.01*(.5-Math.random())),q=-o*(k?j:.01*(.5-Math.random()));g.fx+=p,g.fy+=q,h.fx-=p,h.fy-=q}},f},pv.Constraint={},pv.Constraint.collision=function(a){function b(h,i,j,k,l,m){if(!h.leaf){var n=.5*(j+l),o=.5*(k+m),p=o>e,q=g>o,r=n>d,s=f>n;p&&(h.c1&&r&&b(h.c1,i,j,k,n,o),h.c2&&s&&b(h.c2,i,n,k,l,o)),q&&(h.c3&&r&&b(h.c3,i,j,o,n,m),h.c4&&s&&b(h.c4,i,n,o,l,m))}if(h.p&&h.p!=i){var t=i.x-h.p.x,u=i.y-h.p.y,v=Math.sqrt(t*t+u*u),w=c+a(h.p);if(w>v){var x=(v-w)/v*.5;t*=x,u*=x,i.x-=t,i.y-=u,h.p.x+=t,h.p.y+=u}}}var c,d,e,f,g,h=1,i={};return arguments.length||(c=10),i.repeat=function(a){return arguments.length?(h=Number(a),i):h},i.apply=function(i,j){var k,l,m=-1/0;for(k=i;k;k=k.next)l=a(k),l>m&&(m=l);for(var n=0;h>n;n++)for(k=i;k;k=k.next)l=(c=a(k))+m,d=k.x-l,f=k.x+l,e=k.y-l,g=k.y+l,b(j.root,k,j.xMin,j.yMin,j.xMax,j.yMax)},i},pv.Constraint.position=function(a){var b=1,c={};return arguments.length||(a=function(a){return a.fix}),c.alpha=function(a){return arguments.length?(b=Number(a),c):b},c.apply=function(c){for(var d=c;d;d=d.next){var e=a(d);e&&(d.x+=(e.x-d.x)*b,d.y+=(e.y-d.y)*b,d.fx=d.fy=d.vx=d.vy=0)}},c},pv.Constraint.bound=function(){var a,b,c={};return c.x=function(b,c){return arguments.length?(a={min:Math.min(b,c),max:Math.max(b,c)},this):a},c.y=function(a,c){return arguments.length?(b={min:Math.min(a,c),max:Math.max(a,c)},this):b},c.apply=function(c){if(a)for(var d=c;d;d=d.next)d.x=d.x<a.min?a.min:d.x>a.max?a.max:d.x;if(b)for(var d=c;d;d=d.next)d.y=d.y<b.min?b.min:d.y>b.max?b.max:d.y},c};pv.Layout=function(){pv.Panel.call(this)};pv.Layout.prototype=pv.extend(pv.Panel),pv.Layout.prototype.property=pv.Mark.prototype.localProperty,pv.Layout.Network=function(){pv.Layout.call(this);var a=this;this.$id=pv.id(),(this.node=(new pv.Mark).data(function(){return a.nodes()}).strokeStyle("#1f77b4").fillStyle("#fff").left(function(a){return a.x}).top(function(a){return a.y})).parent=this,this.link=(new pv.Mark).extend(this.node).data(function(a){return[a.sourceNode,a.targetNode]}).fillStyle(null).lineWidth(function(a,b){return 1.5*b.linkValue}).strokeStyle("rgba(0,0,0,.2)"),this.link.add=function(b){return a.add(pv.Panel).data(function(){return a.links()}).add(b).extend(this)},(this.label=(new pv.Mark).extend(this.node).textMargin(7).textBaseline("middle").text(function(a){return a.nodeName||a.nodeValue}).textAngle(function(a){var b=a.midAngle;return pv.Wedge.upright(b)?b:b+Math.PI}).textAlign(function(a){return pv.Wedge.upright(a.midAngle)?"left":"right"})).parent=this},pv.Layout.Network.prototype=pv.extend(pv.Layout).property("nodes",function(a){return a.map(function(a,b){return"object"!=typeof a&&(a={nodeValue:a}),a.index=b,a})}).property("links",function(a){return a.map(function(a){return isNaN(a.linkValue)&&(a.linkValue=isNaN(a.value)?1:a.value),a})}),pv.Layout.Network.prototype.reset=function(){return this.$id=pv.id(),this},pv.Layout.Network.prototype.buildProperties=function(a,b){(a.$id||0)<this.$id&&pv.Layout.prototype.buildProperties.call(this,a,b)},pv.Layout.Network.prototype.buildImplied=function(a){return pv.Layout.prototype.buildImplied.call(this,a),a.$id>=this.$id||(a.$id=this.$id,a.nodes.forEach(function(a){a.linkDegree=0}),void a.links.forEach(function(b){var c=b.linkValue;(b.sourceNode||(b.sourceNode=a.nodes[b.source])).linkDegree+=c,(b.targetNode||(b.targetNode=a.nodes[b.target])).linkDegree+=c}))},pv.Layout.Hierarchy=function(){pv.Layout.Network.call(this),this.link.strokeStyle("#ccc")},pv.Layout.Hierarchy.prototype=pv.extend(pv.Layout.Network),pv.Layout.Hierarchy.prototype.buildImplied=function(a){a.links||(a.links=pv.Layout.Hierarchy.links.call(this)),pv.Layout.Network.prototype.buildImplied.call(this,a)},pv.Layout.Hierarchy.links=function(){return this.nodes().filter(function(a){return a.parentNode}).map(function(a){return{sourceNode:a,targetNode:a.parentNode,linkValue:1}})},pv.Layout.Hierarchy.NodeLink={buildImplied:function(a){function b(a){return a.parentNode?a.depth*(l-k)+k:0}function c(a){return a.parentNode?2*(a.breadth-.25)*Math.PI:0}function d(a){switch(g){case"left":return a.depth*i;case"right":return i-a.depth*i;case"top":return a.breadth*i;case"bottom":return i-a.breadth*i;case"radial":return i/2+b(a)*Math.cos(a.midAngle)}}function e(a){switch(g){case"left":return a.breadth*j;case"right":return j-a.breadth*j;case"top":return a.depth*j;case"bottom":return j-a.depth*j;case"radial":return j/2+b(a)*Math.sin(a.midAngle)}}var f=a.nodes,g=a.orient,h=/^(top|bottom)$/.test(g),i=a.width,j=a.height;if("radial"==g){var k=a.innerRadius,l=a.outerRadius;null==k&&(k=0),null==l&&(l=Math.min(i,j)/2)}for(var m=0;m<f.length;m++){var n=f[m];n.midAngle="radial"==g?c(n):h?Math.PI/2:0,n.x=d(n),n.y=e(n),n.firstChild&&(n.midAngle+=Math.PI)}}},pv.Layout.Hierarchy.Fill={constructor:function(){this.node.strokeStyle("#fff").fillStyle("#ccc").width(function(a){return a.dx}).height(function(a){return a.dy}).innerRadius(function(a){return a.innerRadius}).outerRadius(function(a){return a.outerRadius}).startAngle(function(a){return a.startAngle}).angle(function(a){return a.angle}),this.label.textAlign("center").left(function(a){return a.x+a.dx/2}).top(function(a){return a.y+a.dy/2}),delete this.link},buildImplied:function(a){function b(a,b){return(a+b)/(1+b)}function c(a){switch(l){case"left":return b(a.minDepth,p)*n;case"right":return(1-b(a.maxDepth,p))*n;case"top":return a.minBreadth*n;case"bottom":return(1-a.maxBreadth)*n;case"radial":return n/2}}function d(a){switch(l){case"left":return a.minBreadth*o;case"right":return(1-a.maxBreadth)*o;case"top":return b(a.minDepth,p)*o;case"bottom":return(1-b(a.maxDepth,p))*o;case"radial":return o/2}}function e(a){switch(l){case"left":case"right":return(a.maxDepth-a.minDepth)/(1+p)*n;case"top":case"bottom":return(a.maxBreadth-a.minBreadth)*n;case"radial":return a.parentNode?(a.innerRadius+a.outerRadius)*Math.cos(a.midAngle):0}}function f(a){switch(l){case"left":case"right":return(a.maxBreadth-a.minBreadth)*o;case"top":case"bottom":return(a.maxDepth-a.minDepth)/(1+p)*o;case"radial":return a.parentNode?(a.innerRadius+a.outerRadius)*Math.sin(a.midAngle):0}}function g(a){return Math.max(0,b(a.minDepth,p/2))*(r-q)+q}function h(a){return b(a.maxDepth,p/2)*(r-q)+q}function i(a){return 2*(a.parentNode?a.minBreadth-.25:0)*Math.PI}function j(a){return 2*(a.parentNode?a.maxBreadth-a.minBreadth:1)*Math.PI}var k=a.nodes,l=a.orient,m=/^(top|bottom)$/.test(l),n=a.width,o=a.height,p=-k[0].minDepth;if("radial"==l){var q=a.innerRadius,r=a.outerRadius;null==q&&(q=0),q&&(p*=2),null==r&&(r=Math.min(n,o)/2)}for(var s=0;s<k.length;s++){var t=k[s];t.x=c(t),t.y=d(t),"radial"==l?(t.innerRadius=g(t),t.outerRadius=h(t),t.startAngle=i(t),t.angle=j(t),t.midAngle=t.startAngle+t.angle/2):t.midAngle=m?-Math.PI/2:0,t.dx=e(t),t.dy=f(t)}}},pv.Layout.Grid=function(){pv.Layout.call(this);var a=this;(this.cell=(new pv.Mark).data(function(){return a.scene[a.index].$grid}).width(function(){return a.width()/a.cols()}).height(function(){return a.height()/a.rows()}).left(function(){return this.width()*(this.index%a.cols())}).top(function(){return this.height()*Math.floor(this.index/a.cols())})).parent=this},pv.Layout.Grid.prototype=pv.extend(pv.Layout).property("rows").property("cols"),pv.Layout.Grid.prototype.defaults=(new pv.Layout.Grid).extend(pv.Layout.prototype.defaults).rows(1).cols(1),pv.Layout.Grid.prototype.buildImplied=function(a){pv.Layout.prototype.buildImplied.call(this,a);var b=a.rows,c=a.cols;"object"==typeof c&&(b=pv.transpose(c)),"object"==typeof b?(a.$grid=pv.blend(b),a.rows=b.length,a.cols=b[0]?b[0].length:0):a.$grid=pv.repeat([a.data],b*c)},pv.Layout.Stack=function(){function a(a){return function(){return e[a](this.parent.index,this.index)}}pv.Layout.call(this);var b,c=this,d=function(){return null},e={t:d,l:d,r:d,b:d,w:d,h:d},f=c.buildImplied;this.buildImplied=function(a){f.call(this,a);var c,g=a.layers,h=g.length,i=a.orient,j=/^(top|bottom)\b/.test(i),k=this.parent[j?"height":"width"](),l=[],m=[],n=[],o=pv.Mark.stack,p={parent:{parent:this}};o.unshift(null),b=[];for(var q=0;h>q;q++){n[q]=[],m[q]=[],p.parent.index=q,o[0]=g[q],b[q]=this.$values.apply(p.parent,o),q||(c=b[q].length),o.unshift(null);for(var r=0;c>r;r++)o[0]=b[q][r],p.index=r,q||(l[r]=this.$x.apply(p,o)),n[q][r]=this.$y.apply(p,o);o.shift()}o.shift();var s;switch(a.order){case"inside-out":for(var t=n.map(function(a){return pv.max.index(a)}),u=pv.range(h).sort(function(a,b){return t[a]-t[b]}),v=n.map(function(a){return pv.sum(a)}),w=0,x=0,y=[],z=[],q=0;h>q;q++){var r=u[q];x>w?(w+=v[r],y.push(r)):(x+=v[r],z.push(r))}s=z.reverse().concat(y);break;case"reverse":s=pv.range(h-1,-1,-1);break;default:s=pv.range(h)}switch(a.offset){case"silohouette":for(var r=0;c>r;r++){for(var p=0,q=0;h>q;q++)p+=n[q][r];m[s[0]][r]=(k-p)/2}break;case"wiggle":for(var p=0,q=0;h>q;q++)p+=n[q][0];m[s[0]][0]=p=(k-p)/2;for(var r=1;c>r;r++){for(var A=0,B=0,C=l[r]-l[r-1],q=0;h>q;q++)A+=n[q][r];for(var q=0;h>q;q++){for(var D=(n[s[q]][r]-n[s[q]][r-1])/(2*C),E=0;q>E;E++)D+=(n[s[E]][r]-n[s[E]][r-1])/C;B+=D*n[s[q]][r]}m[s[0]][r]=p-=A?B/A*C:0}break;case"expand":for(var r=0;c>r;r++){m[s[0]][r]=0;for(var E=0,q=0;h>q;q++)E+=n[q][r];if(E){E=k/E;for(var q=0;h>q;q++)n[q][r]*=E}else{E=k/h;for(var q=0;h>q;q++)n[q][r]=E}}break;default:for(var r=0;c>r;r++)m[s[0]][r]=0}for(var r=0;c>r;r++)for(var p=m[s[0]][r],q=1;h>q;q++)p+=n[s[q-1]][r],m[s[q]][r]=p;var q=i.indexOf("-"),F=j?"h":"w",G=0>q?j?"l":"b":i.charAt(q+1),H=i.charAt(0);for(var I in e)e[I]=d;e[G]=function(a,b){return l[b]},e[H]=function(a,b){return m[a][b]},e[F]=function(a,b){return n[a][b]}},this.layer=(new pv.Mark).data(function(){return b[this.parent.index]}).top(a("t")).left(a("l")).right(a("r")).bottom(a("b")).width(a("w")).height(a("h")),this.layer.add=function(a){return c.add(pv.Panel).data(function(){return c.layers()}).add(a).extend(this)}},pv.Layout.Stack.prototype=pv.extend(pv.Layout).property("orient",String).property("offset",String).property("order",String).property("layers"),pv.Layout.Stack.prototype.defaults=(new pv.Layout.Stack).extend(pv.Layout.prototype.defaults).orient("bottom-left").offset("zero").layers([[]]),pv.Layout.Stack.prototype.$x=pv.Layout.Stack.prototype.$y=function(){return 0},pv.Layout.Stack.prototype.x=function(a){return this.$x=pv.functor(a),this},pv.Layout.Stack.prototype.y=function(a){return this.$y=pv.functor(a),this},pv.Layout.Stack.prototype.$values=pv.identity,pv.Layout.Stack.prototype.values=function(a){return this.$values=pv.functor(a),this},pv.Layout.Band=function(){function a(a){return function(){return b[a](this.index,this.parent.index)}}pv.Layout.call(this);var b,c,d=this,e=d.buildImplied,f=(new pv.Mark).data(function(){return c[this.parent.index]}).top(a("t")).left(a("l")).right(a("r")).bottom(a("b")).width(a("w")).height(a("h")).antialias(a("antialias"));this.buildImplied=function(a){e.call(this,a),b=Object.create(pv.Layout.Band.$baseItemProps),c=[];var d=a.layers,f=d.length;if(f>0){var g=a.orient,h=/^(top|bottom)\b/.test(g),i=this.parent[h?"height":"width"](),j=this._readData(d,c,a),k=j.length;if("reverse"===a.bandOrder&&j.reverse(),"reverse"===a.order){c.reverse();for(var l=0;k>l;l++)j[l].items.reverse()}switch(a.layout){case"grouped":this._calcGrouped(j,f,a);break;case"stacked":this._calcStacked(j,f,i,a)}for(var m=a.hZero||0,n="stacked"===a.layout,o=0;k>o;o++)for(var p=j[o],q=n?Math.max(0,p.vertiMargin)/2:0,r=0;f>r;r++){var s=p.items[r];s.zero&&(s.h=m,s.y-=q+m/2)}this._bindItemProps(j,b,g,h)}};var g=this.item={end:this,add:function(a){return d.add(pv.Panel).data(function(){return d.layers()}).add(a).extend(f)},order:function(a){return d.order(a),this},w:function(a){return d.$iw=pv.functor(a),this},h:function(a){return d.$ih=pv.functor(a),this},horizontalRatio:function(a){return d.$ihorizRatio=pv.functor(a),this},verticalMargin:function(a){return d.$ivertiMargin=pv.functor(a),this}},h=this.band={end:this,w:function(a){return d.$bw=pv.functor(a),this},x:function(a){return d.$bx=pv.functor(a),this},order:function(a){return d.bandOrder(a),this},differentialControl:function(a){return d.$bDiffControl=pv.functor(a),this}};this.band.item=g,this.item.band=h},pv.Layout.Band.$baseItemProps=function(){var a=function(){return null};return{t:a,l:a,r:a,b:a,w:a,h:a}}(),pv.Layout.Band.prototype=pv.extend(pv.Layout).property("orient",String).property("layout",String).property("layers").property("yZero",Number).property("hZero",Number).property("verticalMode",String).property("horizontalMode",String).property("order",String).property("bandOrder",String),pv.Layout.Band.prototype.defaults=(new pv.Layout.Band).extend(pv.Layout.prototype.defaults).orient("bottom-left").layout("grouped").yZero(0).hZero(1.5).layers([[]]),pv.Layout.Band.prototype.$bx=pv.Layout.Band.prototype.$bw=pv.Layout.Band.prototype.$bDiffControl=pv.Layout.Band.prototype.$iw=pv.Layout.Band.prototype.$ih=pv.Layout.Band.prototype.$ivertiMargin=pv.functor(0),pv.Layout.Band.prototype.$ihorizRatio=pv.functor(.9),pv.Layout.Band.prototype.$values=pv.identity,pv.Layout.Band.prototype.values=function(a){return this.$values=pv.functor(a),this},pv.Layout.prototype._readData=function(a,b,c){var d,e=a.length,f=[],g=pv.Mark.stack,h=c.hZero,i={parent:{parent:this}};g.unshift(null);for(var j=0;e>j;j++){i.parent.index=j,g[0]=a[j];var k=b[j]=this.$values.apply(i.parent,g);j||(d=k.length),g.unshift(null);for(var l=0;d>l;l++){g[0]=k[l],i.index=l;var m=f[l];m||(m=f[l]={horizRatio:this.$ihorizRatio.apply(i,g),vertiMargin:this.$ivertiMargin.apply(i,g),w:this.$bw.apply(i,g),x:this.$bx.apply(i,g),diffControl:this.$bDiffControl?this.$bDiffControl.apply(i,g):0,items:[]});var n=this.$ih.apply(i,g),o=null!=n?Math.abs(n):n;m.items[j]={y:c.yZero||0,x:0,w:this.$iw.apply(i,g),h:o,zero:null!=o&&h>=o,dir:0>n?-1:1}}g.shift()}return g.shift(),f},pv.Layout.Band.prototype._calcGrouped=function(a,b,c){for(var d=0,e=a.length;e>d;d++){for(var f=a[d],g=f.items,h=f.w,i=f.horizRatio,j=0,k=0;b>k;k++)j+=g[k].w;if(1===b?i=1:i>0&&1>=i||(i=1),null==h)h=f.w=j/i;else if("expand"===c.horizontalMode){var l=i*h;if(j)for(var m=l/j,k=0;b>k;k++)g[k].w*=m;else for(var n=l/b,k=0;b>k;k++)g[k].w=n;j=l}for(var o=j/i,p=f.x-o/2,q=b>1?(o-j)/(b-1):0,k=0;b>k;k++){var r=g[k];r.x=p,p+=r.w+q,r.dir<0&&(r.y-=r.h)}}},pv.Layout.Band.prototype._calcStacked=function(a,b,c,d){var e,f=a.length;if("expand"===d.verticalMode)for(var g=0;f>g;g++){e=a[g].items;for(var h=null,i=0,j=0;b>j;j++){var k=e[j];k.dir=1;var l=k.h;null!=l&&(i++,h+=l)}if(i)if(h)for(var m=c/h,j=0;b>j;j++){var l=e[j].h;null!=l&&(e[j].h=l*m)}else if(0==h)for(var j=0;b>j;j++)e[j].h=0;else for(var n=c/i,j=0;b>j;j++){var l=e[j].h;null!=l&&(e[j].h=n)}}for(var o=d.yZero,p=o,g=0;f>g;g++){var q=a[g],r=q.x,s=q.diffControl,t=0>s,u=Math.max(0,q.vertiMargin);e=q.items;var v=this._layoutItemsOfDir(1,t,e,u,r,p),w=null;if(v.existsOtherDir&&(w=this._layoutItemsOfDir(-1,t,e,u,r,p)),s){if(1===Math.abs(s)){var x=p;p=v.yOffset,w&&(p-=x-w.yOffset)}}else p=o}},pv.Layout.Band.prototype._layoutItemsOfDir=function(a,b,c,d,e,f){for(var g=!1,h=d/2,i=b?-a:a,j=b,k=0,l=c.length;l>k;k+=1){var m=c[j?l-k-1:k];if(m.dir===a){var n=m.h||0;i>0?(m.y=f+h,f+=n):(m.y=f-(n-h),f-=n);var o=n-d;m.h=o>0?o:0,m.x=e-m.w/2}else g=!0}return{existsOtherDir:g,yOffset:f}},pv.Layout.Band.prototype._bindItemProps=function(a,b,c,d){var e=c.indexOf("-"),f=d?"h":"w",g=d?"w":"h",h=0>e?d?"l":"b":c.charAt(e+1),i=c.charAt(0);b[h]=function(b,c){return a[b].items[c].x},b[i]=function(b,c){return a[b].items[c].y},b[g]=function(b,c){return a[b].items[c].w},b[f]=function(b,c){return a[b].items[c].h||0},b.antialias=function(b,c){return a[b].items[c].zero}},pv.Layout.Treemap=function(){pv.Layout.Hierarchy.call(this),this.node.strokeStyle("#fff").fillStyle("rgba(31, 119, 180, .25)").width(function(a){return a.dx}).height(function(a){return a.dy}),this.label.visible(function(a){return!a.firstChild}).left(function(a){return a.x+a.dx/2}).top(function(a){return a.y+a.dy/2}).textAlign("center").textAngle(function(a){return a.dx>a.dy?0:-Math.PI/2}),(this.leaf=(new pv.Mark).extend(this.node).fillStyle(null).strokeStyle(null).visible(function(a){return!a.firstChild})).parent=this,delete this.link},pv.Layout.Treemap.prototype=pv.extend(pv.Layout.Hierarchy).property("round",Boolean).property("mode",String).property("order",String),pv.Layout.Treemap.prototype.defaults=(new pv.Layout.Treemap).extend(pv.Layout.Hierarchy.prototype.defaults).mode("squarify").order("ascending"),pv.Layout.Treemap.prototype.$size=function(a){return Number(a.nodeValue)},pv.Layout.Treemap.prototype.$padLeft=pv.Layout.Treemap.prototype.$padRight=pv.Layout.Treemap.prototype.$padBottom=pv.Layout.Treemap.prototype.$padTop=function(){return 0},pv.Layout.Treemap.prototype.size=function(a){return this.$size=pv.functor(a),this},pv.Layout.Treemap.prototype.padding=function(a){return a=pv.functor(a),this.paddingLeft(a).paddingRight(a).paddingTop(a).paddingBottom(a)},pv.Layout.Treemap.prototype.paddingLeft=function(a){return arguments.length?(this.$padLeft=pv.functor(a),this):this.$padLeft},pv.Layout.Treemap.prototype.paddingRight=function(a){return arguments.length?(this.$padRight=pv.functor(a),this):this.$padRight},pv.Layout.Treemap.prototype.paddingBottom=function(a){return arguments.length?(this.$padBottom=pv.functor(a),this):this.$padBottom},pv.Layout.Treemap.prototype.paddingTop=function(a){return arguments.length?(this.$padTop=pv.functor(a),this):this.$padTop},pv.Layout.Treemap.prototype.buildImplied=function(a){function b(a,b,c,d,e,f,g){for(var h=0,i=0;h<a.length;h++){var k=a[h];c?(k.x=d+i,k.y=e,i+=k.dx=j(f*k.size/b),k.dy=g):(k.x=d,k.y=e+i,k.dx=f,i+=k.dy=j(g*k.size/b))}k&&(c?k.dx+=f-i:k.dy+=g-i)}function c(a,b){for(var c=-1/0,d=1/0,e=0,f=0;f<a.length;f++){var g=a[f].size;d>g&&(d=g),g>c&&(c=g),e+=g}return e*=e,b*=b,Math.max(b*c/e,e/(b*d))}function d(a,d){function e(a){var c=l==p,d=pv.sum(a,i),e=p?j(d/p):0;return b(a,d,c,g,h,c?l:e,c?e:m),c?(h+=e,m-=e):(g+=e,l-=e),p=Math.min(l,m),c}var f=a.parentNode,g=a.x,h=a.y,l=a.dx,m=a.dy;if(f&&(g+=f.paddingLeft,h+=f.paddingTop,l+=-f.paddingLeft-f.paddingRight,m+=-f.paddingTop-f.paddingBottom),"squarify"==k){var n=[],o=1/0,p=Math.min(l,m),q=l*m/a.size;if(!(a.size<=0)){a.visitBefore(function(a){a.size*=q});for(var r=a.childNodes.slice();r.length;){var s=r[r.length-1];if(s.size){n.push(s);var q=c(n,p);o>=q?(r.pop(),o=q):(n.pop(),e(n),n.length=0,o=1/0)}else r.pop()}if(e(n))for(var d=0;d<n.length;d++)n[d].dy+=m;else for(var d=0;d<n.length;d++)n[d].dx+=l}}else b(a.childNodes,a.size,"slice"==k||"dice"!=k&&1&d,g,h,l,m)}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,a)){var e=this,f=a.nodes,g=f[0],h=pv.Mark.stack,i=function(a){return a.size},j=a.round?Math.round:Number,k=a.mode;h.unshift(null);try{g.visitAfter(function(a,b){a.depth=b,a.x=a.y=a.dx=a.dy=0,h[0]=a,a.firstChild?(a.size=pv.sum(a.childNodes,i),a.paddingRight=+e.$padRight.apply(e,h)||0,a.paddingLeft=+e.$padLeft.apply(e,h)||0,a.paddingBottom=+e.$padBottom.apply(e,h)||0,a.paddingTop=+e.$padTop.apply(e,h)||0):a.size=e.$size.apply(e,h)})}finally{h.shift()}switch(a.order){case"ascending":g.sort(function(a,b){return a.size-b.size});break;case"descending":g.sort(function(a,b){return b.size-a.size});break;case"reverse":g.reverse()}g.x=0,g.y=0,g.dx=a.width,g.dy=a.height,g.visitBefore(d)}},pv.Layout.Tree=function(){pv.Layout.Hierarchy.call(this)},pv.Layout.Tree.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("breadth",Number).property("depth",Number).property("orient",String),pv.Layout.Tree.prototype.defaults=(new pv.Layout.Tree).extend(pv.Layout.Hierarchy.prototype.defaults).group(1).breadth(15).depth(60).orient("top"),pv.Layout.Tree.prototype.buildImplied=function(a){function b(a){var c,e,f;if(a.firstChild){c=a.firstChild,e=a.lastChild,f=c;for(var g=c;g;g=g.nextSibling)b(g),f=d(g,f);h(a);var i=.5*(c.prelim+e.prelim);(c=a.previousSibling)?(a.prelim=c.prelim+j(a.depth,!0),a.mod=a.prelim-i):a.prelim=i}else(c=a.previousSibling)&&(a.prelim=c.prelim+j(a.depth,!0))}function c(a,b,d){a.breadth=a.prelim+b,b+=a.mod;for(var e=a.firstChild;e;e=e.nextSibling)c(e,b,d)}function d(a,b){var c=a.previousSibling;if(c){for(var d=a,h=a,k=c,l=a.parentNode.firstChild,m=d.mod,n=h.mod,o=k.mod,p=l.mod,q=f(k),r=e(d);q&&r;){k=q,d=r,l=e(l),h=f(h),h.ancestor=a;var s=k.prelim+o-(d.prelim+m)+j(k.depth,!1);s>0&&(g(i(k,a,b),a,s),m+=s,n+=s),o+=k.mod,m+=d.mod,p+=l.mod,n+=h.mod,q=f(k),r=e(d)}q&&!f(h)&&(h.thread=q,h.mod+=o-n),r&&!e(l)&&(l.thread=r,l.mod+=m-p,b=a)}return b}function e(a){return a.firstChild||a.thread}function f(a){return a.lastChild||a.thread}function g(a,b,c){var d=b.number-a.number;b.change-=c/d,b.shift+=c,a.change+=c/d,b.prelim+=c,b.mod+=c}function h(a){for(var b=0,c=0,d=a.lastChild;d;d=d.previousSibling)d.prelim+=b,d.mod+=b,c+=d.change,b+=d.shift+c}function i(a,b,c){return a.ancestor.parentNode==b.parentNode?a.ancestor:c}function j(a,b){return(b?1:r+1)/("radial"==o?a:1)}function k(a){return"radial"==o?a.breadth/p:0}function l(a){switch(o){case"left":return a.depth;case"right":return s-a.depth;case"top":case"bottom":return a.breadth+s/2;case"radial":return s/2+a.depth*Math.cos(k(a))}}function m(a){switch(o){case"left":case"right":return a.breadth+t/2;case"top":return a.depth;case"bottom":return t-a.depth;case"radial":return t/2+a.depth*Math.sin(k(a))}}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,a)){var n=a.nodes,o=a.orient,p=a.depth,q=a.breadth,r=a.group,s=a.width,t=a.height,u=n[0];u.visitAfter(function(a,b){a.ancestor=a,a.prelim=0,a.mod=0,a.change=0,a.shift=0,a.number=a.previousSibling?a.previousSibling.number+1:0,a.depth=b}),b(u),c(u,-u.prelim,0),u.visitAfter(function(a){a.breadth*=q,a.depth*=p,a.midAngle=k(a),a.x=l(a),a.y=m(a),a.firstChild&&(a.midAngle+=Math.PI),delete a.breadth,delete a.depth,delete a.ancestor,delete a.prelim,delete a.mod,delete a.change,delete a.shift,delete a.number,delete a.thread})}},pv.Layout.Indent=function(){pv.Layout.Hierarchy.call(this),this.link.interpolate("step-after")},pv.Layout.Indent.prototype=pv.extend(pv.Layout.Hierarchy).property("depth",Number).property("breadth",Number),pv.Layout.Indent.prototype.defaults=(new pv.Layout.Indent).extend(pv.Layout.Hierarchy.prototype.defaults).depth(15).breadth(15),pv.Layout.Indent.prototype.buildImplied=function(a){function b(a,c,h){a.x=f+h++*e,a.y=g+c++*d,a.midAngle=0;for(var i=a.firstChild;i;i=i.nextSibling)c=b(i,c,h);return c}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,a)){var c=a.nodes,d=a.breadth,e=a.depth,f=0,g=0;b(c[0],1,1)}},pv.Layout.Pack=function(){pv.Layout.Hierarchy.call(this),this.node.shapeRadius(function(a){return a.radius}).strokeStyle("rgb(31, 119, 180)").fillStyle("rgba(31, 119, 180, .25)"),this.label.textAlign("center"),delete this.link},pv.Layout.Pack.prototype=pv.extend(pv.Layout.Hierarchy).property("spacing",Number).property("order",String),pv.Layout.Pack.prototype.defaults=(new pv.Layout.Pack).extend(pv.Layout.Hierarchy.prototype.defaults).spacing(1).order("ascending"),pv.Layout.Pack.prototype.$radius=function(){return 1},pv.Layout.Pack.prototype.size=function(a){return this.$radius="function"==typeof a?function(){return Math.sqrt(a.apply(this,arguments))}:(a=Math.sqrt(a),function(){return a}),this},pv.Layout.Pack.prototype.buildImplied=function(a){function b(a){var b=pv.Mark.stack;b.unshift(null);for(var c=0,d=a.length;d>c;c++){var e=a[c];e.firstChild||(e.radius=g.$radius.apply(g,(b[0]=e,b)))}b.shift()}function c(b){for(var e=[],f=b.firstChild;f;f=f.nextSibling)f.firstChild&&(f.radius=c(f)),f.n=f.p=f,e.push(f);switch(a.order){case"ascending":e.sort(function(a,b){return a.radius-b.radius});break;case"descending":e.sort(function(a,b){return b.radius-a.radius});break;case"reverse":e.reverse()}return d(e)}function d(b){function c(a){m=Math.min(a.x-a.radius,m),n=Math.max(a.x+a.radius,n),o=Math.min(a.y-a.radius,o),p=Math.max(a.y+a.radius,p)}function d(a,b){var c=a.n;a.n=b,b.p=a,b.n=c,c.p=b}function f(a,b){a.n=b,b.p=a}function g(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.radius+b.radius;return e*e-c*c-d*d>.001}var h,i,j,k,l,m=1/0,n=-1/0,o=1/0,p=-1/0;if(h=b[0],h.x=-h.radius,h.y=0,c(h),b.length>1&&(i=b[1],i.x=i.radius,i.y=0,c(i),b.length>2)){j=b[2],e(h,i,j),c(j),d(h,j),h.p=j,d(j,i),i=h.n;for(var q=3;q<b.length;q++){e(h,i,j=b[q]);var r=0,s=1,t=1;for(k=i.n;k!=i;k=k.n,s++)if(g(k,j)){r=1;break}if(1==r)for(l=h.p;l!=k.p;l=l.p,t++)if(g(l,j)){s>t&&(r=-1,k=l);break}0==r?(d(h,j),i=j,c(j)):r>0?(f(h,k),i=k,q--):0>r&&(f(k,i),h=k,q--)}}for(var u=(m+n)/2,v=(o+p)/2,w=0,q=0;q<b.length;q++){var x=b[q];x.x-=u,x.y-=v,w=Math.max(w,x.radius+Math.sqrt(x.x*x.x+x.y*x.y))}return w+a.spacing}function e(a,b,c){var d=b.radius+c.radius,e=a.radius+c.radius,f=b.x-a.x,g=b.y-a.y,h=Math.sqrt(f*f+g*g),i=(e*e+h*h-d*d)/(2*e*h),j=Math.acos(i),k=i*e,l=Math.sin(j)*e;f/=h,g/=h,c.x=a.x+k*f+l*g,c.y=a.y+k*g-l*f}function f(a,b,c,d){for(var e=a.firstChild;e;e=e.nextSibling)e.x+=a.x,e.y+=a.y,f(e,b,c,d);a.x=b+d*a.x,a.y=c+d*a.y,a.radius*=d}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,a)){var g=this,h=a.nodes,i=h[0];b(h),i.x=0,i.y=0,i.radius=c(i);var j=this.width(),k=this.height(),l=1/Math.max(2*i.radius/j,2*i.radius/k);f(i,j/2,k/2,l)}},pv.Layout.Force=function(){pv.Layout.Network.call(this),this.link.lineWidth(function(a,b){return 1.5*Math.sqrt(b.linkValue)}),this.label.textAlign("center")},pv.Layout.Force.prototype=pv.extend(pv.Layout.Network).property("bound",Boolean).property("iterations",Number).property("dragConstant",Number).property("chargeConstant",Number).property("chargeMinDistance",Number).property("chargeMaxDistance",Number).property("chargeTheta",Number).property("springConstant",Number).property("springDamping",Number).property("springLength",Number),pv.Layout.Force.prototype.defaults=(new pv.Layout.Force).extend(pv.Layout.Network.prototype.defaults).dragConstant(.1).chargeConstant(-40).chargeMinDistance(2).chargeMaxDistance(500).chargeTheta(.9).springConstant(.1).springDamping(.3).springLength(20),pv.Layout.Force.prototype.buildImplied=function(a){function b(a){return a.fix?1:a.vx*a.vx+a.vy*a.vy}if(pv.Layout.Network.prototype.buildImplied.call(this,a)){var c=a.$force;c&&(c.next=this.binds.$force,this.binds.$force=c)}else{for(var d,e=this,f=a.nodes,g=a.links,h=a.iterations,i=a.width,j=a.height,k=0;k<f.length;k++)d=f[k],isNaN(d.x)&&(d.x=i/2+40*Math.random()-20),isNaN(d.y)&&(d.y=j/2+40*Math.random()-20);var l=pv.simulation(f);if(l.force(pv.Force.drag(a.dragConstant)),l.force(pv.Force.charge(a.chargeConstant).domain(a.chargeMinDistance,a.chargeMaxDistance).theta(a.chargeTheta)),l.force(pv.Force.spring(a.springConstant).damping(a.springDamping).length(a.springLength).links(g)),l.constraint(pv.Constraint.position()),a.bound&&l.constraint(pv.Constraint.bound().x(6,i-6).y(6,j-6)),null==h)l.step(),l.step(),a.$force=this.binds.$force={next:this.binds.$force,nodes:f,min:1e-4*(g.length+1),sim:l},this.$timer||(this.$timer=setInterval(function(){for(var a=!1,c=e.binds.$force;c;c=c.next)pv.max(c.nodes,b)>c.min&&(c.sim.step(),a=!0);a&&e.render()},42));else for(var k=0;h>k;k++)l.step()}},pv.Layout.Cluster=function(){pv.Layout.Hierarchy.call(this);var a,b=this.buildImplied;this.buildImplied=function(c){b.call(this,c),a=/^(top|bottom)$/.test(c.orient)?"step-before":/^(left|right)$/.test(c.orient)?"step-after":"linear"},this.link.interpolate(function(){return a})},pv.Layout.Cluster.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("orient",String).property("innerRadius",Number).property("outerRadius",Number),pv.Layout.Cluster.prototype.defaults=(new pv.Layout.Cluster).extend(pv.Layout.Hierarchy.prototype.defaults).group(0).orient("top"),pv.Layout.Cluster.prototype.buildImplied=function(a){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,a)){var b,c,d=a.nodes[0],e=a.group,f=0,g=.5-e/2,h=void 0;d.visitAfter(function(a){a.firstChild?a.depth=1+pv.max(a.childNodes,function(a){return a.depth}):(e&&h!=a.parentNode&&(h=a.parentNode,f+=e),f++,a.depth=0)}),b=1/f,c=1/d.depth;var h=void 0;d.visitAfter(function(a){a.firstChild?a.breadth=pv.mean(a.childNodes,function(a){return a.breadth}):(e&&h!=a.parentNode&&(h=a.parentNode,g+=e),a.breadth=b*g++),a.depth=1-a.depth*c}),d.visitAfter(function(a){a.minBreadth=a.firstChild?a.firstChild.minBreadth:a.breadth-b/2,a.maxBreadth=a.firstChild?a.lastChild.maxBreadth:a.breadth+b/2}),d.visitBefore(function(a){a.minDepth=a.parentNode?a.parentNode.maxDepth:0,a.maxDepth=a.parentNode?a.depth+d.depth:a.minDepth+2*d.depth}),d.minDepth=-c,pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,a)}},pv.Layout.Cluster.Fill=function(){pv.Layout.Cluster.call(this),pv.Layout.Hierarchy.Fill.constructor.call(this)},pv.Layout.Cluster.Fill.prototype=pv.extend(pv.Layout.Cluster),pv.Layout.Cluster.Fill.prototype.buildImplied=function(a){pv.Layout.Cluster.prototype.buildImplied.call(this,a)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,a)},pv.Layout.Partition=function(){pv.Layout.Hierarchy.call(this)},pv.Layout.Partition.prototype=pv.extend(pv.Layout.Hierarchy).property("order",String).property("orient",String).property("innerRadius",Number).property("outerRadius",Number),pv.Layout.Partition.prototype.defaults=(new pv.Layout.Partition).extend(pv.Layout.Hierarchy.prototype.defaults).orient("top"),pv.Layout.Partition.prototype.$size=function(){return 1},pv.Layout.Partition.prototype.size=function(a){return this.$size=a,this},pv.Layout.Partition.prototype.buildImplied=function(a){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,a)){var b=this,c=a.nodes[0],d=pv.Mark.stack,e=0;switch(d.unshift(null),c.visitAfter(function(a,c){c>e&&(e=c),a.size=a.firstChild?pv.sum(a.childNodes,function(a){return a.size}):b.$size.apply(b,(d[0]=a,d))}),d.shift(),a.order){case"ascending":c.sort(function(a,b){return a.size-b.size});break;case"descending":c.sort(function(a,b){return b.size-a.size})}c.minBreadth=0,c.breadth=.5,c.maxBreadth=1,c.visitBefore(function(a){for(var b=a.minBreadth,c=a.maxBreadth-b,d=a.firstChild;d;d=d.nextSibling)d.minBreadth=b,b+=d.size/a.size*c,d.maxBreadth=b,d.breadth=(b+d.minBreadth)/2}),c.visitAfter(function(a,b){a.minDepth=(b-1)/e,a.maxDepth=a.depth=b/e}),pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,a)}},pv.Layout.Partition.Fill=function(){
pv.Layout.Partition.call(this),pv.Layout.Hierarchy.Fill.constructor.call(this)},pv.Layout.Partition.Fill.prototype=pv.extend(pv.Layout.Partition),pv.Layout.Partition.Fill.prototype.buildImplied=function(a){pv.Layout.Partition.prototype.buildImplied.call(this,a)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,a)},pv.Layout.Arc=function(){pv.Layout.Network.call(this);var a,b,c,d=this.buildImplied;this.buildImplied=function(e){d.call(this,e),b=e.directed,a="radial"==e.orient?"linear":"polar",c="right"==e.orient||"top"==e.orient},this.link.data(function(a){var d=a.sourceNode,e=a.targetNode;return c!=(b||d.breadth<e.breadth)?[d,e]:[e,d]}).interpolate(function(){return a})},pv.Layout.Arc.prototype=pv.extend(pv.Layout.Network).property("orient",String).property("directed",Boolean),pv.Layout.Arc.prototype.defaults=(new pv.Layout.Arc).extend(pv.Layout.Network.prototype.defaults).orient("bottom"),pv.Layout.Arc.prototype.sort=function(a){return this.$sort=a,this},pv.Layout.Arc.prototype.buildImplied=function(a){function b(a){switch(f){case"top":return-Math.PI/2;case"bottom":return Math.PI/2;case"left":return Math.PI;case"right":return 0;case"radial":return 2*(a-.25)*Math.PI}}function c(a){switch(f){case"top":case"bottom":return a*i;case"left":return 0;case"right":return i;case"radial":return i/2+k*Math.cos(b(a))}}function d(a){switch(f){case"top":return 0;case"bottom":return j;case"left":case"right":return a*j;case"radial":return j/2+k*Math.sin(b(a))}}if(!pv.Layout.Network.prototype.buildImplied.call(this,a)){var e=a.nodes,f=a.orient,g=this.$sort,h=pv.range(e.length),i=a.width,j=a.height,k=Math.min(i,j)/2;g&&h.sort(function(a,b){return g(e[a],e[b])});for(var l=0;l<e.length;l++){var m=e[h[l]],n=m.breadth=(l+.5)/e.length;m.x=c(n),m.y=d(n),m.midAngle=b(n)}}},pv.Layout.Horizon=function(){pv.Layout.call(this);var a,b,c,d,e,f,g=this,h=this.buildImplied;this.buildImplied=function(g){h.call(this,g),a=g.bands,b=g.mode,c=Math.round(("color"==b?.5:1)*g.height),d=g.backgroundStyle,e=pv.ramp(d,g.negativeStyle).domain(0,a),f=pv.ramp(d,g.positiveStyle).domain(0,a)};var a=(new pv.Panel).data(function(){return pv.range(2*a)}).overflow("hidden").height(function(){return c}).top(function(a){return"color"==b?(1&a)*c:0}).fillStyle(function(a){return a?null:d});this.band=(new pv.Mark).top(function(a,d){return"mirror"==b&&1&d?(d+1>>1)*c:null}).bottom(function(a,d){return"mirror"==b?1&d?null:(d+1>>1)*-c:(1&d||-1)*(d+1>>1)*c}).fillStyle(function(a,b){return(1&b?e:f)((b>>1)+1)}),this.band.add=function(b){return g.add(pv.Panel).extend(a).add(b).extend(this)}},pv.Layout.Horizon.prototype=pv.extend(pv.Layout).property("bands",Number).property("mode",String).property("backgroundStyle",pv.fillStyle).property("positiveStyle",pv.fillStyle).property("negativeStyle",pv.fillStyle),pv.Layout.Horizon.prototype.defaults=(new pv.Layout.Horizon).extend(pv.Layout.prototype.defaults).bands(2).mode("offset").backgroundStyle("white").positiveStyle("#1f77b4").negativeStyle("#d62728"),pv.Layout.Rollup=function(){pv.Layout.Network.call(this);var a,b,c=this,d=c.buildImplied;this.buildImplied=function(c){d.call(this,c),a=c.$rollup.nodes,b=c.$rollup.links},this.node.data(function(){return a}).shapeSize(function(a){return 20*a.nodes.length}),this.link.interpolate("polar").eccentricity(.8),this.link.add=function(a){return c.add(pv.Panel).data(function(){return b}).add(a).extend(this)}},pv.Layout.Rollup.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean),pv.Layout.Rollup.prototype.x=function(a){return this.$x=pv.functor(a),this},pv.Layout.Rollup.prototype.y=function(a){return this.$y=pv.functor(a),this},pv.Layout.Rollup.prototype.buildImplied=function(a){function b(a){return g[a]+","+h[a]}if(!pv.Layout.Network.prototype.buildImplied.call(this,a)){var c=a.nodes,d=a.links,e=a.directed,f=c.length,g=[],h=[],i=0,j={},k={},l=pv.Mark.stack,m={parent:this};l.unshift(null);for(var n=0;f>n;n++)m.index=n,l[0]=c[n],g[n]=this.$x.apply(m,l),h[n]=this.$y.apply(m,l);l.shift();for(var n=0;n<c.length;n++){var o=b(n),p=j[o];p||(p=j[o]=Object.create(c[n]),p.index=i++,p.x=g[n],p.y=h[n],p.nodes=[]),p.nodes.push(c[n])}for(var n=0;n<d.length;n++){var q=d[n].sourceNode,r=d[n].targetNode,s=j[b(q.index)],t=j[b(r.index)],u=!e&&s.index>t.index,v=u?t.index+","+s.index:s.index+","+t.index,w=k[v];w||(w=k[v]={sourceNode:s,targetNode:t,linkValue:0,links:[]}),w.links.push(d[n]),w.linkValue+=d[n].linkValue}a.$rollup={nodes:pv.values(j),links:pv.values(k)}}},pv.Layout.Matrix=function(){pv.Layout.Network.call(this);var a,b,c,d,e,f=this,g=f.buildImplied;this.buildImplied=function(f){g.call(this,f),a=f.nodes.length,b=f.width/a,c=f.height/a,d=f.$matrix.labels,e=f.$matrix.pairs},this.link.data(function(){return e}).left(function(){return b*(this.index%a)}).top(function(){return c*Math.floor(this.index/a)}).width(function(){return b}).height(function(){return c}).lineWidth(1.5).strokeStyle("#fff").fillStyle(function(a){return a.linkValue?"#555":"#eee"}).parent=this,delete this.link.add,this.label.data(function(){return d}).left(function(){return 1&this.index?b*((this.index>>1)+.5):0}).top(function(){return 1&this.index?0:c*((this.index>>1)+.5)}).textMargin(4).textAlign(function(){return 1&this.index?"left":"right"}).textAngle(function(){return 1&this.index?-Math.PI/2:0}),delete this.node},pv.Layout.Matrix.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean),pv.Layout.Matrix.prototype.sort=function(a){return this.$sort=a,this},pv.Layout.Matrix.prototype.buildImplied=function(a){if(!pv.Layout.Network.prototype.buildImplied.call(this,a)){var b=a.nodes,c=a.links,d=this.$sort,e=b.length,f=pv.range(e),g=[],h=[],i={};a.$matrix={labels:g,pairs:h},d&&f.sort(function(a,c){return d(b[a],b[c])});for(var j=0;e>j;j++)for(var k=0;e>k;k++){var l=f[j],m=f[k],n={row:j,col:k,sourceNode:b[l],targetNode:b[m],linkValue:0};h.push(i[l+"."+m]=n)}for(var j=0;e>j;j++){var l=f[j];g.push(b[l],b[l])}for(var j=0;j<c.length;j++){var o=c[j],p=o.sourceNode.index,q=o.targetNode.index,r=o.linkValue;i[p+"."+q].linkValue+=r,a.directed||(i[q+"."+p].linkValue+=r)}}},pv.Layout.Bullet=function(){pv.Layout.call(this);var a,b,c,d,e,f=this,g=f.buildImplied,h=f.x=pv.Scale.linear();this.buildImplied=function(f){g.call(this,e=f),a=f.orient,b=/^left|right$/.test(a),c=pv.ramp("#bbb","#eee").domain(0,Math.max(1,e.ranges.length-1)),d=pv.ramp("steelblue","lightsteelblue").domain(0,Math.max(1,e.measures.length-1))},(this.range=new pv.Mark).data(function(){return e.ranges}).reverse(!0).left(function(){return"left"==a?0:null}).top(function(){return"top"==a?0:null}).right(function(){return"right"==a?0:null}).bottom(function(){return"bottom"==a?0:null}).width(function(a){return b?h(a):null}).height(function(a){return b?null:h(a)}).fillStyle(function(){return c(this.index)}).antialias(!1).parent=f,(this.measure=new pv.Mark).extend(this.range).data(function(){return e.measures}).left(function(){return"left"==a?0:b?null:this.parent.width()/3.25}).top(function(){return"top"==a?0:b?this.parent.height()/3.25:null}).right(function(){return"right"==a?0:b?null:this.parent.width()/3.25}).bottom(function(){return"bottom"==a?0:b?this.parent.height()/3.25:null}).fillStyle(function(){return d(this.index)}).parent=f,(this.marker=new pv.Mark).data(function(){return e.markers}).left(function(c){return"left"==a?h(c):b?null:this.parent.width()/2}).top(function(c){return"top"==a?h(c):b?this.parent.height()/2:null}).right(function(b){return"right"==a?h(b):null}).bottom(function(b){return"bottom"==a?h(b):null}).strokeStyle("black").shape("bar").shapeAngle(function(){return b?0:Math.PI/2}).parent=f,(this.tick=new pv.Mark).data(function(){return h.ticks(7)}).left(function(b){return"left"==a?h(b):null}).top(function(b){return"top"==a?h(b):null}).right(function(c){return"right"==a?h(c):b?null:-6}).bottom(function(c){return"bottom"==a?h(c):b?-8:null}).height(function(){return b?6:null}).width(function(){return b?null:6}).parent=f},pv.Layout.Bullet.prototype=pv.extend(pv.Layout).property("orient",String).property("ranges").property("markers").property("measures").property("minimum").property("maximum"),pv.Layout.Bullet.prototype.defaults=(new pv.Layout.Bullet).extend(pv.Layout.prototype.defaults).orient("left").ranges([]).markers([]).measures([]),pv.Layout.Bullet.prototype._originIsZero=!0,pv.Layout.Bullet.prototype.originIsZero=function(a){return arguments.length?this._originIsZero=!!a:this._originIsZero},pv.Layout.Bullet.prototype.buildImplied=function(a){pv.Layout.prototype.buildImplied.call(this,a);var b,c=this.parent[/^left|right$/.test(a.orient)?"width":"height"](),d=a.maximum,e=a.minimum,f=1e-10;null==d?(b=[].concat(a.ranges,a.markers,a.measures),d=pv.max(b)):d=+d,null==e?(b||(b=[].concat(a.ranges,a.markers,a.measures)),e=pv.min(b),e=.95*e):e=+e,(e>d||f>d-e)&&(e=Math.abs(d)<f?-.1:.99*d),this._originIsZero&&e*d>0&&(e>0?e=0:d=0),a.minimum=e,a.maximum=d,this.x.domain(e,d).range(0,c)},pv.Behavior={},pv.Behavior.dragBase=function(a){function b(b){if(k||(k=!0,this.addEventInterceptor("click",g,!0)),!h){var f=this.root.scene.$g;h=[[f,"mousemove",pv.listen(f,"mousemove",c)],[f,"mouseup",pv.listen(f,"mouseup",d)],[document,"mousemove",pv.listen(document,"mousemove",c)],[document,"mouseup",pv.listen(document,"mouseup",d)]]}var m=arguments[arguments.length-1];i=m.target,j=!1,m.stopPropagation();var n=this.mouse(),o=this.scene,p=this.index;l=o[p].drag={phase:"start",m:n,m1:n,m2:null,d:b,scene:o,index:p},m=e(m,l),a.dragstart.call(this,m);var q=l.m;q!==n&&(n.x=q.x,n.y=q.y)}function c(b){if(l){l.phase="move",b.stopPropagation(),b=e(b,l);var c=l.scene;c.mark.context(c,l.index,function(){var c=l.m2||l.m1,d=this.mouse();if(!(c&&d.distance2(c).dist2<=2)){l.m=l.m2=d,a.drag.call(this,b);var e=l.m;e!==d&&(d.x=e.x,d.y=e.y)}})}}function d(b){if(l){l.phase="end";var c=l.m2,d=c&&l.m1.distance2(c).dist2>.1;l.canceled=!d,j=d&&i===b.target,j||(i=null),b.stopPropagation(),b=e(b,l),h&&(h.forEach(function(a){pv.unlisten.apply(pv,a)}),h=null);var f=l.scene,g=l.index;try{f.mark.context(f,g,function(){a.dragend.call(this,b)})}finally{l=null,delete f[g].drag}}}function e(a,b){try{return a.drag=b,a}catch(a){}var c={};for(var d in a){var e=a[d];c[d]="function"!=typeof e?e:f(e,a)}return c._sourceEvent=a,c}function f(a,b){return function(){return a.apply(b,arguments)}}function g(a,b){if(j&&i===b.target)return j=!1,i=null,!1}var h,i,j,k,l;return a.autoRender=!0,a.positionConstraint=null,a.bound=function(a,b){return Math.max(l.min[b],Math.min(l.max[b],a))},b.autoRender=function(c){return arguments.length?(a.autoRender=!!c,b):a.autoRender},b.positionConstraint=function(c){return arguments.length?(a.positionConstraint=c,b):a.positionConstraint},b},pv.Behavior.drag=function(){var a,b=null,c=1,d=1,e={dragstart:function(b){var c=b.drag;c.type="drag";var d=c.d,f=pv.vector(d.x,d.y);d.fix=f,d.drag=c,a=f.minus(c.m1);var g=this.parent;c.max={x:g.width()-(d.dx||0),y:g.height()-(d.dy||0)},c.min={x:0,y:0},e.autoRender&&this.render(),pv.Mark.dispatch("dragstart",c.scene,c.index,b)},drag:function(b){var f=b.drag,g=f.m2,h=f.d;f.m=a.plus(g);var i=e.positionConstraint;i&&i(f);var j=f.m;c&&(h.x=h.fix.x=e.bound(j.x,"x")),d&&(h.y=h.fix.y=e.bound(j.y,"y")),e.autoRender&&this.render(),pv.Mark.dispatch("drag",f.scene,f.index,b)},dragend:function(b){var c=b.drag,d=c.d;d.fix=null,a=null,e.autoRender&&this.render();try{pv.Mark.dispatch("dragend",c.scene,c.index,b)}finally{delete d.drag}}},f=pv.Behavior.dragBase(e);return f.collapse=function(a){if(arguments.length){switch(b=String(a)){case"y":c=1,d=0;break;case"x":c=0,d=1;break;default:c=1,d=1}return f}return b},f},pv.Behavior.point=function(a){function b(a,c){for(var d=a[c],e={cost:1/0},f=(d.visible?d.children.length:0)-1;f>=0;f--){var i,j=d.children[f],k=j.mark;if("panel"==k.type){k.scene=j;for(var l=j.length-1;l>=0;l--)k.index=l,i=b(j,l),i.cost<e.cost&&(e=i);delete k.scene,delete k.index}else if(k.$handlers.point)for(var m=k.mouse(),l=j.length-1;l>=0;l--){var n=j[l],o=m.x-n.left-(n.width||0)/2,p=m.y-n.top-(n.height||0)/2,q=g*o*o+h*p*p;q<e.cost&&(e.distance=o*o+p*p,e.cost=q,e.scene=j,e.index=l)}}return e}function c(a){var c=b(this.scene,this.index);if((1/0==c.cost||c.distance>j)&&(c=null),e){if(c&&e.scene==c.scene&&e.index==c.index)return;pv.Mark.dispatch("unpoint",e.scene,e.index,a)}(e=c)&&(pv.Mark.dispatch("point",c.scene,c.index,a),i||"panel"!==this.type?pv.listen(this.root.canvas(),"mouseout",d):(i=this,i.event("mouseout",function(){var a=arguments[arguments.length-1];d.call(i.scene.$g,a)})))}function d(a){e&&!pv.ancestor(this,a.relatedTarget)&&(pv.Mark.dispatch("unpoint",e.scene,e.index,a),e=null)}var e,f=null,g=1,h=1,i=null,j=arguments.length?a*a:900;return c.collapse=function(a){if(arguments.length){switch(f=String(a)){case"y":g=1,h=0;break;case"x":g=0,h=1;break;default:g=1,h=1}return c}return f},c},pv.Behavior.select=function(){var a=null,b=1,c=1,d=!1,e={dragstart:function(a){var f=a.drag;f.type="select";var g=f.d;g.drag=f,f.max={x:this.width(),y:this.height()},f.min={x:0,y:0};var h=e.positionConstraint;h&&(f.m=f.m.clone(),h(f));var i=f.m;b&&(g.x=e.bound(i.x,"x"),d||(g.dx=0)),c&&(g.y=e.bound(i.y,"y"),d||(g.dy=0)),pv.Mark.dispatch("selectstart",f.scene,f.index,a)},drag:function(a){var f=a.drag,g=f.m1,h=f.d;f.max.x=this.width(),f.max.y=this.height();var i=e.positionConstraint;i&&(f.m=f.m.clone(),i(f));var j=f.m;if(b){var k=Math.min(g.x,j.x);if(k=e.bound(k,"x"),h.x=k,!d){var l=Math.max(j.x,g.x);l=e.bound(l,"x"),h.dx=l-k}}if(c){var m=Math.min(g.y,j.y);if(m=e.bound(m,"y"),h.y=m,!d){var n=Math.max(j.y,g.y);n=e.bound(n,"y"),h.dy=n-m}}e.autoRender&&this.render(),pv.Mark.dispatch("select",f.scene,f.index,a)},dragend:function(a){var b=a.drag;try{pv.Mark.dispatch("selectend",b.scene,b.index,a)}finally{var c=b.d;delete c.drag}}},f=pv.Behavior.dragBase(e);return f.collapse=function(d){if(arguments.length){switch(a=String(d)){case"y":b=1,c=0;break;case"x":b=0,c=1;break;default:b=1,c=1}return f}return a},f.preserveLength=function(a){return arguments.length?(d=!!a,f):d},f},pv.Behavior.resize=function(a){var b=!1,c="left"===a||"right"===a,d={dragstart:function(b){var c=b.drag;c.type="resize";var d=c.m1,e=c.d;switch(e.drag=c,a){case"left":d.x=e.x+e.dx;break;case"right":d.x=e.x;break;case"top":d.y=e.y+e.dy;break;case"bottom":d.y=e.y}var f=this.parent;c.max={x:f.width(),y:f.height()},c.min={x:0,y:0},pv.Mark.dispatch("resizestart",c.scene,c.index,b)},drag:function(a){var e=a.drag,f=e.m1,g=d.positionConstraint;g&&(e.m=e.m.clone(),g(e));var h=e.m,i=e.d;if(!b||c){var j=Math.min(f.x,h.x),k=Math.max(h.x,f.x);j=d.bound(j,"x"),k=d.bound(k,"x"),i.x=j,i.dx=k-j}if(!b||!c){var l=Math.min(f.y,h.y),m=Math.max(h.y,f.y);j=d.bound(l,"y"),k=d.bound(m,"y"),i.y=l,i.dy=m-l}d.autoRender&&this.render(),pv.Mark.dispatch("resize",e.scene,e.index,a)},dragend:function(a){var b=a.drag;max=null;try{pv.Mark.dispatch("resizeend",b.scene,b.index,a)}finally{var c=b.d;delete c.drag}}},e=pv.Behavior.dragBase(d);return e.preserveOrtho=function(a){return arguments.length?(b=!!a,e):b},e},pv.Behavior.pan=function(){function a(){e=this.index,d=this.scene,g=pv.vector(pv.event.pageX,pv.event.pageY),f=this.transform(),h=1/(f.k*this.scale),i&&(i={x:(1-f.k)*this.width(),y:(1-f.k)*this.height()})}function b(a){d&&(d.mark.context(d,e,function(){var a=(pv.event.pageX-g.x)*h,b=(pv.event.pageY-g.y)*h,c=f.translate(a,b);i&&(c.x=Math.max(i.x,Math.min(0,c.x)),c.y=Math.max(i.y,Math.min(0,c.y))),this.transform(c).render()}),pv.Mark.dispatch("pan",d,e,a))}function c(){d=null}var d,e,f,g,h,i;return a.bound=function(a){return arguments.length?(i=Boolean(a),this):Boolean(i)},pv.listen(window,"mousemove",b),pv.listen(window,"mouseup",c),a},pv.Behavior.zoom=function(a){function b(b){var d=this.mouse(),e=pv.event.wheel*a,f=this.transform().translate(d.x,d.y).scale(0>e?1e3/(1e3-e):(1e3+e)/1e3).translate(-d.x,-d.y);c&&(f.k=Math.max(1,f.k),f.x=Math.max((1-f.k)*this.width(),Math.min(0,f.x)),f.y=Math.max((1-f.k)*this.height(),Math.min(0,f.y))),this.transform(f).render(),pv.Mark.dispatch("zoom",this.scene,this.index,b)}var c;return arguments.length||(a=1/48),b.bound=function(a){return arguments.length?(c=Boolean(a),this):Boolean(c)},b},pv.Geo=function(){},pv.Geo.projections={mercator:{project:function(a){return{x:a.lng/180,y:a.lat>85?1:a.lat<-85?-1:Math.log(Math.tan(Math.PI/4+pv.radians(a.lat)/2))/Math.PI}},invert:function(a){return{lng:180*a.x,lat:pv.degrees(2*Math.atan(Math.exp(a.y*Math.PI))-Math.PI/2)}}},"gall-peters":{project:function(a){return{x:a.lng/180,y:Math.sin(pv.radians(a.lat))}},invert:function(a){return{lng:180*a.x,lat:pv.degrees(Math.asin(a.y))}}},sinusoidal:{project:function(a){return{x:pv.radians(a.lng)*Math.cos(pv.radians(a.lat))/Math.PI,y:a.lat/90}},invert:function(a){return{lng:pv.degrees(a.x*Math.PI/Math.cos(a.y*Math.PI/2)),lat:90*a.y}}},aitoff:{project:function(a){var b=pv.radians(a.lng),c=pv.radians(a.lat),d=Math.acos(Math.cos(c)*Math.cos(b/2));return{x:2*(d?Math.cos(c)*Math.sin(b/2)*d/Math.sin(d):0)/Math.PI,y:2*(d?Math.sin(c)*d/Math.sin(d):0)/Math.PI}},invert:function(a){var b=a.x*Math.PI/2,c=a.y*Math.PI/2;return{lng:pv.degrees(b/Math.cos(c)),lat:pv.degrees(c)}}},hammer:{project:function(a){var b=pv.radians(a.lng),c=pv.radians(a.lat),d=Math.sqrt(1+Math.cos(c)*Math.cos(b/2));return{x:2*Math.SQRT2*Math.cos(c)*Math.sin(b/2)/d/3,y:Math.SQRT2*Math.sin(c)/d/1.5}},invert:function(a){var b=3*a.x,c=1.5*a.y,d=Math.sqrt(1-b*b/16-c*c/4);return{lng:pv.degrees(2*Math.atan2(d*b,2*(2*d*d-1))),lat:pv.degrees(Math.asin(d*c))}}},identity:{project:function(a){return{x:a.lng/180,y:a.lat/90}},invert:function(a){return{lng:180*a.x,lat:90*a.y}}}},pv.Geo.scale=function(a){function b(a){if(!e||a.lng!=e.lng||a.lat!=e.lat){e=a;var b=c(a);f={x:k(b.x),y:l(b.y)}}return f}function c(a){var b={lng:a.lng-m.lng,lat:a.lat};return j.project(b)}function d(a){var b=j.invert(a);return b.lng+=m.lng,b}var e,f,g={x:0,y:0},h={x:1,y:1},i=[],j=pv.Geo.projections.identity,k=pv.Scale.linear(-1,1).range(0,1),l=pv.Scale.linear(-1,1).range(1,0),m={lng:0,lat:0};return b.x=function(a){return b(a).x},b.y=function(a){return b(a).y},b.ticks={lng:function(a){var b,c;if(i.length>1){var d=pv.Scale.linear();void 0==a&&(a=10),b=d.domain(i,function(a){return a.lat}).ticks(a),c=d.domain(i,function(a){return a.lng}).ticks(a)}else b=pv.range(-80,81,10),c=pv.range(-180,181,10);return c.map(function(a){return b.map(function(b){return{lat:b,lng:a}})})},lat:function(a){return pv.transpose(b.ticks.lng(a))}},b.invert=function(a){return d({x:k.invert(a.x),y:l.invert(a.y)})},b.domain=function(a,b){if(arguments.length){if(i=a instanceof Array?arguments.length>1?pv.map(a,b):a:Array.prototype.slice.call(arguments),i.length>1){var d=i.map(function(a){return a.lng}),f=i.map(function(a){return a.lat});m={lng:(pv.max(d)+pv.min(d))/2,lat:(pv.max(f)+pv.min(f))/2};var g=i.map(c);k.domain(g,function(a){return a.x}),l.domain(g,function(a){return a.y})}else m={lng:0,lat:0},k.domain(-1,1),l.domain(-1,1);return e=null,this}return i},b.range=function(a,b){return arguments.length?("object"==typeof a?(g={x:Number(a.x),y:Number(a.y)},h={x:Number(b.x),y:Number(b.y)}):(g={x:0,y:0},h={x:Number(a),y:Number(b)}),k.range(g.x,h.x),l.range(h.y,g.y),e=null,this):[g,h]},b.projection=function(a){return arguments.length?(j="string"==typeof a?pv.Geo.projections[a]||pv.Geo.projections.identity:a,this.domain(i)):a},pv.copyOwn(b,pv.Scale.common),arguments.length&&b.projection(a),b};